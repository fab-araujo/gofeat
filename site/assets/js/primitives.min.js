/*
 Basic Primitives Diagram v3.7.5
 Copyright (c) 2013 - 2017 Basic Primitives Inc

 Non-commercial - Free
 http://creativecommons.org/licenses/by-nc/3.0/

 Commercial and government licenses:
 http://www.basicprimitives.com/pdf/license.pdf

*/
(function(){var a=function(a){var a=a.split("."),c=window,d;for(d=0;d<a.length;d+=1)c=c[a[d]]=c[a[d]]||{};return c};a("primitives.common");a("primitives.common.perimeter");a("primitives.orgdiagram");a("primitives.famdiagram");a("primitives.text");a("primitives.callout");a("primitives.connector");a("primitives.shape");a("primitives.pdf");a("primitives.pdf.orgdiagram");a("primitives.pdf.famdiagram")})();
primitives.common.isNullOrEmpty=function(a){var b=!0;void 0!==a&&null!==a&&(a=a.toString(),0<a.length&&(b=!1));return b};primitives.common.isArray=Array.isArray||function(a){return a instanceof Array};primitives.common.loop=function(a,b,c){var d,e;if(null!=c)if(primitives.common.isArray(b)){d=0;for(e=b.length;d<e&&!c.call(a,d,b[d]);d+=1);}else for(d in b)if(b.hasOwnProperty(d)&&c.call(a,d,b[d]))break};
primitives.common.splitCamelCaseName=function(a){for(var b=[],c="",d=0;d<a.length;d+=1){var e=a[d];"A"<=e&&"Z">=e?(""!==c&&b.push(c),c=e):c+=e}""!==c&&b.push(c);return b};primitives.common.isObject=function(a){return null!==a&&"object"==typeof a};primitives.common.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0};
primitives.common.cloneObject=function(a,b){var c;if(null===a)c=null;else if(a instanceof Array)if(b)c=a.slice(0);else{c=[];for(var d=0,e=a.length;d<e;d+=1)c.push(primitives.common.cloneObject(a[d],b))}else switch(typeof a){case "object":c={};for(d in a)a.hasOwnProperty(d)&&(c[d]=b?a[d]:primitives.common.cloneObject(a[d],b));break;default:c=a}return c};primitives.common.hashCode=function(a){var b=0,c,d;if(0<a.length)for(d=0;d<a.length;d+=1)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b};
primitives.common.css=function(a,b){var c,d;if(a.hasOwnProperty("cssHash"))for(c in b)b.hasOwnProperty(c)&&(d=b[c],a.cssHash[c]!=d&&(a.cssHash[c]=d,a.css(c,d)));else a.css(b),a.cssHash=b};primitives.common.stopPropagation=function(a){void 0!==a.stopPropagation?a.stopPropagation():void 0!==a.cancelBubble?a.cancelBubble=!0:void 0!==a.preventDefault&&a.preventDefault()};primitives.common.indexOf=function(a,b,c){var d,e;for(d=0;d<a.length;d+=1)if(e=a[d],null!=c?c(e,b):e===b)return d;return-1};
primitives.common._supportsSVG=null;primitives.common.supportsSVG=function(){null===primitives.common._supportsSVG&&(primitives.common._supportsSVG=document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.0"));return primitives.common._supportsSVG};primitives.common._supportsVML=null;
primitives.common.supportsVML=function(){var a,b;null===primitives.common._supportsVML&&(primitives.common._supportsVML=!1,jQuery.support.opacity||(a=document.createElement("div"),a=document.body.appendChild(a),a.innerHTML='<v:shape adj="1" />',b=a.firstChild,b.style.behavior="url(#default#VML)",primitives.common._supportsVML=b?"object"===typeof b.adj:!1,a.parentNode.removeChild(a)));return primitives.common._supportsVML};primitives.common._supportsCanvas=null;
primitives.common.supportsCanvas=function(){null===primitives.common._supportsCanvas&&(primitives.common._supportsCanvas=!!window.HTMLCanvasElement);return primitives.common._supportsCanvas};
primitives.common.createGraphics=function(a,b){var c=null,d,e;d=[a];for(e in primitives.common.GraphicsType)primitives.common.GraphicsType.hasOwnProperty(e)&&d.push(primitives.common.GraphicsType[e]);for(e=0;null===c&&e<d.length;e+=1)switch(d[e]){case 2:primitives.common.supportsVML()&&(c=new primitives.common.VmlGraphics(b));break;case 0:primitives.common.supportsSVG()&&(c=new primitives.common.SvgGraphics(b));break;case 1:primitives.common.supportsCanvas()&&(c=new primitives.common.CanvasGraphics(b))}return c};
primitives.common.getColorHexValue=function(a){var b,c,d;if("#"===a.substr(0,1))return a;b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null!==b&&0<b.length)return a=parseInt(b[2],10),c=parseInt(b[3],10),d=parseInt(b[4],10),a=(a<<16|c<<8|d).toString(16),b[1]+"000000".substr(0,6-a.length)+a;if(void 0===primitives.common.ColorHexs)for(c in primitives.common.ColorHexs={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(c)&&(primitives.common.ColorHexs[c.toUpperCase()]=primitives.common.Colors[c]);
return primitives.common.ColorHexs[a.toUpperCase()]};primitives.common.getColorName=function(a){var b,a=primitives.common.getColorHexValue(a);if(void 0===primitives.common.ColorNames)for(b in primitives.common.ColorNames={},primitives.common.Colors)primitives.common.Colors.hasOwnProperty(b)&&(primitives.common.ColorNames[primitives.common.Colors[b]]=b);return primitives.common.ColorNames[a]};primitives.common.getRed=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(1,2),16):null};
primitives.common.getGreen=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(3,2),16):null};primitives.common.getBlue=function(a){return"#"===a.substr(0,1)&&7===a.length?parseInt(a.substr(5,2),16):null};
primitives.common.beforeOpacity=function(a,b){var c=primitives.common,d,e,a=c.getColorHexValue(a);d=Math.ceil((c.getRed(a)-255*(1-b))/b);e=Math.ceil((c.getGreen(a)-255*(1-b))/b);c=Math.ceil((c.getBlue(a)-255*(1-b))/b);d=(d<<16|e<<8|c).toString(16);return"#"+"000000".substr(0,6-d.length)+d};
primitives.common.highestContrast=function(a,b,c){var d=b,e=primitives.common,f=a+","+b+","+c;void 0===e.highestContrasts&&(e.highestContrasts={});e.highestContrasts.hasOwnProperty(f)?d=e.highestContrasts[f]:(e.luminosity(b,a)<e.luminosity(c,a)&&(d=c),e.highestContrasts[f]=d);return d};
primitives.common.luminosity=function(a,b){var c=primitives.common,d=c.getColorHexValue(a),e=c.getColorHexValue(b),d=0.2126*Math.pow(c.getRed(d)/255,2.2)+0.7152*Math.pow(c.getRed(d)/255,2.2)+0.0722*Math.pow(c.getRed(d)/255,2.2),c=0.2126*Math.pow(c.getRed(e)/255,2.2)+0.7152*Math.pow(c.getRed(e)/255,2.2)+0.0722*Math.pow(c.getRed(e)/255,2.2);return d>c?(d+0.05)/(c+0.05):(c+0.05)/(d+0.05)};
primitives.common.compareArrays=function(a,b,c){var d=!0,e,f,g,h;if(a.length!=b.length)d=!1;else{h={};e=0;for(f=a.length;e<f;e+=1)g=null!=c?c(a[e]):a[e],h[g]=h.hasOwnProperty(g)?h[g]+1:1;e=0;for(f=b.length;e<f;e+=1)if(g=null!=c?c(b[e]):b[e],h.hasOwnProperty(g)){if(h[g]-=1,0>h[g]){d=!1;break}}else{d=!1;break}}return d};
primitives.common.Mouse=function(){function a(a){if(jQuery.ui.ie&&(!document.documentMode||9>document.documentMode)&&!a.button)a=c(a);else if(g){if(null!=e.onMouseDrag)e.onMouseDrag(a);a=a.preventDefault()}else{if(d(a)&&mouseDelayMet){if(null!=e.onMouseStart)e.onMouseStart(f);g=!0;if(null!=e.onMouseDrag)e.onMouseDrag(a)}a=!g}return a}function b(a){return c(a)}function c(c){jQuery(document).unbind("mousemove."+e.name,a).unbind("mouseup."+e.name,b);if(g&&(g=!1,c.target===f.target&&jQuery.data(c.target,
e.name+".preventClickEvent",!0),null!=e.onMouseStop))e.onMouseStop(c);return!1}function d(a){return Math.max(Math.abs(f.pageX-a.pageX),Math.abs(f.pageY-a.pageY))>=e.distance}var e={distance:3,delay:0,element:null,name:null,onMouseStart:null,onMouseDrag:null,onMouseStop:null,onMouseCapture:null},f,g;return{init:function(h,i){e.element=h;for(var j in i)i.hasOwnProperty(j)&&(e[j]=i[j]);e.element.bind("mousedown."+e.name,function(h){a:if(primitives.common.Mouse.MouseHandled)h=void 0;else{g&&c(h);f=h;
var i=1===h.which,m=h.target.nodeName?jQuery(h.target).closest("input,textarea,button,select,option").length:!1;if(!(i=!i))m||(m=null!=e.onMouseCapture?e.onMouseCapture(h):!0,m=!m),i=m;if(!i){(mouseDelayMet=!e.delay)||(_mouseDelayTimer=setTimeout(function(){mouseDelayMet=!0},e.delay));if(d(h)&&mouseDelayMet){if(null!=e.onMouseStart)e.onMouseStart(h);g=!0;if(!g){h.preventDefault();h=!0;break a}}!0===jQuery.data(h.target,e.name+".preventClickEvent")&&jQuery.removeData(h.target,e.name+".preventClickEvent");
jQuery(document).bind("mousemove."+e.name,a).bind("mouseup."+e.name,b);h.preventDefault();primitives.common.Mouse.MouseHandled=!0}h=!0}return h}).bind("click."+e.name,function(a){if(!0===jQuery.data(a.target,e.name+".preventClickEvent"))return jQuery.removeData(a.target,e.name+".preventClickEvent"),a.stopImmediatePropagation(),!1})},destroy:function(){e.element.unbind("."+e.name);a&&jQuery(document).unbind("mousemove."+e.name,a).unbind("mouseup."+e.name,b)},isStarted:function(){return g}}};
primitives.common.Mouse.MouseHandled=!1;"undefined"!=typeof jQuery&&jQuery(document).mouseup(function(){primitives.common.Mouse.MouseHandled=!1});primitives.common.AdviserPlacementType={Auto:0,Left:2,Right:3};primitives.orgdiagram.AdviserPlacementType=primitives.common.AdviserPlacementType;primitives.common.VerticalAlignmentType={Top:0,Middle:1,Bottom:2};primitives.common.VectorRelationType={None:0,Null:1,Collinear:2,Opposite:3};primitives.common.UpdateMode={Recreate:0,Refresh:1,PositonHighlight:2};
primitives.orgdiagram.UpdateMode=primitives.common.UpdateMode;primitives.text.TextOrientationType={Horizontal:0,RotateLeft:1,RotateRight:2,Auto:3};primitives.common.SideFlag={Top:1,Right:2,Bottom:4,Left:8};primitives.common.ShapeType={Rectangle:0,Oval:1,Triangle:2,CrossOut:3,Circle:4,Rhombus:5,Wedge:7,FramedOval:8,FramedTriangle:9,FramedWedge:10,FramedRhombus:11,None:6};primitives.common.SelectionPathMode={None:0,FullStack:1};primitives.orgdiagram.SelectionPathMode=primitives.common.SelectionPathMode;
primitives.common.SegmentType={Line:0,Move:1,QuadraticArc:2,CubicArc:3,Dot:4};primitives.common.RenderingMode={Create:0,Update:1};primitives.common.PlacementType={Auto:0,TopLeft:8,Top:1,TopRight:2,RightTop:11,Right:3,RightBottom:12,BottomRight:4,Bottom:5,BottomLeft:6,LeftBottom:10,Left:7,LeftTop:9};primitives.common.PageFitMode={None:0,PageWidth:1,PageHeight:2,FitToPage:3,PrintPreview:4,AutoSize:5,SelectionOnly:6};primitives.orgdiagram.PageFitMode=primitives.common.PageFitMode;
primitives.common.OrientationType={Top:0,Bottom:1,Left:2,Right:3,None:4};primitives.orgdiagram.OrientationType=primitives.common.OrientationType;primitives.common.NeighboursSelectionMode={ParentsAndChildren:0,ParentsChildrenSiblingsAndSpouses:1};primitives.common.NavigationMode={Default:0,CursorOnly:1,HighlightOnly:3,Inactive:2};primitives.common.LineType={Solid:0,Dotted:1,Dashed:2};
primitives.common.Layers={PrintPreview:1,BackgroundAnnotation:2,BackgroundAnnotations:3,BackgroundConnectorAnnotation:4,BackgroundHighlightPathAnnotations:5,Connector:6,ForegroundHighlightPathAnnotations:7,Highlight:8,Marker:9,Label:10,Cursor:11,Item:12,ForegroundAnnotations:13,ForegroundConnectorAnnotation:14,Annotation:15,Controls:16};primitives.common.LabelType={Regular:0,Dummy:1,Fixed:2};primitives.common.AnnotationType={Connector:0,Shape:1,HighlightPath:2,Label:3,Background:4};
primitives.common.ChildrenPlacementType={Auto:0,Vertical:1,Horizontal:2,Matrix:3};primitives.orgdiagram.ChildrenPlacementType=primitives.common.ChildrenPlacementType;
primitives.common.Colors={AliceBlue:"#f0f8ff",AntiqueWhite:"#faebd7",Aqua:"#00ffff",Aquamarine:"#7fffd4",Azure:"#f0ffff",Beige:"#f5f5dc",Bisque:"#ffe4c4",Black:"#000000",BlanchedAlmond:"#ffebcd",Blue:"#0000ff",BlueViolet:"#8a2be2",Brown:"#a52a2a",BurlyWood:"#deb887",Bronze:"#cd7f32",CadetBlue:"#5f9ea0",ChartReuse:"#7fff00",Chocolate:"#d2691e",Coral:"#ff7f50",CornflowerBlue:"#6495ed",Cornsilk:"#fff8dc",Crimson:"#dc143c",Cyan:"#00ffff",DarkBlue:"#00008b",DarkCyan:"#008b8b",DarkGoldenrod:"#b8860b",DarkGray:"#a9a9a9",
DarkGreen:"#006400",DarkKhaki:"#bdb76b",DarkMagenta:"#8b008b",DarkOliveGreen:"#556b2f",Darkorange:"#ff8c00",DarkOrchid:"#9932cc",DarkRed:"#8b0000",DarkSalmon:"#e9967a",DarkSeaGreen:"#8fbc8f",DarkSlateBlue:"#483d8b",DarkSlateGray:"#2f4f4f",DarkTurquoise:"#00ced1",DarkViolet:"#9400d3",DeepPink:"#ff1493",DeepSkyBlue:"#00bfff",DimGray:"#696969",DodgerBlue:"#1e90ff",FireBrick:"#b22222",FloralWhite:"#fffaf0",ForestGreen:"#228b22",Fuchsia:"#ff00ff",Gainsboro:"#dcdcdc",GhostWhite:"#f8f8ff",Gold:"#ffd700",
Goldenrod:"#daa520",Gray:"#808080",Green:"#008000",GreenYellow:"#adff2f",Honeydew:"#f0fff0",Hotpink:"#ff69b4",IndianRed:"#cd5c5c",Indigo:"#4b0082",Ivory:"#fffff0",Khaki:"#f0e68c",Lavender:"#e6e6fa",LavenderBlush:"#fff0f5",Lawngreen:"#7cfc00",Lemonchiffon:"#fffacd",LightBlue:"#add8e6",LightCoral:"#f08080",LightCyan:"#e0ffff",LightGoldenrodYellow:"#fafad2",LightGray:"#d3d3d3",LightGreen:"#90ee90",LightPink:"#ffb6c1",LightSalmon:"#ffa07a",LightSeaGreen:"#20b2aa",LightSkyBlue:"#87cefa",LightSlateGray:"#778899",
LightSteelBlue:"#b0c4de",LightYellow:"#ffffe0",Lime:"#00ff00",Limegreen:"#32cd32",Linen:"#faf0e6",Magenta:"#ff00ff",Maroon:"#800000",MediumAquamarine:"#66cdaa",MediumBlue:"#0000cd",MediumOrchid:"#ba55d3",MediumPurple:"#9370d8",MediumSeaGreen:"#3cb371",MediumSlateBlue:"#7b68ee",MediumSpringGreen:"#00fa9a",MediumTurquoise:"#48d1cc",MediumVioletRed:"#c71585",MidnightBlue:"#191970",MintCream:"#f5fffa",MistyRose:"#ffe4e1",Moccasin:"#ffe4b5",NavajoWhite:"#ffdead",Navy:"#000080",Oldlace:"#fdf5e6",Olive:"#808000",
Olivedrab:"#6b8e23",Orange:"#ffa500",OrangeRed:"#ff4500",Orchid:"#da70d6",PaleGoldenRod:"#eee8aa",PaleGreen:"#98fb98",PaleTurquoise:"#afeeee",PaleVioletRed:"#d87093",Papayawhip:"#ffefd5",Peachpuff:"#ffdab9",Peru:"#cd853f",Pink:"#ffc0cb",Plum:"#dda0dd",PowderBlue:"#b0e0e6",Purple:"#800080",Red:"#ff0000",RosyBrown:"#bc8f8f",RoyalBlue:"#4169e1",SaddleBrown:"#8b4513",Salmon:"#fa8072",SandyBrown:"#f4a460",SeaGreen:"#2e8b57",Seashell:"#fff5ee",Sienna:"#a0522d",Silver:"#c0c0c0",SkyBlue:"#87ceeb",SlateBlue:"#6a5acd",
SlateGray:"#708090",Snow:"#fffafa",SpringGreen:"#00ff7f",SteelBlue:"#4682b4",Tan:"#d2b48c",Teal:"#008080",Thistle:"#d8bfd8",Tomato:"#ff6347",Turquoise:"#40e0d0",Violet:"#ee82ee",Wheat:"#f5deb3",White:"#ffffff",WhiteSmoke:"#f5f5f5",Yellow:"#ffff00",YellowGreen:"#9acd32"};primitives.common.ConnectorLabelPlacementType={From:0,Between:1,To:2};primitives.common.ConnectorPlacementType={Offbeat:0,Straight:1};primitives.common.ConnectorShapeType={OneWay:0,TwoWay:1,BothWay:2};
primitives.common.Visibility={Auto:0,Normal:1,Dot:2,Line:3,Invisible:4};primitives.common.ConnectorStyleType={Extra:0,Regular:1,Highlight:2};primitives.common.ElbowType={None:0,Dot:1,Bevel:2,Round:3};primitives.common.Enabled={Auto:0,True:1,False:2};primitives.common.GraphicsType={SVG:0,Canvas:1,VML:2};primitives.common.GroupByType={None:0,Parents:1,Children:2};primitives.common.HorizontalAlignmentType={Center:0,Left:1,Right:2};
primitives.orgdiagram.ItemType={Regular:0,Assistant:1,SubAssistant:4,SuperAssistant:10,SuperAdviser:9,SubAdviser:5,Adviser:2,Director:11,GeneralPartner:6,LimitedPartner:7,AdviserPartner:8};primitives.common.ConnectorType={Squared:0,Angular:1,Curved:2};primitives.orgdiagram.ConnectorType=primitives.common.ConnectorType;primitives.common.ZOrderType={Auto:0,Background:1,Foreground:2};
primitives.common.RenderEventArgs=function(){this.renderingMode=this.templateName=this.context=this.element=null;this.isSelected=this.isCursor=!1};primitives.common.BaseShape=function(){};
primitives.common.BaseShape.prototype._getLabelPosition=function(a,b,c,d,e,f,g,h){var i=null;switch(h){case 1:i=new primitives.common.Rect(a+c/2-e/2,b-g-f,e,f);break;case 2:i=new primitives.common.Rect(a+c-e,b-g-f,e,f);break;case 8:i=new primitives.common.Rect(a,b-g-f,e,f);break;case 3:i=new primitives.common.Rect(a+c+g,b+d/2-f/2,e,f);break;case 11:i=new primitives.common.Rect(a+c+g,b,e,f);break;case 12:i=new primitives.common.Rect(a+c+g,b+d-f,e,f);break;case 4:i=new primitives.common.Rect(a+c-e,
b+d+g,e,f);break;case 6:i=new primitives.common.Rect(a,b+d+g,e,f);break;case 7:i=new primitives.common.Rect(a-e-g,b+d/2-f/2,e,f);break;case 9:i=new primitives.common.Rect(a-e-g,b,e,f);break;case 10:i=new primitives.common.Rect(a-e-g,b+d-f,e,f);break;default:i=new primitives.common.Rect(a+c/2-e/2,b+d+g,e,f)}return i};primitives.common.BaseShape.prototype._betweenPoint=function(a,b){return new primitives.common.Point((a.x+b.x)/2,(a.y+b.y)/2)};
primitives.common.BaseShape.prototype._offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};primitives.common.Callout=function(a){this.m_graphics=a;this.pointerPlacement=0;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.pointerWidth="10%";this.borderColor="#000000";this.lineType=0;this.fillColor="#d3d3d3";this.m_map=[[8,7,6],[1,null,5],[2,3,4]]};
primitives.common.Callout.prototype=new primitives.common.BaseShape;
primitives.common.Callout.prototype.draw=function(a,b){var b=(new primitives.common.Rect(b)).offset(this.offset),c=new primitives.common.Point(b.x,b.y),d=new primitives.common.Point(b.right(),b.y),e=new primitives.common.Point(b.right(),b.bottom()),f=new primitives.common.Point(b.left(),b.bottom()),g=[null,null,null,null,null,null,null,null],f=[c,d,e,f],d=this.m_graphics.getPxSize(this.cornerRadius,Math.min(c.distanceTo(d),d.distanceTo(e))),h,i;h={};null!==this.fillColor&&(h.fillColor=this.fillColor,
h.opacity=this.opacity);null!==this.lineColor&&(h.lineColor=this.borderColor);h.lineWidth=this.lineWidth;h.lineType=this.lineType;i=new primitives.common.PaletteItem(h);h=new primitives.common.PolylinesBuffer;i=h.getPolyline(i);null!==a&&(c=0===this.pointerPlacement?this._getPlacement(a,c,e):this.pointerPlacement,null!==c&&(g[c]=a));for(e=0;e<f.length;e+=1)this._drawSegment(i,f[0],f[1],f[2],this.pointerWidth,d,g[1],g[2]),c=f.shift(),f.push(c),c=g.shift(),g.push(c),c=g.shift(),g.push(c);this.m_graphics.polylinesBuffer(h)};
primitives.common.Callout.prototype._getPlacement=function(a,b,c){var d=null,e=null,d=a.x<b.x?0:a.x>c.x?2:1,e=a.y<b.y?0:a.y>c.y?2:1;return this.m_map[d][e]};
primitives.common.Callout.prototype._drawSegment=function(a,b,c,d,e,f,g,h){var i=this._offsetPoint(b,c,f),j=this._offsetPoint(c,b,f),d=this._offsetPoint(c,d,f),e=this.m_graphics.getPxSize(e,b.distanceTo(c)/2);0===a.length()&&a.addSegment(new primitives.common.MoveSegment(i));null!==g&&(i=this._betweenPoint(b,c),b=this._offsetPoint(i,b,e),e=this._offsetPoint(i,c,e),a.addSegment(new primitives.common.LineSegment(b)),a.addSegment(new primitives.common.LineSegment(g)),a.addSegment(new primitives.common.LineSegment(e)));
a.addSegment(new primitives.common.LineSegment(j));null!==h?(a.addSegment(new primitives.common.LineSegment(h)),a.addSegment(new primitives.common.LineSegment(d))):a.addSegment(new primitives.common.QuadraticArcSegment(c,d))};primitives.common.ConnectorOffbeat=function(){};primitives.common.ConnectorOffbeat.prototype=new primitives.common.BaseShape;
primitives.common.ConnectorOffbeat.prototype.draw=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var q,s,p,r,y,w,t,u,m=f=0,z=null,v,x;v=a.getPolyline(b);y=[];switch(i){case 1:y=[-e/2,e/2];x=!1;break;case 0:y=[0];x=!1;break;case 2:y=[0],x=!0}q=Math.max(l?g.width:0,5*e);if(c.right()+q<d.left()||c.left()>d.right()+q)if(c.left()>d.right()?(p=new primitives.common.Point(c.left(),c.verticalCenter()),r=new primitives.common.Point(d.right(),d.verticalCenter())):(p=new primitives.common.Point(c.right(),c.verticalCenter()),
r=new primitives.common.Point(d.left(),d.verticalCenter())),l&&(c.left()>d.right()?(f=7,m=3):(f=3,m=7)),s=new primitives.common.Rect(p,r),u=p.y<=r.y,t=p.x<r.x,s.height<s.width){s.height<2*e&&s.offset(0,u?2*e:0,0,u?0:2*e);h=0;for(q=y.length;h<q;h+=1)w=y[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(p.x,p.y+w));c.addSegment(new primitives.common.QuadraticArcSegment(s.horizontalCenter(),(u?s.top():s.bottom())+w,r.x,r.y+w));x&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},
h||0==i),v.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(i=g.width<2*(s.width/5)?primitives.common.QuadraticArcSegment.prototype.offsetPoint(p.x,p.y,s.horizontalCenter(),u?s.top():s.bottom(),r.x,r.y,0.5):new primitives.common.Point(p.x,u?s.top():s.bottom()),z=new primitives.common.Rect(i.x+(t?e:-g.width-e),u?i.y-g.height-e:i.y+e,g.width,g.height))}else{h=0;for(q=y.length;h<q;h+=1)w=y[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(p.x,
p.y+w));c.addSegment(new primitives.common.QuadraticArcSegment(s.horizontalCenter()+w*(u!=t?1:-1),(u?s.top():s.bottom())+w,s.horizontalCenter()+w*(u!=t?1:-1),s.verticalCenter()+w));c.addSegment(new primitives.common.QuadraticArcSegment(s.horizontalCenter()+w*(u!=t?1:-1),(u?s.bottom():s.top())+w,r.x,r.y+w));x&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),v.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(z=new primitives.common.Rect(s.horizontalCenter()+
(u!=t?e:-(e+g.width)),s.verticalCenter()-g.height/2,g.width,g.height))}else if(c.verticalCenter()<d.top()||c.verticalCenter()>d.bottom()){t=c.x<h.width/2;p=new primitives.common.Point(t?c.right():c.left(),c.verticalCenter());r=new primitives.common.Point(t?d.right():d.left(),d.verticalCenter());s=new primitives.common.Rect(p,r);s.offset(10*e,0,10*e,0);u=p.y<=r.y;h=0;for(q=y.length;h<q;h+=1)w=y[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(p.x,p.y+w));
c.addSegment(new primitives.common.QuadraticArcSegment(t?s.right()+w*(u?-1:1):s.left()-w*(u?-1:1),s.verticalCenter(),t?d.right():d.left(),d.verticalCenter()-w));x&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),v.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(m=f=t?3:7,i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(p.x,p.y,t?s.right():s.left(),s.verticalCenter(),r.x,r.y,0.5),z=new primitives.common.Rect(i.x+(t?
e/2:-e/2-g.width),i.y-g.height/2,g.width,g.height))}else{p=new primitives.common.Point(c.horizontalCenter(),c.top());r=new primitives.common.Point(d.horizontalCenter(),d.top());s=new primitives.common.Rect(p,r);s.offset(0,7*e,0,0);t=p.x<r.x;h=0;for(q=y.length;h<q;h+=1)w=y[h],a.addInverted(function(c){c=c.getPolyline(b);c.addSegment(new primitives.common.MoveSegment(p.x+w,p.y));c.addSegment(new primitives.common.QuadraticArcSegment(s.horizontalCenter(),s.top()-w*(t?-1:1),d.horizontalCenter()-w,d.top()));
x&&c.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},h||0==i),v.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))});l&&(m=f=1,i=primitives.common.QuadraticArcSegment.prototype.offsetPoint(p.x,p.y,s.horizontalCenter(),s.top(),r.x,r.y,0.5),z=new primitives.common.Rect(i.x-g.width/2,i.y-(j+g.height),g.width,g.height))}if(l)switch(k){case 0:z=this._getLabelPosition(c.x,c.y,c.width,c.height,z.width,z.height,j,f);break;case 2:z=this._getLabelPosition(d.x,
d.y,d.width,d.height,z.width,z.height,j,m)}null!=n&&n(z)};primitives.common.ConnectorStraight=function(){};primitives.common.ConnectorStraight.prototype=new primitives.common.BaseShape;
primitives.common.ConnectorStraight.prototype.draw=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var q,s,p,r,y,w=e/2,t=null,u=0,z=0,v=this;r=new primitives.common.Vector(c.centerPoint(),d.centerPoint());c.loopEdges(function(a,b){q=a.getIntersectionPoint(r,!0,1);u=b;return null!=q});d.loopEdges(function(a,b){s=a.getIntersectionPoint(r,!0,1);z=b;return null!=s});if(null!=q&&null!=s){var x=new primitives.common.Vector(q,s);m.getOffset(x,function(c,d,e){x.offset((c*f-(d-1)*f/2)*e);q=x.from;s=x.to;switch(i){case 1:y=
new primitives.common.Vector(s.clone(),q.clone());y.offset(w);v._drawLine(a,b,y.from,y.to,!1);y=new primitives.common.Vector(q.clone(),s.clone());y.offset(w);v._drawLine(a,b,y.from,y.to,!1);break;case 0:v._drawLine(a,b,q,s,!1);break;case 2:v._drawLine(a,b,q,s,!0)}if(l){switch(k){case 0:t=v._getLabelPositionBySnapPoint(q.x,q.y,g.width,g.height,j,u);break;case 1:p=v._betweenPoint(q,s);t=v._getLabelPositionBySnapPoint(p.x,p.y,g.width,g.height,j,3);break;case 2:t=v._getLabelPositionBySnapPoint(s.x,s.y,
g.width,g.height,j,z)}null!=n&&n.call(this,t)}})}};primitives.common.ConnectorStraight.prototype._drawLine=function(a,b,c,d,e){var f;a.addInverted(function(e){f=e.getPolyline(b);f.addSegment(new primitives.common.MoveSegment(c));f.addSegment(new primitives.common.LineSegment(d));f.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))})},!1);e&&(f=a.getPolyline(b),f.addArrow(b.lineWidth,function(b){b.mergeTo(a.getPolyline(b.paletteItem))}))};
primitives.common.ConnectorStraight.prototype._getLabelPositionBySnapPoint=function(a,b,c,d,e,f){var g=null;switch(f){case 0:case 1:g=new primitives.common.Rect(a-c/2,b-e-d,c,d);break;case 3:g=new primitives.common.Rect(a+e,b-d/2,c,d);break;case 5:g=new primitives.common.Rect(a-c/2,b+e,c,d);break;case 7:g=new primitives.common.Rect(a-c-e,b-d/2,c,d)}return g};primitives.common.Marker=function(){};primitives.common.Marker.Markers={};
primitives.common.Marker.DrawCircle=function(a,b){var c=Math.min(b.width/2,b.height/2),b=new primitives.common.Rect(b.horizontalCenter()-c,b.verticalCenter()-c,2*c,2*c);primitives.common.Marker.DrawOval(a,b)};
primitives.common.Marker.DrawRectangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.bottom()));a.addSegment(new primitives.common.LineSegment(b.x,b.verticalCenter()))};
primitives.common.Marker.DrawOval=function(a,b){var c,d;c=0.5522848*(b.width/2);d=0.5522848*(b.height/2);a.addSegment(new primitives.common.MoveSegment(b.x,b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.x,b.verticalCenter()-d,b.horizontalCenter()-c,b.y,b.horizontalCenter(),b.y));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()+c,b.y,b.right(),b.verticalCenter()-d,b.right(),b.verticalCenter()));a.addSegment(new primitives.common.CubicArcSegment(b.right(),
b.verticalCenter()+d,b.horizontalCenter()+c,b.bottom(),b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.CubicArcSegment(b.horizontalCenter()-c,b.bottom(),b.x,b.verticalCenter()+d,b.x,b.verticalCenter()))};
primitives.common.Marker.DrawTriangle=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.left(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawCrossOut=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.x,b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),b.bottom()));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.right(),
b.y));a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.left(),b.bottom()))};
primitives.common.Marker.DrawRhombus=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.verticalCenter()));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()))};
primitives.common.Marker.DrawWedge=function(a,b){a.addSegment(new primitives.common.MoveSegment(b.horizontalCenter(),b.y));a.addSegment(new primitives.common.LineSegment(b.right(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.bottom()));a.addSegment(new primitives.common.LineSegment(b.left(),b.y));a.addSegment(new primitives.common.LineSegment(b.horizontalCenter(),b.y))};
primitives.common.Marker.DrawFramedOval=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawOval(a,b)};primitives.common.Marker.DrawFramedTriangle=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawTriangle(a,b)};primitives.common.Marker.DrawFramedWedge=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawWedge(a,b)};
primitives.common.Marker.DrawFramedRhombus=function(a,b){primitives.common.Marker.DrawRectangle(a,b);primitives.common.Marker.DrawRhombus(a,b)};primitives.common.Marker.DrawNone=function(){};primitives.common.Marker.Markers[4]=primitives.common.Marker.DrawCircle;primitives.common.Marker.Markers[0]=primitives.common.Marker.DrawRectangle;primitives.common.Marker.Markers[1]=primitives.common.Marker.DrawOval;primitives.common.Marker.Markers[2]=primitives.common.Marker.DrawTriangle;
primitives.common.Marker.Markers[3]=primitives.common.Marker.DrawCrossOut;primitives.common.Marker.Markers[5]=primitives.common.Marker.DrawRhombus;primitives.common.Marker.Markers[7]=primitives.common.Marker.DrawWedge;primitives.common.Marker.Markers[8]=primitives.common.Marker.DrawFramedOval;primitives.common.Marker.Markers[9]=primitives.common.Marker.DrawFramedTriangle;primitives.common.Marker.Markers[10]=primitives.common.Marker.DrawFramedWedge;primitives.common.Marker.Markers[11]=primitives.common.Marker.DrawFramedRhombus;
primitives.common.Marker.Markers[6]=primitives.common.Marker.DrawNone;primitives.common.Marker.prototype.draw=function(a,b,c,d){a=a.getPolyline(d);primitives.common.Marker.Markers[b](a,c)};primitives.common.Perimeter=function(a){this.m_graphics=a;this.transform=null;this.opacity=this.lineWidth=1;this.fillColor=null;this.lineType=0;this.borderColor=null};primitives.common.Perimeter.prototype=new primitives.common.BaseShape;
primitives.common.Perimeter.prototype.draw=function(a){var b=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,fillColor:this.fillColor,lineType:this.lineType,opacity:this.opacity}),c=new primitives.common.Polyline(b),d=this.lineWidth/2,e=null,f=null,g=null,h={};a.segments.iterate(function(b){var j=0,k=0,l=!1;if(0<d)switch(b.orientationType){case 3:j=-d;l=!1;break;case 2:j=d;l=!1;break;case 0:k=d;l=!0;break;case 1:k=-d;l=!0;break;default:throw"Orientation is not defined!";
}0===c.length()&&(f=new primitives.common.MoveSegment(b.fromPoint),c.addSegment(f),h[a.segments.endKey()]={point:f,isVertical:l});j=null!=a.segments.item(b.oppositeKey)?new primitives.common.MoveSegment(b.toPoint.x+j,b.toPoint.y+k):new primitives.common.LineSegment(b.toPoint.x+j,b.toPoint.y+k);c.addSegment(j);0<d&&(l?f.y=j.y:f.x=j.x,null!=e&&(!a.segments.item(e.oppositeKey)&&null!=a.segments.item(b.oppositeKey)?h.hasOwnProperty(b.oppositeKey)?(k=h[b.oppositeKey],k.isVertical?f.y=k.point.y:f.x=k.point.x,
g?k.point.y=f.y:k.point.x=f.x):h[b.oppositeKey]={point:f,isVertical:g}:null!=a.segments.item(e.oppositeKey)&&!a.segments.item(b.oppositeKey)&&(h.hasOwnProperty(e.key)?(k=h[e.key],k.isVertical?f.y=k.point.y:f.x=k.point.x,g?k.point.y=f.y:k.point.x=f.x):h[e.key]={point:f,isVertical:l})),g=l,e=b);f=j});0<d&&!a.segments.item(e.oppositeKey)&&(b=h[e.key],b.isVertical?f.y=b.point.y:f.x=b.point.x,g?b.point.y=f.y:b.point.x=f.x);c.transform(this.transform,!0);this.m_graphics.polyline(c)};
primitives.common.Shape=function(a){this.m_graphics=a;this.transform=null;this.orientationType=0;this.panelSize=null;this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=1;this.labelOffset=4;this.cornerRadius="10%";this.opacity=1;this.fillColor=null;this.labelSize=new primitives.common.Size(60,30);this.lineType=0;this.borderColor=null;this.hasLabel=!1;this.labelTemplate=null;this.labelPlacement=0};primitives.common.Shape.prototype=new primitives.common.BaseShape;
primitives.common.Shape.prototype.draw=function(a,b){var c,d,e,f,a=(new primitives.common.Rect(a)).offset(this.offset);this.transform=new primitives.common.Transform;this.transform.size=this.panelSize;this.transform.setOrientation(this.orientationType);this.hasLabel&&(c=this._getLabelPosition(a.x,a.y,a.width,a.height,this.labelSize.width,this.labelSize.height,this.labelOffset,this.labelPlacement));switch(this.shapeType){case 0:d=new primitives.common.Callout(this.m_graphics);d.cornerRadius=this.cornerRadius;
d.opacity=this.opacity;d.lineWidth=this.lineWidth;d.lineType=this.lineType;d.borderColor=this.borderColor;d.fillColor=this.fillColor;d.draw(null,a);break;default:d=new primitives.common.PaletteItem({lineColor:this.borderColor,lineWidth:this.lineWidth,lineType:this.lineType,fillColor:this.fillColor,opacity:this.opacity}),this.transform.transformRect(a.x,a.y,a.width,a.height,!1,this,function(b,c,d,f){a=new primitives.common.Rect(b,c,d,f)}),f=new primitives.common.Marker,e=new primitives.common.PolylinesBuffer,
f.draw(e,this.shapeType,a,d),e.transform(this.transform,!0),this.m_graphics.polylinesBuffer(e)}this.hasLabel&&this.m_graphics.template(c.x,c.y,0,0,0,0,c.width,c.height,this.labelTemplate.template(),this.labelTemplate.getHashCode(),this.labelTemplate.render,b,null)};primitives.common.Point=function(a,b){this.context=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.context=a.context;break;case 2:this.x=a,this.y=b}};
primitives.common.Point.prototype.scale=function(a){this.x*=a;this.x*=a;return this};primitives.common.Point.prototype.distanceTo=function(a,b){var c=0,d=0;switch(arguments.length){case 1:c=a.x;d=a.y;break;case 2:c=a,d=b}c=this.x-c;d=this.y-d;return Math.sqrt(c*c+d*d)};primitives.common.Point.prototype.equalTo=function(a){return this.x==a.x&&this.y==a.y};primitives.common.Point.prototype.swap=function(a){var b=a.x,c=a.y;a.x=this.x;a.y=this.y;this.x=b;this.y=c};
primitives.common.Point.prototype.clone=function(){return new primitives.common.Point(this)};primitives.common.Point.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");return b+="top:"+this.y+a+";"};primitives.common.MoveSegment=function(){this.parent=primitives.common.Point.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=1};primitives.common.MoveSegment.prototype=new primitives.common.Point;primitives.common.MoveSegment.prototype.clone=function(){return new primitives.common.MoveSegment(this)};
primitives.common.MoveSegment.prototype.loop=function(a,b){null!=b&&b.call(a,this.x,this.y,0)};primitives.common.MoveSegment.prototype.setPoint=function(a){this.x=a.x;this.y=a.y};primitives.common.MoveSegment.prototype.getEndPoint=function(){return this};primitives.common.MoveSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};primitives.common.MoveSegment.prototype.transform=function(a,b){var c=this;a.transformPoint(c.x,c.y,b,c,function(a,b){c.x=a;c.y=b})};
primitives.common.CubicArcSegment=function(a,b,c,d,e,f){this.parent=primitives.common.Point.prototype;this.cpY2=this.cpX2=this.cpY1=this.cpX1=this.y=this.x=null;switch(arguments.length){case 3:this.parent.constructor.apply(this,[c.x,c.y]);this.cpX1=a.x;this.cpY1=a.y;this.cpX2=b.x;this.cpY2=b.y;break;case 6:this.parent.constructor.apply(this,[e,f]),this.cpX1=a,this.cpY1=b,this.cpX2=c,this.cpY2=d}this.segmentType=3};primitives.common.CubicArcSegment.prototype=new primitives.common.Point;
primitives.common.CubicArcSegment.prototype.clone=function(){return new primitives.common.CubicArcSegment(this.cpX1,this.cpY1,this.cpX2,this.cpY2,this.x,this.y)};primitives.common.CubicArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX1,this.cpY1,0),b.call(a,this.cpX2,this.cpY2,1),b.call(a,this.x,this.y,2))};
primitives.common.CubicArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX1=a.x;this.cpY1=a.y;break;case 1:this.cpX2=a.x;this.cpY2=a.y;break;case 2:this.x=a.x,this.y=a.y}};primitives.common.CubicArcSegment.prototype.getEndPoint=function(){return this};primitives.common.CubicArcSegment.prototype.invert=function(a){var b=this.cpX1,c=this.cpY1;this.x=a.x;this.y=a.y;this.cpX1=this.cpX2;this.cpY1=this.cpY2;this.cpX2=b;this.cpY2=c};
primitives.common.CubicArcSegment.prototype.transform=function(a,b){var c=this;a.transform3Points(c.x,c.y,c.cpX1,c.cpY1,c.cpX2,c.cpY2,b,c,function(a,b,f,g,h,i){c.x=a;c.y=b;c.cpX1=f;c.cpY1=g;c.cpX2=h;c.cpY2=i})};
primitives.common.CubicArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c),e=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/e.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX2,this.cpY2,this.cpX1,this.cpY1,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.CubicArcSegment.prototype.offsetPoint=function(a,b,c,d,e,f,g,h,i){return new primitives.common.Point((1-i)*(1-i)*(1-i)*a+3*(1-i)*(1-i)*i*c+3*(1-i)*i*i*e+i*i*i*g,(1-i)*(1-i)*(1-i)*b+3*(1-i)*(1-i)*i*d+3*(1-i)*i*i*f+i*i*i*h)};primitives.common.DotSegment=function(a,b,c,d,e){this.segmentType=4;this.x=a;this.y=b;this.width=c;this.height=d;this.cornerRadius=e};
primitives.common.Label=function(){this.position=this.text=null;this.weight=0;this.isActive=!0;this.horizontalAlignmentType=this.labelOrientation=this.labelType=0;this.verticalAlignmentType=2};primitives.common.LineSegment=function(){this.parent=primitives.common.MoveSegment.prototype;this.parent.constructor.apply(this,arguments);this.segmentType=0};primitives.common.LineSegment.prototype=new primitives.common.MoveSegment;primitives.common.LineSegment.prototype.clone=function(){return new primitives.common.LineSegment(this)};
primitives.common.LineSegment.prototype.trim=function(a,b){var c=this.offsetPoint(this,a,b);this.x=c.x;this.y=c.y;return this};primitives.common.LineSegment.prototype.offsetPoint=function(a,b,c){var d=null,d=a.distanceTo(b);return d=0===d||0===c?new primitives.common.Point(a):new primitives.common.Point(a.x+(b.x-a.x)/d*c,a.y+(b.y-a.y)/d*c)};
primitives.common.Matrix=function(a,b,c,d){this.b2=this.a2=this.b1=this.a1=null;switch(arguments.length){case 1:this.a1=a.a1;this.b1=a.b1;this.a2=a.a2;this.b2=a.b2;break;case 4:this.a1=a,this.b1=b,this.a2=c,this.b2=d}};primitives.common.Matrix.prototype.determinant=function(){return this.a1*this.b2-this.b1*this.a2};
primitives.common.PaletteItem=function(a){this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;this.opacity=this.fillColor=null;this._key="";var b,c,d,e;c=["lineColor","lineWidth","lineType","fillColor","opacity"];d=0;for(e=c.length;d<e;d+=1)b=c[d],null!=a&&a.hasOwnProperty(b)&&(this[b]=a[b]),this._key+=(!primitives.common.isNullOrEmpty(this._key)?", ":"")+b+":"+this[b]};
primitives.common.PaletteItem.prototype.toAttr=function(){var a={lineWidth:this.lineWidth,lineType:this.lineType};null!==this.fillColor&&(a.fillColor=this.fillColor);null!==this.opacity&&(a.opacity=this.opacity);null!==this.lineColor&&(a.borderColor=this.lineColor);return a};primitives.common.PaletteItem.prototype.toString=function(){return this._key};
primitives.common.PaletteManager=function(a,b){this.palette=[];this.cursor=0;var c,d;if(0===b.length)this.palette=[new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,lineType:a.linesType})],this.paletteLength=this.palette.length,this.regularIndex=0;else{c=0;for(d=b.length;c<d;c+=1)this.palette.push(new primitives.common.PaletteItem(b[c]));this.paletteLength=this.palette.length;this.palette.push(new primitives.common.PaletteItem({lineColor:a.linesColor,lineWidth:a.linesWidth,
lineType:a.linesType}));this.regularIndex=this.palette.length-1}this.palette.push(new primitives.common.PaletteItem({lineColor:a.highlightLinesColor,lineWidth:a.highlightLinesWidth,lineType:a.highlightLinesType}));this.highlightIndex=this.palette.length-1};primitives.common.PaletteManager.prototype.selectPalette=function(a){this.cursor=a%this.paletteLength};
primitives.common.PaletteManager.prototype.getPalette=function(a){var b=null;switch(a){case 1:b=this.regularIndex;break;case 2:b=this.highlightIndex;break;case 0:b=this.cursor}return this.palette[b]};
primitives.common.Polyline=function(a){function b(a,b){var c,d,f;if(null!=b){c=0;for(d=i.length;c<d&&(!(f=i[c])||!b.call(a,f,c));c+=1);}}function c(){return primitives.common.isNullOrEmpty(h.fillColor)}function d(a,b,c,d,f,e){for(var g=new primitives.common.Polyline(k),h,i,f=[new primitives.common.Point(f,-e/2),new primitives.common.Point(0,0),new primitives.common.Point(f,e/2),new primitives.common.Point(3*(f/4),0)],j=Math.atan2(b-d,a-c),a=0,b=f.length;a<b;a+=1)e=f[a],h=e.x*Math.cos(j)-e.y*Math.sin(j),
i=e.x*Math.sin(j)+e.y*Math.cos(j),e.x=h+c,e.y=i+d;g.addSegment(new primitives.common.MoveSegment(f[0].x,f[0].y));g.addSegment(new primitives.common.LineSegment(f[1].x,f[1].y));g.addSegment(new primitives.common.LineSegment(f[2].x,f[2].y));g.addSegment(new primitives.common.QuadraticArcSegment(f[3].x,f[3].y,f[0].x,f[0].y));return g}function e(a,b){this.segment=a;this.pointIndex=b}function f(a,b,c,d,f){var g=a.relateTo(b),h=f?0:c;2==g?b.offset(h):3==g&&0===b.from.context.pointIndex?(g=new primitives.common.LineSegment(b.from),
d.addSegment(g),b.offset(h),d=b.from.clone(),d.context=new e(g,0),h=new primitives.common.Vector(a.to.clone(),d),f||(b.from=d.clone()),h.offset(c),h.intersect(a),h.from.context.pushToSegment(h.from),b.intersect(h),f&&h.to.context.pushToSegment(h.to)):(b.offset(h),b.intersect(a));b.from.context.pushToSegment(b.from)}function g(a,b,c,d){var e,g=a[0],h=g.to.context.segment.getEndPoint().toString();b.hasOwnProperty(h)&&(e=b[h],f(g,e,c,d,!0),delete b[h]);g.to.context.pushToSegment(g.to);a.length=0}var h=
new primitives.common.PaletteItem,i=[],j,k;switch(arguments.length){case 1:h=a}k=new primitives.common.PaletteItem({lineColor:h.lineColor,lineWidth:0,fillColor:h.lineColor,opacity:h.opacity||1});e.prototype.pushToSegment=function(a){this.segment.setPoint(a,this.pointIndex)};return j={paletteItem:h,arrowPaletteItem:k,addSegment:function(a){i.push(a)},addSegments:function(a){i=i.concat(a)},mergeTo:function(a){a.addSegments(i)},length:function(){return i.length},loop:b,loopReversed:function(a,b){var c,
d;if(null!=b)for(c=i.length-1;0<=c&&(!(d=i[c])||!b.call(a,d,c));c-=1);},transform:function(a,c){b(this,function(b){null!=b.transform&&b.transform(a,c)})},isInvertable:c,addInverted:function(a){var b=!1,d=[];c()?a.loopReversed(this,function(a){4!=a.segmentType&&(b||(i.push(new primitives.common.MoveSegment(a.getEndPoint())),b=!0),d.unshift(a),1<d.length&&(d[1].invert(d[0].getEndPoint()),i.push(d[1]),d.length=1))}):a.mergeTo(j)},addArrow:function(a,b){var c,f,e,g;f=i.length;g=3*a;var h=2*a;switch(a){case 1:g=
8;h=6;break;case 2:g=12;h=8;break;case 3:g=16,h=10}null!=b&&1<f&&(c=i[f-2].getEndPoint(),e=i[f-1],null!=e.trim&&(f=new primitives.common.Point(e.getEndPoint()),c=e.trim(c,h),g=d(c.x,c.y,f.x,f.y,g,h),b(g,c)))},addOffsetArrow:function(a,b,c,f,e){var g,h,k;g=i.length;k=3*b;var j=2*b,t;switch(b){case 1:k=8;j=6;break;case 2:k=12;j=8;break;case 3:k=16,j=10}null!=e&&1<g&&(b=i[g-2].getEndPoint(),h=i[g-1],null!=h.offsetPoint&&(g=new primitives.common.Point(h.getEndPoint()),t=b.distanceTo(g),t>f&&(c*=t,a?(a=
h.offsetPoint(b,g,c),k=d(b.x,b.y,a.x,a.y,k,j)):(a=h.offsetPoint(g,b,c),k=d(g.x,g.y,a.x,a.y,k,j)),e(k))))},optimizeMoveSegments:function(){var a,b,c,d,f;c={};var e=[],g=[];a=0;for(b=i.length;a<b-1;a+=1)switch(d=i[a],f=i[a+1],d.segmentType){case 0:case 2:case 3:switch(f.segmentType){case 1:case 4:d=d.x+"&"+d.y,c.hasOwnProperty(d)||(c[d]=a)}break;case 1:d=d.x+"&"+d.y,c.hasOwnProperty(d)&&!e[c[d]]&&(e[c[d]]=a+1,g[a]=!0)}f=[];for(a=0;a<b;a+=1)if(!g[a]&&(d=i[a],f.push(d),g[a]=!0,0<e[a]))for(c=e[a];c<b&&
!g[c];)d=i[c],f.push(d),g[c]=!0,c=0<e[c]?e[c]:c+1;i=f},getOffsetPolyine:function(a){var c=new primitives.common.Polyline(h),d={},k=[],i=[];b(this,function(b){var h=b.clone();switch(h.segmentType){case 4:case 1:0<i.length&&g(i,d,a,c);k.length=0;1==h.segmentType&&(b=new primitives.common.Point(h),b.context=new e(h,0),k.push(b));break;default:h.loop(this,function(b,g,j){b=new primitives.common.Point(b,g);b.context=new e(h,j);k.unshift(b);1<k.length&&(i.unshift(new primitives.common.Vector(k[1].clone(),
k[0].clone())),k.length=1);switch(i.length){case 1:j=i[0];b=j.from.toString();d[b]=j;j.offset(a);j.from.context.pushToSegment(j.from);break;case 2:b=i[1],j=i[0],f(b,j,a,c,!1),i.length=1}})}c.addSegment(h)});0<i.length&&g(i,d,a,c);return c},toString:function(){return h.toString()},getStartPoint:function(){var a=null;0<i.length&&(a=i[0].getEndPoint());return a},getEndPoint:function(){var a=null;0<i.length&&(a=i[i.length-1].getEndPoint());return a},clone:function(){var a,b,c=new primitives.common.Polyline(h),
d=[],f;a=0;for(b=i.length;a<b;a+=1)f=i[a],d.push(f.clone());c.addSegments(d);return c}}};
primitives.common.PolylinesBuffer=function(){function a(a,b){a[b.toString()]||(a[b.toString()]=new primitives.common.Polyline(b));return a[b.toString()]}function b(a,b){var f,g;if(null!=b)for(f in c)if(c.hasOwnProperty(f)&&(g=c[f]))if(g.optimizeMoveSegments(),b.call(a,g))break}var c={};return{getPolyline:function(b){return a(c,b)},loop:b,addInverted:function(d,e){var f,g;f=c;c={};null!=d&&d(this);b(this,function(b){g=a(f,b.paletteItem);e?b.mergeTo(g):g.addInverted(b)});c=f},transform:function(a,c){b(this,
function(b){b.transform(a,c)})}}};primitives.common.QuadraticArcSegment=function(a,b,c,d){this.cpY=this.cpX=this.y=this.x=null;switch(arguments.length){case 2:this.x=b.x;this.y=b.y;this.cpX=a.x;this.cpY=a.y;break;case 4:this.cpX=a,this.cpY=b,this.x=c,this.y=d}this.segmentType=2};primitives.common.QuadraticArcSegment.prototype.clone=function(){return new primitives.common.QuadraticArcSegment(this.cpX,this.cpY,this.x,this.y)};
primitives.common.QuadraticArcSegment.prototype.loop=function(a,b){null!=b&&(b.call(a,this.cpX,this.cpY,0),b.call(a,this.x,this.y,1))};primitives.common.QuadraticArcSegment.prototype.setPoint=function(a,b){switch(b){case 0:this.cpX=a.x;this.cpY=a.y;break;case 1:this.x=a.x,this.y=a.y}};primitives.common.QuadraticArcSegment.prototype.getEndPoint=function(){return this};primitives.common.QuadraticArcSegment.prototype.invert=function(a){this.x=a.x;this.y=a.y};
primitives.common.QuadraticArcSegment.prototype.transform=function(a,b){var c=this;a.transformPoints(c.x,c.y,c.cpX,c.cpY,b,c,function(a,b,f,g){c.x=a;c.y=b;c.cpX=f;c.cpY=g})};
primitives.common.QuadraticArcSegment.prototype.trim=function(a,b){var c=0.5,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c),e=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,0.1),c=b*(c/d.distanceTo(this.x,this.y)+0.1/e.distanceTo(this.x,this.y))/2,d=this.offsetPoint(this.x,this.y,this.cpX,this.cpY,a.x,a.y,c);this.x=d.x;this.y=d.y;return this};
primitives.common.QuadraticArcSegment.prototype.offsetPoint=function(a,b,c,d,e,f,g){return new primitives.common.Point((1-g)*(1-g)*a+2*(1-g)*g*c+g*g*e,(1-g)*(1-g)*b+2*(1-g)*g*d+g*g*f)};
primitives.common.Rect=function(a,b,c,d){this.height=this.width=this.y=this.x=null;switch(arguments.length){case 1:this.x=a.x;this.y=a.y;this.width=a.width;this.height=a.height;break;case 2:this.x=Math.min(a.x,b.x);this.y=Math.min(a.y,b.y);this.width=Math.abs(b.x-a.x);this.height=Math.abs(b.y-a.y);break;case 4:this.x=a,this.y=b,this.width=c,this.height=d}};primitives.common.Rect.prototype.left=function(){return this.x};primitives.common.Rect.prototype.top=function(){return this.y};
primitives.common.Rect.prototype.right=function(){return this.x+this.width};primitives.common.Rect.prototype.bottom=function(){return this.y+this.height};primitives.common.Rect.prototype.verticalCenter=function(){return this.y+this.height/2};primitives.common.Rect.prototype.horizontalCenter=function(){return this.x+this.width/2};primitives.common.Rect.prototype.centerPoint=function(){return new primitives.common.Point(this.horizontalCenter(),this.verticalCenter())};
primitives.common.Rect.prototype.isEmpty=function(){return null===this.x||null===this.y||null===this.width||null===this.height||0>this.width||0>this.height};
primitives.common.Rect.prototype.offset=function(a,b,c,d){switch(arguments.length){case 1:null!==a&&"object"==typeof a?(this.x-=a.left,this.y-=a.top,this.width=this.width+a.left+a.right,this.height=this.height+a.top+a.bottom):(this.x-=a,this.y-=a,this.width+=2*a,this.height+=2*a);break;case 4:this.x-=a,this.y-=b,this.width=this.width+a+c,this.height=this.height+b+d}return this};primitives.common.Rect.prototype.scale=function(a){this.x*=a;this.y*=a;this.width*=a;this.height*=a;return this};
primitives.common.Rect.prototype.translate=function(a,b){this.x+=a;this.y+=b;return this};primitives.common.Rect.prototype.invert=function(){var a=this.width,b=this.x;this.width=this.height;this.height=a;this.x=this.y;this.y=b;return this};
primitives.common.Rect.prototype.loopEdges=function(a){var b=[new primitives.common.Point(this.left(),this.top()),new primitives.common.Point(this.right(),this.top()),new primitives.common.Point(this.right(),this.bottom()),new primitives.common.Point(this.left(),this.bottom())],c=[1,3,5,7];b.push(b[0]);if(null!=a)for(var d=1,e=b.length;d<e&&!a(new primitives.common.Vector(b[d-1],b[d]),c[d-1]);d+=1);return this};
primitives.common.Rect.prototype.contains=function(a,b){switch(arguments.length){case 1:return this.x<=a.x&&a.x<=this.x+this.width&&this.y<=a.y&&a.y<=this.y+this.height;case 2:return this.x<=a&&a<=this.x+this.width&&this.y<=b&&b<=this.y+this.height;default:return!1}};
primitives.common.Rect.prototype.cropByRect=function(a){this.x<a.x&&(this.width-=a.x-this.x,this.x=a.x);this.right()>a.right()&&(this.width-=this.right()-a.right());this.y<a.y&&(this.height-=a.y-this.y,this.y=a.y);this.bottom()>a.bottom()&&(this.height-=this.bottom()-a.bottom());this.isEmpty()&&(this.height=this.width=this.y=this.x=null);return this};
primitives.common.Rect.prototype.overlaps=function(a){var b=!0;if(this.x+this.width<a.x||a.x+a.width<this.x||this.y+this.height<a.y||a.y+a.height<this.y)b=!1;return b};
primitives.common.Rect.prototype.addRect=function(a,b,c,d){var e,f;switch(arguments.length){case 1:a.isEmpty()||(this.isEmpty()?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):(e=Math.max(this.right(),a.right()),f=Math.max(this.bottom(),a.bottom()),this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.width=e-this.x,this.height=f-this.y));break;case 2:this.isEmpty()?(this.x=a,this.y=b,this.height=this.width=0):(e=Math.max(this.right(),a),f=Math.max(this.bottom(),b),this.x=Math.min(this.x,
a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y);break;case 4:this.isEmpty()?(this.x=a,this.y=b,this.width=c,this.height=d):(e=Math.max(this.right(),a+c),f=Math.max(this.bottom(),b+d),this.x=Math.min(this.x,a),this.y=Math.min(this.y,b),this.width=e-this.x,this.height=f-this.y)}return this};primitives.common.Rect.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};
primitives.common.Rect.prototype.toString=function(a){var b,a=void 0!==a?a:"px";b=""+("left:"+this.x+a+";");b+="top:"+this.y+a+";";b+="width:"+this.width+a+";";return b+="height:"+this.height+a+";"};primitives.common.Rect.prototype.validate=function(){if(isNaN(this.x)||isNaN(this.y)||isNaN(this.width)||isNaN(this.height))throw"Invalid rect position.";};
primitives.common.Size=function(a,b){this.height=this.width=0;switch(arguments.length){case 1:this.width=a.width;this.height=a.height;break;case 2:this.width=a,this.height=b}};primitives.common.Size.prototype.invert=function(){var a=this.width;this.width=this.height;this.height=a;return this};primitives.common.Size.prototype.scale=function(a){this.width*=a;this.height*=a;return this};
primitives.common.Size.prototype.getCSS=function(a){a=void 0!==a?a:"px";return{left:this.x+a,top:this.y+a,width:this.width+a,height:this.height+a}};primitives.common.Size.prototype.cropBySize=function(a){this.width=Math.min(this.width,a.width);this.height=Math.min(this.height,a.height);return this};primitives.common.Size.prototype.addSize=function(a){this.width=Math.max(this.width,a.width);this.height=Math.max(this.height,a.height);return this};
primitives.common.Size.prototype.validate=function(){if(isNaN(this.width)||isNaN(this.height))throw"Invalid size.";};primitives.common.Thickness=function(a,b,c,d){this.left=a;this.top=b;this.right=c;this.bottom=d};primitives.common.Thickness.prototype.isEmpty=function(){return 0===this.left&&0===this.top&&0===this.right&&0===this.bottom};primitives.common.Thickness.prototype.toString=function(a){a=void 0!==a?a:"px";return this.left+a+", "+this.top+a+", "+this.right+a+", "+this.bottom+a};
primitives.common.Vector=function(a,b){this.to=this.from=null;switch(arguments.length){case 1:this.from=a.from;this.to=a.to;break;case 2:this.from=a,this.to=b}};primitives.common.Vector.prototype.isNull=function(){return this.from.x==this.to&&this.from.y==this.to.y};primitives.common.Vector.prototype.length=function(){return this.from.distanceTo(this.to)};primitives.common.Vector.prototype.equalTo=function(a){return this.from.equalTo(a.from)&&this.to.equalTo(a.to)};
primitives.common.Vector.prototype.getMiddlePoint=function(){return new primitives.common.Point((this.from.x+this.to.x)/2,(this.from.y+this.to.y)/2)};primitives.common.Vector.prototype.relateTo=function(a){var b=0,c=this.to.x-this.from.x,d=this.to.y-this.from.y,e=a.to.x-a.from.x,a=a.to.y-a.from.y;switch((c?8:0)+(d?4:0)+(e?2:0)+(a?1:0)){case 0:case 1:case 2:case 3:case 4:case 8:case 12:b=1;break;case 5:b=0<d*a?2:3;break;case 10:b=0<c*e?2:3;break;case 15:c/e==d/a&&(b=0<c/e?2:3)}return b};
primitives.common.Vector.prototype.offset=function(a){var b=this.length(),c=(this.to.y-this.from.y)*a/b,a=-(this.to.x-this.from.x)*a/b;this.from.x+=c;this.from.y+=a;this.to.x+=c;this.to.y+=a};primitives.common.Vector.prototype.getLine=function(){var a=this.from.x,b=this.from.y,c=this.to.x,d=this.to.y;return[d-b,a-c,a*(b-d)+b*(c-a)]};
primitives.common.Vector.prototype.getLineKey=function(){var a=this.getLine(),b=a[0],c=a[1],a=a[2],a=0!==c?[Math.floor(1E4*(b/c)),1,Math.floor(1E4*(a/c))]:[1,0,Math.floor(1E4*(a/b))];return a.toString()};
primitives.common.Vector.prototype.intersect=function(a){var b=this.getLine(),c=a.getLine(),d=(new primitives.common.Matrix(b[0],b[1],c[0],c[1])).determinant(),e;e=!1;0!==d&&(e=new primitives.common.Matrix(-b[2],b[1],-c[2],c[1]),e=e.determinant(),b=new primitives.common.Matrix(b[0],-b[2],c[0],-c[2]),b=b.determinant(),c=e/d,d=b/d,a.to.x=c,a.to.y=d,this.from.x=c,this.from.y=d,e=!0);return e};
primitives.common.Vector.prototype.getIntersectionPoint=function(a,b,c){var d=this.getLine(),e=a.getLine(),f=(new primitives.common.Matrix(d[0],d[1],e[0],e[1])).determinant(),g,h=null;0!==f&&(g=new primitives.common.Matrix(-d[2],d[1],-e[2],e[1]),g=g.determinant(),d=new primitives.common.Matrix(d[0],-d[2],e[0],-e[2]),d=d.determinant(),g/=f,f=d/f,b?a._contains(g,f,c)&&this._contains(g,f,c)&&(h=new primitives.common.Point(g,f)):h=new primitives.common.Point(g,f));return h};
primitives.common.Vector.prototype._contains=function(a,b,c){var d=Math.min(this.from.x,this.to.x),e=Math.min(this.from.y,this.to.y),f=Math.max(this.from.x,this.to.x),g=Math.max(this.from.y,this.to.y);return d-c<=a&&a<=f+c&&e-c<=b&&b<=g+c};
primitives.common.Graphics=function(a){this.m_element=a;this.m_placeholders={};this.m_activePlaceholder=null;this.m_cache=new primitives.common.Cache;this.graphicsType=null;this.debug=this.hasGraphics=!1;this.layerNames={};primitives.common.loop(this,primitives.common.Layers,function(a,c){this.layerNames[c]=a})};
primitives.common.Graphics.prototype.clean=function(){var a,b,c,d;this.m_cache.clear();this.m_element=this.m_cache=null;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a)){b=this.m_placeholders[a];for(c in b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],d.canvas.remove(),d.canvas=null);b.layers.length=0;b.activeLayer=null;b.size=null;b.rect=null;b.div=null}this.m_placeholders.length=0;this.m_activePlaceholder=null};
primitives.common.Graphics.prototype.resize=function(a,b,c){a=this.m_placeholders[a];null!=a&&this.resizePlaceholder(a,b,c)};primitives.common.Graphics.prototype.resizePlaceholder=function(a,b,c){var d;a.size=new primitives.common.Size(b,c);a.rect=new primitives.common.Rect(0,0,b,c);for(d in a.layers)a.layers.hasOwnProperty(d)&&(b=a.layers[d],-1!==b.name&&b.canvas.css({position:"absolute",width:"0px",height:"0px"}))};primitives.common.Graphics.prototype.begin=function(){this.m_cache.begin()};
primitives.common.Graphics.prototype.end=function(){this.m_cache.end()};primitives.common.Graphics.prototype.reset=function(a,b){var c="none",d=-1;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.m_cache.reset(c,d)};
primitives.common.Graphics.prototype.activate=function(a,b){switch(arguments.length){case 1:"string"===typeof a?(this._activatePlaceholder(a),this._activateLayer(-1)):(this._activatePlaceholder("none"),this._activateLayer(a));break;case 2:this._activatePlaceholder(a),this._activateLayer(b)}return this.m_activePlaceholder};
primitives.common.Graphics.prototype._activatePlaceholder=function(a){var b=this.m_placeholders[a],c;void 0===b&&(c="none"===a?this.m_element:this.m_element.find("."+a),b=new primitives.common.Placeholder(a),b.div=c,b.size=new primitives.common.Size(c.innerWidth(),c.innerHeight()),b.rect=new primitives.common.Rect(0,0,b.size.width,b.size.height),this.m_placeholders[a]=b);this.m_activePlaceholder=b};
primitives.common.Graphics.prototype._activateLayer=function(a){var b=this.m_activePlaceholder.layers[a],c,d,e,f;if(void 0===b){c=this.m_activePlaceholder;if(-1===a)b=new primitives.common.Layer(a),b.canvas=c.div;else{d=jQuery("<div></div>");d.addClass("Layer"+a);d.addClass("Layer"+this.layerNames[a]);new primitives.common.Rect(c.rect);d.css({position:"absolute",width:"0px",height:"0px"});e=null;for(f in c.layers)c.layers.hasOwnProperty(f)&&(b=c.layers[f],b.name<a&&(e=null!==e?Math.max(e,b.name):
b.name));b=new primitives.common.Layer(a);b.canvas=d;null===e?c.div.prepend(b.canvas[0]):b.canvas.insertAfter(c.layers[e].canvas)}c.layers[a]=b}this.m_activePlaceholder.activeLayer=b};
primitives.common.Graphics.prototype.text=function(a,b,c,d,e,f,g,h,i){var j=this.m_activePlaceholder,g={position:"absolute",padding:0,margin:0,"text-align":this._getTextAlign(g),"font-size":i["font-size"],"font-family":i["font-family"],"font-weight":i["font-weight"],"font-style":i["font-style"],color:i["font-color"],"line-height":1},i="";switch(f){case 0:case 3:g.left=a;g.top=b;g.width=c;g.height=d;break;case 1:g.left=a+Math.round(c/2-d/2);g.top=b+Math.round(d/2-c/2);g.width=d;g.height=c;i="rotate(-90deg)";
break;case 2:g.left=a+Math.round(c/2-d/2),g.top=b+Math.round(d/2-c/2),g.width=d,g.height=c,i="rotate(90deg)"}g["-webkit-transform-origin"]="center center";g["-moz-transform-origin"]="center center";g["-o-transform-origin"]="center center";g["-ms-transform-origin"]="center center";g["-webkit-transform"]=i;g["-moz-transform"]=i;g["-o-transform"]=i;g["-ms-transform"]=i;g.transform=i;g["max-width"]=g.width;g["max-height"]=g.height;e=e.replace(RegExp("\n","g"),"<br/>");switch(h){case 0:this.debug&&(g.border=
"solid 1px black");a=this.m_cache.get(j.name,j.activeLayer.name,"text");null===a?(a=jQuery("<div></div>"),a.css(g),a.html(e),j.activeLayer.canvas.append(a),this.m_cache.put(j.name,j.activeLayer.name,"text",a)):(a.css(g),a.html(e));break;default:g["border-collapse"]="collapse",b={"vertical-align":this._getVerticalAlignment(h),padding:0},this.debug&&(b.border="solid 1px black"),a=this.m_cache.get(j.name,j.activeLayer.name,"textintable"),null===a?(a=jQuery("<table><tbody><tr><td></td></tr></tbody></table>"),
primitives.common.css(a,g),a.find("td").css(b).html(e),j.activeLayer.canvas.append(a),this.m_cache.put(j.name,j.activeLayer.name,"textintable",a)):(primitives.common.css(a,g),a.find("td").css(b).html(e))}};primitives.common.Graphics.prototype._getTextAlign=function(a){var b=null;switch(a){case 0:b="center";break;case 1:b="left";break;case 2:b="right"}return b};
primitives.common.Graphics.prototype._getVerticalAlignment=function(a){var b=null;switch(a){case 1:b="middle";break;case 0:b="top";break;case 2:b="bottom"}return b};primitives.common.Graphics.prototype.polylinesBuffer=function(a){a.loop(this,function(a){0<a.length()&&this.polyline(a)})};
primitives.common.Graphics.prototype.polyline=function(a){var b=null,c=null,d=a.paletteItem.toAttr();a.loop(this,function(a){switch(a.segmentType){case 1:b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 0:this.rightAngleLine(b,c,Math.round(a.x)+0.5,Math.round(a.y)+0.5,d);b=Math.round(a.x)+0.5;c=Math.round(a.y)+0.5;break;case 4:this.dot(a.x,a.y,a.width,a.height,a.cornerRadius,d)}})};
primitives.common.Graphics.prototype.dot=function(a,b,c,d,e,f){var g=this.m_activePlaceholder,h=this.m_cache.get(g.name,g.activeLayer.name,"dot"),i=void 0!==f.lineWidth&&void 0!==f.borderColor,a={position:"absolute",width:c-(i?1:0),top:Math.round(b),left:Math.round(a),padding:0,margin:0,"line-height":"0px",overflow:"hidden",height:d-(i?1:0),background:f.fillColor,"-moz-border-radius":e,"-webkit-border-radius":e,"-khtml-border-radius":e,"border-radius":e,"font-size":"0px","border-style":i?"Solid":
"None","border-width":i?"1px":"0px","border-color":i?f.borderColor:""};null===h?(h=jQuery("<div></div>"),primitives.common.css(h,a),g.activeLayer.canvas.append(h),this.m_cache.put(g.name,g.activeLayer.name,"dot",h)):primitives.common.css(h,a)};
primitives.common.Graphics.prototype.rightAngleLine=function(a,b,c,d,e){var f=this.m_activePlaceholder,g=Math.abs(d-b)>Math.abs(c-a),h=e.lineWidth,e={position:"absolute",top:Math.round(Math.min(b,d)-(g?0:h/2)),left:Math.round(Math.min(a,c)-(g?h/2:0)),padding:0,margin:0,opacity:0.5,"line-height":"0px",overflow:"hidden",background:e.borderColor,"font-size":"0px"};g?(e.width=h,e.height=Math.abs(Math.round(d-b))):(e.width=Math.abs(Math.round(c-a)),e.height=h);a=this.m_cache.get(f.name,f.activeLayer.name,
"rect");null===a?(a=jQuery("<div></div>"),primitives.common.css(a,e),f.activeLayer.canvas.append(a),this.m_cache.put(f.name,f.activeLayer.name,"rect",a)):primitives.common.css(a,e)};
primitives.common.Graphics.prototype.template=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var c=this.m_activePlaceholder,d="template"+(null!==j?j:primitives.common.hashCode(i)),n=0,j=this.m_cache.get(c.name,c.activeLayer.name,d);null!==m&&void 0!==m["border-width"]&&(n=this.getPxSize(m["border-width"]));a={width:g-n+"px",height:h-n+"px",top:b+f+"px",left:a+e+"px"};jQuery.extend(a,m);null==l&&(l=new primitives.common.RenderEventArgs);null==j?(j=jQuery(i),jQuery.extend(a,{position:"absolute",padding:"0px",
margin:"0px"},m),primitives.common.css(j,a),l.element=j,l.renderingMode=0,null!==k&&k(null,l),c.activeLayer.canvas.append(j),this.m_cache.put(c.name,c.activeLayer.name,d,j)):(l.element=j,l.renderingMode=1,primitives.common.css(j,a),null!==k&&k(null,l));return j};primitives.common.Graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};
primitives.common.Cache=function(){this.threshold=20;this.m_visible={};this.m_invisible={}};primitives.common.Cache.prototype.begin=function(){var a,b,c,d;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(c=this.m_visible[a][b].length-1;0<=c;c-=1)d=this.m_visible[a][b][c],d.css({visibility:"hidden"}),this.m_invisible[a][b].push(d);this.m_visible[a][b].length=0}};
primitives.common.Cache.prototype.end=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)&&this.m_invisible[a][b].length>this.threshold)for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()};
primitives.common.Cache.prototype.reset=function(a,b){var a=a+"-"+b,c=null,d,e;for(d in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(d)){for(e=this.m_visible[a][d].length-1;0<=e;e-=1)c=this.m_visible[a][d][e],this.m_invisible[a][d].push(c),c.css({visibility:"hidden"});this.m_visible[a][d].length=0}};
primitives.common.Cache.prototype.clear=function(){var a,b,c;for(a in this.m_visible)if(this.m_visible.hasOwnProperty(a))for(b in this.m_visible[a])if(this.m_visible[a].hasOwnProperty(b)){for(;void 0!==(c=this.m_visible[a][b].pop());)c.remove();for(;void 0!==(c=this.m_invisible[a][b].pop());)c.remove()}};
primitives.common.Cache.prototype.get=function(a,b,c){a=a+"-"+b;b=null;void 0===this.m_visible[a]&&(this.m_visible[a]={},this.m_invisible[a]={});void 0===this.m_visible[a][c]&&(this.m_visible[a][c]=[],this.m_invisible[a][c]=[]);b=this.m_invisible[a][c].pop()||null;null!==b&&(this.m_visible[a][c].push(b),b.css({visibility:"inherit"}));return b};primitives.common.Cache.prototype.put=function(a,b,c,d){this.m_visible[a+"-"+b][c].push(d)};
primitives.common.CanvasGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.graphicsType=1;this.m_maximum=8E3};primitives.common.CanvasGraphics.prototype=new primitives.common.Graphics;
primitives.common.CanvasGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&(d.canvascanvas.remove(),d.canvascanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.CanvasGraphics.prototype._activatePlaceholder=function(a){var b,c,d;this.parent._activatePlaceholder.apply(this,arguments);b=this.m_activePlaceholder;c=b.size.width;d=b.size.height;b.hasGraphics=c>this.m_maximum||d>this.m_maximum?!1:!0};
primitives.common.CanvasGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.canvascanvas&&(e.canvascanvas.css({position:"absolute",width:b+"px",height:c+"px"}),e.canvascanvas.attr({width:b+"px",height:c+"px"})))};
primitives.common.CanvasGraphics.prototype.begin=function(){var a,b,c,d,e,f;this.parent.begin.apply(this);for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],e=b.size.width,f=b.size.height,b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,e,f))};
primitives.common.Graphics.prototype._getContext=function(a,b){var c=a.size.width,d=a.size.height;null===b.canvascanvas&&(b.canvascanvas=jQuery("<canvas></canvas>"),b.canvascanvas.attr({width:c+"px",height:d+"px"}),a.activeLayer.canvas.prepend(b.canvascanvas),b.canvascontext=b.canvascanvas[0].getContext("2d"));return b.canvascontext};
primitives.common.CanvasGraphics.prototype.reset=function(a,b){var c="none",d=-1,e,f;switch(arguments.length){case 1:"string"===typeof a?c=a:d=a;break;case 2:c=a,d=b}this.parent.reset.apply(this,arguments);e=this.m_placeholders[c];void 0!==e&&(c=e.size.width,f=e.size.height,d=e.layers[d],void 0!==d&&null!==d.canvascanvas&&d.canvascontext.clearRect(0,0,c,f))};
primitives.common.CanvasGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,e=a.paletteItem.toAttr(),f,g;if(b.hasGraphics){c=b.activeLayer;d=this._getContext(b,c);d.save();void 0!==e.lineWidth&&void 0!==e.borderColor?(d.strokeStyle=e.borderColor,d.lineWidth=e.lineWidth):(d.lineWidth=0,d.strokeStyle="Transparent");if(null!=e.lineType){b=Math.round(e.lineWidth)||1;switch(e.lineType){case 0:f=[];break;case 1:f=[b,b];break;case 2:f=[5*b,3*b]}void 0!==d.setLineDash?d.setLineDash(f):
void 0!==d.webkitLineDash?d.webkitLineDash=f:void 0!==d.mozDash&&(d.mozDash=f)}d.beginPath();a.loop(this,function(a){switch(a.segmentType){case 1:d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 0:d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(d.moveTo(Math.round(a.x)+a.width+0.5,Math.round(a.y)+a.height/2+0.5),d.arc(Math.round(a.x)+a.width/2+0.5,Math.round(a.y)+a.height/2+0.5,Math.round(a.width/2),0,2*Math.PI,!1)):0===a.cornerRadius?
(d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5)):(g=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d.moveTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),Math.PI,-Math.PI/2,!1),d.lineTo(Math.round(a.x+
a.width-g)+0.5,Math.round(a.y)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+g)+0.5,Math.round(g),-Math.PI/2,0,!1),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height-g)+0.5),d.arc(Math.round(a.x+a.width-g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),0,Math.PI/2,!1),d.lineTo(Math.round(a.x+g)+0.5,Math.round(a.y+a.height)+0.5),d.arc(Math.round(a.x+g)+0.5,Math.round(a.y+a.height-g)+0.5,Math.round(g),Math.PI/2,Math.PI,!1),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+g)+0.5));break;
case 2:d.quadraticCurveTo(Math.round(a.cpX)+0.5,Math.round(a.cpY)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 3:d.bezierCurveTo(Math.round(a.cpX1)+0.5,Math.round(a.cpY1)+0.5,Math.round(a.cpX2)+0.5,Math.round(a.cpY2)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5)}});null!=e.opacity&&(d.globalAlpha=e.opacity);void 0!==e.lineWidth&&d.stroke();void 0!==e.fillColor&&(d.fillStyle=e.fillColor,d.fill());d.restore()}else this.parent.polyline.apply(this,arguments)};
primitives.common.Element=function(a,b){this.name=this.ns=null;this.attr={};this.style={};this.children=[];switch(arguments.length){case 1:this.name=a;break;case 2:this.ns=a,this.name=b}};primitives.common.Element.prototype.setAttribute=function(a,b){this.attr[a]=b};primitives.common.Element.prototype.appendChild=function(a){this.children[this.children.length]=a};
primitives.common.Element.prototype.create=function(a){var b=null,c,d,b=null!==this.ns?document.createElementNS(this.ns,this.name):document.createElement(this.name);for(c in this.attr)this.attr.hasOwnProperty(c)&&(void 0!==a?b[c]=this.attr[c]:b.setAttribute(c,this.attr[c]));for(c in this.style)this.style.hasOwnProperty(c)&&(b.style[c]=this.style[c]);for(d=0;d<this.children.length;d+=1)c=this.children[d],"string"===typeof c?b.appendChild(document.createTextNode(c)):b.appendChild(c.create(a));return b};
primitives.common.Element.prototype.update=function(a,b){var c,d,e;for(c in this.style)this.style.hasOwnProperty(c)&&(d=this.style[c],a.style[c]!==d&&(a.style[c]=d));for(c in this.attr)this.attr.hasOwnProperty(c)&&(d=this.attr[c],void 0!==b?a[c]!==d&&(a[c]=d):a.getAttribute(c)!==d&&a.setAttribute(c,d));c=this.children.length;for(d=0;d<c;d+=1)e=this.children[d],"string"===typeof e?a.innerHtml!==e&&(a.innerHtml=e):this.children[d].update(a.children[d],b)};
primitives.common.Layer=function(a){this.name=a;this.svgcanvas=this.canvascanvas=this.canvas=null};primitives.common.Placeholder=function(a){this.name=a;this.layers={};this.div=this.rect=this.size=this.activeLayer=null;this.hasGraphics=!0};primitives.common.SvgGraphics=function(a){this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this._svgxmlns="http://www.w3.org/2000/svg";this.graphicsType=0;this.hasGraphics=!0};
primitives.common.SvgGraphics.prototype=new primitives.common.Graphics;primitives.common.SvgGraphics.prototype.clean=function(){var a,b,c,d;for(a in this.m_placeholders)if(this.m_placeholders.hasOwnProperty(a))for(c in b=this.m_placeholders[a],b.layers)b.layers.hasOwnProperty(c)&&(d=b.layers[c],null!==d.svgcanvas&&(d.svgcanvas.remove(),d.svgcanvas=null));this.parent.clean.apply(this,arguments)};
primitives.common.SvgGraphics.prototype.resizePlaceholder=function(a,b,c){var d,e,f;this.parent.resizePlaceholder.apply(this,arguments);for(d in a.layers)a.layers.hasOwnProperty(d)&&(e=a.layers[d],null!==e.svgcanvas&&(f={position:"absolute",width:b+"px",height:c+"px"},e.svgcanvas.css(f),e.svgcanvas.attr({viewBox:"0 0 "+b+" "+c})))};
primitives.common.SvgGraphics.prototype._getCanvas=function(){var a=this.m_activePlaceholder,b=a.activeLayer,c=a.rect;null===b.svgcanvas&&(b.svgcanvas=jQuery('<svg version = "1.1"></svg>'),b.svgcanvas.attr({viewBox:c.x+" "+c.y+" "+c.width+" "+c.height}),b.svgcanvas.css({width:c.width+"px",height:c.height+"px"}),a.activeLayer.canvas.prepend(b.svgcanvas));return b.svgcanvas};
primitives.common.SvgGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c,d,e=a.paletteItem.toAttr(),f,g,h;c=new primitives.common.Element(this._svgxmlns,"path");void 0!==e.fillColor?(c.setAttribute("fill",e.fillColor),c.setAttribute("fill-opacity",e.opacity)):c.setAttribute("fill-opacity",0);void 0!==e.lineWidth&&void 0!==e.borderColor?(c.setAttribute("stroke",e.borderColor),c.setAttribute("stroke-width",e.lineWidth),void 0!==e.opacity?c.setAttribute("stroke-opacity",e.opacity):
c.setAttribute("stroke-opacity",1)):(c.setAttribute("stroke","transparent"),c.setAttribute("stroke-width",0));if(null!=e.lineType)switch(f=Math.round(e.lineWidth)||1,e.lineType){case 0:c.setAttribute("stroke-dasharray","");break;case 1:c.setAttribute("stroke-dasharray",f+","+f);break;case 2:c.setAttribute("stroke-dasharray",5*f+","+3*f)}d="";a.loop(this,function(a){switch(a.segmentType){case 1:d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 0:d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+
0.5);break;case 2:d+="Q"+(Math.round(a.cpX)+0.5)+" "+(Math.round(a.cpY)+0.5)+" "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?(g=a.width/2,d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5),d+="A"+g+" "+g+" 0 0 0 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+a.height/2+0.5)):0===a.cornerRadius?(d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+
0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)):(h=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d+="M"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y)+0.5),d+="L"+(Math.round(a.x+a.width-
h)+0.5)+" "+(Math.round(a.y)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+h)+0.5),d+="L"+(Math.round(a.x+a.width)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x+a.width-h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="L"+(Math.round(a.x+h)+0.5)+" "+(Math.round(a.y+a.height)+0.5),d+="A"+Math.round(h)+" "+Math.round(h)+" 0 0 1 "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+a.height-h)+0.5),
d+="L"+(Math.round(a.x)+0.5)+" "+(Math.round(a.y+h)+0.5));break;case 3:d+="C"+(Math.round(a.cpX1)+0.5)+" "+(Math.round(a.cpY1)+0.5)+" "+(Math.round(a.cpX2)+0.5)+" "+(Math.round(a.cpY2)+0.5)+" "+(Math.round(a.x)+0.5)+" "+(Math.round(a.y)+0.5)}});c.setAttribute("d",d);a=this.m_cache.get(b.name,b.activeLayer.name,"path");null===a?(a=jQuery(c.create()),c=this._getCanvas(),c.append(a),this.m_cache.put(b.name,b.activeLayer.name,"path",a)):c.update(a[0])};
primitives.common.Transform=function(){this.invertVertically=this.invertHorizontally=this.invertArea=!1;this.size=null};
primitives.common.Transform.prototype.setOrientation=function(a){switch(a){case 0:this.invertVertically=this.invertHorizontally=this.invertArea=!1;break;case 1:this.invertHorizontally=this.invertArea=!1;this.invertVertically=!0;break;case 2:this.invertArea=!0;this.invertVertically=this.invertHorizontally=!1;break;case 3:this.invertHorizontally=this.invertArea=!0,this.invertVertically=!1}};
primitives.common.Transform.prototype.getOrientation=function(a){var b=a;if(this.invertHorizontally)switch(a){case 2:b=3;break;case 3:b=2}if(this.invertVertically)switch(a){case 0:b=1;break;case 1:b=0}if(this.invertArea)switch(b){case 0:b=2;break;case 1:b=3;break;case 2:b=0;break;case 3:b=1}return b};
primitives.common.Transform.prototype.transformPoint=function(a,b,c,d,e){var f;c&&this.invertArea&&(f=a,a=b,b=f);this.invertHorizontally&&(a=this.size.width-a);this.invertVertically&&(b=this.size.height-b);!c&&this.invertArea&&(f=a,a=b,b=f);e.call(d,a,b)};
primitives.common.Transform.prototype.transformPoints=function(a,b,c,d,e,f,g){var h;e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d);!e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(f,a,b,c,d)};
primitives.common.Transform.prototype.transform3Points=function(a,b,c,d,e,f,g,h,i){var j;g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=e,e=f,f=j);this.invertHorizontally&&(a=this.size.width-a,c=this.size.width-c,e=this.size.width-e);this.invertVertically&&(b=this.size.height-b,d=this.size.height-d,f=this.size.height-f);!g&&this.invertArea&&(j=a,a=b,b=j,j=c,c=d,d=j,j=e,e=f,f=j);i.call(h,a,b,c,d,e,f)};
primitives.common.Transform.prototype.transformRect=function(a,b,c,d,e,f,g){var h;e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);this.invertHorizontally&&(a=this.size.width-a-c);this.invertVertically&&(b=this.size.height-b-d);!e&&this.invertArea&&(h=a,a=b,b=h,h=c,c=d,d=h);g.call(f,a,b,c,d)};
primitives.common.VmlGraphics=function(a){var b,c,d;this.parent=primitives.common.Graphics.prototype;this.parent.constructor.apply(this,arguments);this.prefix="rvml";this.ie8mode=document.documentMode&&8<=document.documentMode;try{eval("document.namespaces")}catch(e){}document.namespaces[this.prefix]||document.namespaces.add(this.prefix,"urn:schemas-microsoft-com:vml");if(!primitives.common.VmlGraphics.prototype.vmlStyle){b=primitives.common.VmlGraphics.prototype.vmlStyle=document.createStyleSheet();
c=" *;fill;shape;path;textpath;stroke".split(";");for(d=0;d<c.length;d+=1)b.addRule(this.prefix+"\\:"+c[d],"behavior:url(#default#VML); position:absolute;")}this.graphicsType=2;this.hasGraphics=!0};primitives.common.VmlGraphics.prototype=new primitives.common.Graphics;
primitives.common.VmlGraphics.prototype.text=function(a,b,c,d,e,f,g,h,i){var j,k,l;switch(f){case 0:case 3:this.parent.text.call(this,a,b,c,d,e,f,g,h,i);break;default:j=this.m_activePlaceholder;f=1===f;a=new primitives.common.Rect(a,b,c,d);d=new primitives.common.Rect(0,0,10*c,10*d);c=new primitives.common.Element(this.prefix+":shape");c.setAttribute("CoordSize",d.width+","+d.height);c.setAttribute("filled",!0);c.setAttribute("stroked",!1);c.setAttribute("fillcolor",i["font-color"]);c.style.top=a.y+
"px";c.style.left=a.x+"px";c.style.width=a.width+"px";c.style.height=a.height+"px";c.style["font-family"]=i["font-family"];a=new primitives.common.Element(this.prefix+":path");a.setAttribute("TextPathOk",!0);b=16*Math.floor(this.getPxSize(i["font-size"]))*Math.max(e.split("\n").length-1,1);l=k=null;if(f)switch(h){case 0:k=new primitives.common.Point(d.x+b/2,d.bottom());l=new primitives.common.Point(d.x+b/2,d.y);break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.bottom());l=new primitives.common.Point(d.horizontalCenter(),
d.y);break;case 2:k=new primitives.common.Point(d.right()-b/2,d.bottom()),l=new primitives.common.Point(d.right()-b/2,d.y)}else switch(h){case 0:k=new primitives.common.Point(d.right()-b/2,d.y);l=new primitives.common.Point(d.right()-b/2,d.bottom());break;case 1:k=new primitives.common.Point(d.horizontalCenter(),d.y);l=new primitives.common.Point(d.horizontalCenter(),d.bottom());break;case 2:k=new primitives.common.Point(d.x+b/2,d.y),l=new primitives.common.Point(d.x+b/2,d.bottom())}a.setAttribute("v",
" m"+k.x+","+k.y+" l"+l.x+","+l.y+" e");h=new primitives.common.Element(this.prefix+":textpath");h.setAttribute("on",!0);h.setAttribute("string",e);h.style.trim=!1;h.style["v-text-align"]=this._getTextAlign(g);h.style.font="normal normal normal "+i["font-size"]+"pt "+i["font-family"];c.appendChild(a);c.appendChild(h);e=this.m_cache.get(j.name,j.activeLayer.name,"vmltext");null===e?(e=jQuery(c.create(this.ie8mode)),j.activeLayer.canvas.append(e),this.m_cache.put(j.name,j.activeLayer.name,"vmltext",
e)):c.update(e[0],this.ie8mode)}};
primitives.common.VmlGraphics.prototype.polyline=function(a){var b=this.m_activePlaceholder,c=new primitives.common.Rect(b.rect),d=new primitives.common.Rect(0,0,10*c.width,10*c.height),e=new primitives.common.Element(this.prefix+":shape"),f,g,h,i,j,k,l;g=a.paletteItem.toAttr();void 0!==g.borderColor&&void 0!==g.lineWidth?(e.setAttribute("strokecolor",g.borderColor),e.setAttribute("strokeweight",g.lineWidth),e.setAttribute("stroked",!0)):e.setAttribute("stroked",!1);e.setAttribute("CoordSize",d.width+
","+d.height);e.style.top=c.y+"px";e.style.left=c.x+"px";e.style.width=c.width+"px";e.style.height=c.height+"px";f="";a.loop(this,function(a){switch(a.segmentType){case 1:f+=" m"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 0:f+=" l"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 4:h=Math.round(a.x);i=Math.round(a.y);j=Math.round(a.x+a.width);k=Math.round(a.y+a.height);h>j&&(l=h,h=j,j=l);i>k&&(l=i,i=k,k=l);h=10*h+5;i=10*i+5;j=10*j-5;k=10*k-5;f+=" m"+h+","+i;f+=" l"+j+","+i;f+=" l"+j+
","+k;f+=" l"+h+","+k;f+=" l"+h+","+i;break;case 2:f+=" qb"+10*Math.round(a.cpX)+","+10*Math.round(a.cpY)+" l"+10*Math.round(a.x)+","+10*Math.round(a.y);break;case 3:f+=" c"+10*Math.round(a.cpX1)+","+10*Math.round(a.cpY1)+","+10*Math.round(a.cpX2)+","+10*Math.round(a.cpY2)+","+10*Math.round(a.x)+","+10*Math.round(a.y)}});f+=" e";a="shapepath";c=new primitives.common.Element(this.prefix+":path");c.setAttribute("v",f);e.appendChild(c);if(null!=g.lineType){c=new primitives.common.Element(this.prefix+
":stroke");switch(g.lineType){case 0:c.setAttribute("dashstyle","Solid");break;case 1:c.setAttribute("dashstyle","ShortDot");break;case 2:c.setAttribute("dashstyle","Dash")}e.appendChild(c);a+="stroke"}null!==g.fillColor?(e.setAttribute("filled",!0),c=new primitives.common.Element(this.prefix+":fill"),c.setAttribute("opacity",g.opacity),c.setAttribute("color",g.fillColor),e.appendChild(c),a+="fill"):e.setAttribute("filled",!1);g=this.m_cache.get(b.name,b.activeLayer.name,a);null===g?(g=jQuery(e.create(this.ie8mode)),
b.activeLayer.canvas.append(g),this.m_cache.put(b.name,b.activeLayer.name,a,g)):e.update(g[0],this.ie8mode)};primitives.common.ArrayReader=function(a,b,c,d){this.itemTemplate=a;this.containsUniqueItems=b;this.uniquePropertyKey=c;this.containsPrimitiveValues=primitives.common.isNullOrEmpty(c);this.createSourceHash=d};
primitives.common.ArrayReader.prototype.read=function(a,b,c,d){var e=[],f={},g={},h={},i,j,k,l,m,n;if(!b||!primitives.common.isArray(b))b=[];i=d.hash[c]||{};l=0;for(m=b.length;l<m;l+=1)j=b[l],k=this.containsUniqueItems?this.containsPrimitiveValues?j:j[this.uniquePropertyKey]:l,h.hasOwnProperty(k)||(h[k]=!0,n=i[k]||{},n=this.itemTemplate.read(n,j,c+"-"+l,d),e.push(n),f[k]=n,this.createSourceHash&&(g[k]=j));d.hash[c]=f;this.createSourceHash&&(d.sourceHash[c]=g);if(null==a||a.length!=e.length)d.isChanged=
!0;return e};primitives.common.EnumerationReader=function(a,b,c){this.enumeration=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(var d in a)this.hash[a[d]]=d};primitives.common.EnumerationReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};primitives.common.FunctionReader=function(){};
primitives.common.FunctionReader.prototype.read=function(a,b){return"function"==typeof b?b:null};primitives.common.ObjectReader=function(a,b,c){this.dataTemplate=a;this.isNullable=b;this.defaultValue=c};
primitives.common.ObjectReader.prototype.read=function(a,b,c,d){var e=null,f,g;b||(b=this.isNullable?null:this.defaultValue);if(primitives.common.isObject(b))for(f in e={},this.dataTemplate)this.dataTemplate.hasOwnProperty(f)&&(g=this.dataTemplate[f],e[f]=g.read(primitives.common.isObject(a)?a[f]:null,b[f],c+"-"+f,d));else e=b,a!==b&&(d.isChanged=!0);return e};
primitives.common.ValueReader=function(a,b,c){this.acceptedTypes=a;this.isNullable=b;this.defaultValue=c;this.hash={};for(b=0;b<a.length;b+=1)this.hash[a[b]]=!0};primitives.common.ValueReader.prototype.read=function(a,b,c,d){if(null===b||"undefined"==typeof b||!this.hash.hasOwnProperty(typeof b))b=this.isNullable?null:this.defaultValue;a!==b&&(d.isChanged=!0);return b};
primitives.famdiagram.EventArgs=function(){this.context=this.oldContext=null;this.parentItems=[];this.childrenItems=[];this.name=this.position=null;this.cancel=!1};
primitives.famdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.famdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.zOrderType=0;this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.famdiagram.Config=function(a){this.name=void 0!==a?a:"FamDiagram";this.classPrefix="famdiagram";this.graphicsType=this.navigationMode=0;this.actualGraphicsType=null;this.pageFitMode=3;this.minimalVisibility=2;this.orientationType=0;this.verticalAlignment=1;this.arrowsDirection=0;this.showExtraArrows=!0;this.extraArrowsMinimumSpace=30;this.groupByType=2;this.alignBylevels=!0;this.elbowType=3;this.elbowDotSize=this.bevelSize=4;this.emptyDiagramMessage="Diagram is empty.";this.items=[];this.annotations=
[];this.highlightItem=this.cursorItem=null;this.highlightGravityRadius=40;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.neighboursSelectionMode=this.selectionPathMode=0;this.templates=[];this.defaultLabelAnnotationTemplate=this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=
this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=1;this.linesType=0;this.showNeigboursConnectorsHighlighted=!1;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=
1;this.highlightLinesType=0;this.linesPalette=[];this.showCallout=!0;this.calloutPlacementOffset=100;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.buttonsPanelSize=28;this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=1;this.showLabels=0;this.labelSize=
new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight="normal";this.enablePanning=!0;this.printPreviewPageSize=new primitives.common.Size(612,792);this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.famdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorPlacementType=this.connectorShapeType=0;this.labelPlacementType=1;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=
a,this.toItem=b}};primitives.famdiagram.HighlightPathAnnotationConfig=function(a){var b;this.zOrderType=this.annotationType=2;this.items=[];this.lineWidth=2;this.color="#ff0000";this.lineType=0;this.opacity=1;this.showArrows=!0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.famdiagram.ItemConfig=function(a,b,c,d,e){var f;this.id=null;this.parents=[];this.spouses=[];this.context=this.image=this.description=this.title=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=!0;this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(f in a)a.hasOwnProperty(f)&&
(this[f]=a[f]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=e}};primitives.famdiagram.LabelAnnotationConfig=function(a,b){var c;this.annotationType=3;this.fromItem=null;this.toItems=[];this.title=null;this.itemTitleColor="#4169e1";this.templateName=null;switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=a,this.toItem=b}};
primitives.famdiagram.PaletteItemConfig=function(a,b,c){var d;this.lineColor="#c0c0c0";this.lineWidth=1;this.lineType=0;switch(arguments.length){case 1:for(d in a)a.hasOwnProperty(d)&&(this[d]=a[d]);break;case 3:this.lineColor=a,this.lineWidth=b,this.lineType=c}};
primitives.famdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.CrossingsItem=function(){this.childid=null;this.edges=[]};primitives.famdiagram.EdgeItem=function(a,b,c,d){this.values=[b,d];this[a]=0;this[c]=1};primitives.famdiagram.EdgeItem.prototype.getNear=function(a){return this.values[this[a]]};primitives.famdiagram.EdgeItem.prototype.getFar=function(a){return this.values[Math.abs(this[a]-1)]};
primitives.famdiagram.EdgeItem.prototype.setNear=function(a,b){this.values[this[a]]=b};primitives.famdiagram.EdgeItem.prototype.setFar=function(a,b){this.values[Math.abs(this[a]-1)]=b};primitives.famdiagram.EdgeItem.prototype.toString=function(){return this.parent+","+this.child};primitives.famdiagram.ExtraGravity=function(a){this.toParent=this.fromParent=this.commonParent=null;this.level=a};
primitives.famdiagram.Family=function(a){this.id=null;this.familyPriority=1;this.childFamilies=[];this.items=[];this.links=[];this.backLinks=[];1==arguments.length&&(this.id=a)};primitives.famdiagram.FamilyEdge=function(a,b){this.parentid=a;this.childid=b;this.key=a+","+b};
primitives.famdiagram.FamilyItem=function(a){var b;this.itemConfig=this.familyId=this.id=null;this.isActive=this.isVisible=!0;this.isLevelNeutral=!1;this.level=null;this.levelGravity=0;this.hideChildrenConnection=this.hideParentConnection=!1;switch(arguments.length){case 1:for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.famdiagram.FamLink=function(a,b){this.fromItem=a;this.toItem=b};
primitives.famdiagram.Slot=function(a){this.position=this.next=this.prev=this.id=null;this.balance=0;this.itemId=a;this.left={};this.right={};this.crossings={}};
primitives.famdiagram.Slot.prototype.clone=function(){var a=new primitives.famdiagram.Slot,b;a.itemId=this.itemId;for(b in this.left)this.left.hasOwnProperty(b)&&(a.left[b]=this.left[b]);for(b in this.right)this.right.hasOwnProperty(b)&&(a.right[b]=this.right[b]);for(b in this.crossings)this.crossings.hasOwnProperty(b)&&(a.crossings[b]=this.crossings[b]);return a};primitives.famdiagram.Slots=function(){this.last=this.first=null;this.slots={};this.items={};this.counter=0};
primitives.famdiagram.Slots.prototype.add=function(a){a.id=this.counter;this.counter+=1;this.slots[a.id]=a;null!=a.itemId&&(this.items[a.itemId]=a);null==this.last?this.first=this.last=a.id:(this.slots[this.last].next=a.id,a.prev=this.last,this.last=a.id)};
primitives.famdiagram.Slots.prototype.insertBefore=function(a,b){b.id=this.counter;this.counter+=1;this.slots[b.id]=b;null!=b.itemId&&(this.items[b.itemId]=b);if(null==a.prev)b.next=a.id,this.first=b.id;else{var c=this.slots[a.prev];c.next=b.id;b.next=a.id;a.prev=b.id;b.prev=c.id}};primitives.famdiagram.Slots.prototype.loop=function(a,b){for(var c=null!=b?b.id:this.first;null!=c;){c=this.slots[c];if(a(c))break;c=c.next}};
primitives.famdiagram.Slots.prototype.backwardLoop=function(a,b){for(var c=null!=b?b.id:this.last;null!=c;){c=this.slots[c];if(a(c))break;c=c.prev}};primitives.famdiagram.Slots.prototype.getSlot=function(a){return this.items[a]};
primitives.famdiagram.LabelAnnotationOptionTask=function(a,b,c){var d=[],e={},f=null,g={},h=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,c.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],
!1,c.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)},!1),!1,null,!0);return{process:function(){var c={isChanged:!1,hash:g,sourceHash:{}},j=b.getMaximumId(),k,l,m;d=h.read(d,a.getAnnotations(3),"annotations",c);e={};var n=c.sourceHash.annotations;k=0;for(l=d.length;k<l;k+=1)m=d[k],j+=1,m.id=j,e[m.id]=n[k];f=j;return c.isChanged},getAnnotations:function(){return d},getMaximumId:function(){return f},getConfig:function(a){return e[a]}}};
primitives.famdiagram.LabelAnnotationPlacementOptionTask=function(a){var b=[],c={},d=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id");return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getAnnotations(),"annotations",e);return e.isChanged},
getAnnotations:function(){return b},getMaximumId:function(){return a.getMaximumId()}}};
primitives.famdiagram.LabelAnnotationTemplateOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["number"],!0),title:new primitives.common.ValueReader(["string"],!0),itemTitleColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleColor),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id");return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(),
"annotations",b);return b.isChanged},getAnnotations:function(){return c}}};primitives.famdiagram.NeighboursSelectionModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({neighboursSelectionMode:new primitives.common.EnumerationReader(primitives.common.NeighboursSelectionMode,!1,b.neighboursSelectionMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getNeighboursSelectionMode:function(){return c.neighboursSelectionMode}}};
primitives.famdiagram.ItemsOptionTask=function(a,b){var c={},d={},e={},f=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parents:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:e};
c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return e["options-items"][a]}}};
primitives.famdiagram.LinePaletteOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({linesPalette:new primitives.common.ArrayReader(new primitives.common.ObjectReader({lineColor:new primitives.common.ValueReader(["string"],!1,b.lineColor),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType)}),!1)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),
"options",b);return b.isChanged},getOptions:function(){return c}}};primitives.famdiagram.NormalizeOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({groupByType:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.groupByType),alignBylevels:new primitives.common.ValueReader(["boolean"],!1,b.alignBylevels)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c}}};
primitives.famdiagram.OptionsTask=function(a){return{process:function(){return!0},getOptions:a,description:"Raw options."}};
primitives.famdiagram.SpousesOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),spouses:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)}),!0,"id")});return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",e);return e.isChanged},getItems:function(){return b.items}}};
primitives.famdiagram.VisualTreeOptionTask=function(){var a={leavesPlacementType:2,childrenPlacementType:2,maximumColumnsInMatrix:6,horizontalAlignment:0};return{process:function(){return!1},getOptions:function(){return a}}};primitives.famdiagram.CombinedTemplateParamsTask=function(a,b){return{process:function(){return!0},getTemplateParams:function(c){return a.getTemplateParams(c)||b.getTemplateParams(c)}}};
primitives.famdiagram.LabelAnnotationTemplateParamsTask=function(a,b,c){var d={};return{process:function(){var e=a.getOptions(),f=b.getAnnotations(),g,h;d={};g=0;for(h=f.length;g<h;g+=1){var i=f[g],j=new primitives.orgdiagram.TemplateParams,k=c.getTemplate(i.templateName,e.defaultLabelAnnotationTemplate,c.DefaultWidgetLabelAnnotationTemplateName);j.template=k;d[i.id]=j}return!0},getTemplateParams:function(a){return d[a]}}};
primitives.famdiagram.CursorNeighboursTask=function(a,b,c){function d(a,b,c){var d=[],e={};if(null!==a)switch(b){case 0:c.loopParents(this,a,function(a,b){e.hasOwnProperty(a)||(e[a]=!0,d.push(a));if(b.isActive)return c.SKIP});c.loopChildren(this,a,function(a,b){e.hasOwnProperty(a)||(e[a]=!0,d.push(a));if(b.isActive)return c.SKIP});break;case 1:c.loopNeighbours(this,a,function(a,b){e.hasOwnProperty(a)||(e[a]=!0,d.push(a));if(b.isActive)return!0})}return d}var e=[];return{process:function(){var f=a.getCursorTreeItem(),
g=c.getNavigationFamily(),h=b.getNeighboursSelectionMode();e=d(f,h,g);return!0},getItems:function(){return e}}};
primitives.famdiagram.AddLabelAnnotationsTask=function(a,b){function c(a,b){var c=primitives.common.graph(),d={},e,k,l,m;if(0<b.length){m=0;for(e=b.length;m<e;m+=1)k=b[m],d.hasOwnProperty(k.fromItem)?d[k.fromItem].push(k):(d[k.fromItem]=[k],a.loopChildren(this,k.fromItem,function(b){c.addEdge(k.fromItem,b,new primitives.famdiagram.EdgeItem(k.fromItem,k.fromItem,b,b));return a.SKIP}),a.loopParents(this,k.fromItem,function(b){c.addEdge(b,k.fromItem,new primitives.famdiagram.EdgeItem(b,b,k.fromItem,
k.fromItem));return a.SKIP}));for(l in d)if(d.hasOwnProperty(l)){e=d[l];e.sort(function(a,b){return b.toItems.length-a.toItems.length});for(m=0;m<e.length;m+=1){k=e[m];for(var n=a,q=c,s=k.fromItem,p=k.toItems,r=void 0,y=!0,w=null,t=void 0,u=void 0,z=void 0,v=void 0,x=[],u=0,z=p.length;u<z;u+=1)if(t=p[u],r=q.edge(s,t),null!=r){if(null==w)w=r.getFar(t);else if(w!=r.getFar(t)){y=!1;break}x.push(r.getNear(t))}else{y=!1;break}if(y&&(v=new primitives.famdiagram.FamilyItem({id:k.id,isVisible:!0,isLevelNeutral:!0,
isActive:!1,itemConfig:k}),n.bundleParents(w,x,v.id,v)?(v.levelGravity=2,y=!0):n.bundleChildren(w,x,v.id,v)?(v.levelGravity=1,y=!0):n.bundleParents(w,p,v.id,v)?(v.levelGravity=2,y=!0):n.bundleParents(w,p,v.id,v)&&(v.levelGravity=1,y=!0),y)){u=0;for(z=p.length;u<z;u+=1)t=p[u],r=q.edge(s,t),r.setFar(t,v.id)}}}}}var d=null,e=null;return{process:function(f){var g=b.getLogicalFamily(),h=a.getAnnotations(),g=g.clone();c(g,h);d=g;e=a.getMaximumId();if(f&&!g.validate())throw"References are broken in family structure!";
return!0},getNavigationFamily:function(){return d},getMaximumId:function(){return e}}};
primitives.famdiagram.AddSpousesTask=function(a,b){var c=null,d=null;return{process:function(e){var f=b.getLogicalFamily(),g=b.getMaximumId(),h=a.getItems(),i=f=f.clone(),j,k,l,m,n,q,s,p;l=0;for(m=h.length;l<m;l+=1){n=h[l];p=n.spouses.slice(0);q=0;for(s=p.length;q<s;q+=1)j=[n.id,p[q]],i.hasCommonChild(j)||(g+=1,k=new primitives.famdiagram.FamilyItem({id:g,isVisible:!1,isActive:!1,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+g,description:"This is fake child keeps spouses together."},
levelGravity:1}),i.add(j,k.id,k))}c=f;d=g;if(e&&!f.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return c},getMaximumId:function(){return d}}};
primitives.famdiagram.ItemsPositionsTask=function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){var b=new primitives.common.Rect(0,0,0,0),c,d,f,e,g;switch(H.orientationType){case 2:case 3:a.invert()}if(!C.isEmpty())switch(I.pageFitMode){case 0:case 4:case 5:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=n(c,0);break;default:c=[new primitives.orgdiagram.LevelVisibility(0,1)];d=[];switch(I.minimalVisibility){case 2:d.push(2);break;case 0:case 3:case 4:d.push(2),d.push(3)}C.loopLevelsReversed(this,function(a){var b;
for(b=0;b<d.length;b+=1)c.push(new primitives.orgdiagram.LevelVisibility(a,d[b]))});f=n(c,c.length-1);f.addRect(a);f.offset(0,0,5,5);g=e=a=null;b=n(c,0);if(!q(b,f)&&(a=0,b=n(c,c.length-1),q(b,f))){for(g=e=c.length-1;1<e-a;)g=Math.floor((e+a)/2),b=n(c,g),q(b,f)?e=g:a=g;e!==g&&(b=n(c,e))}}return b}function n(a,b){var c,d;D.treeLevelsPositions=[];C.loopLevels(this,function(){var a=new primitives.orgdiagram.TreeLevelPosition;a.currentvisibility=1;D.treeLevelsPositions.push(a)});for(c=0;c<=b;c+=1)d=a[c],
D.treeLevelsPositions[d.level].currentvisibility=d.currentvisibility;r();t();y();c=I.lineLevelShift;var f,e,g,k,i=d=0;f=8*J.linesWidth;switch(J.arrowsDirection){case 1:d=f;i=0;break;case 2:d=0,i=f}f=0;for(e=D.treeLevelsPositions.length;f<e;f+=1)g=D.treeLevelsPositions[f],k=h.getConnectorsStacksSizes(f),c+=g.setShift(c,w(g.actualVisibility),i,d,k.parentsStackSize);return new primitives.common.Rect(0,0,Math.round(p()),Math.round(s()))}function q(a,b){var c=!1;switch(I.pageFitMode){case 1:b.width>=a.width&&
(c=!0);break;case 2:b.height>=a.height&&(c=!0);break;case 3:b.height>=a.height&&b.width>=a.width&&(c=!0)}return c}function s(){var a=D.treeLevelsPositions[D.treeLevelsPositions.length-1];return a.shift+a.nextLevelShift}function p(){var a=0;C.loopLevels(this,function(b){var c=C.getLevelLength(b);0<c&&(b=C.getItemAtPosition(b,c-1),b=D.treeItemsPositions[b],a=Math.max(a,b.offset+b.actualSize.width+b.rightPadding))});return a}function r(){var a=k.getCursorTreeItem();D.treeItemsPositions={};C.loopLevels(this,
function(b){var c=D.treeLevelsPositions[b];C.loopLevelItems(this,b,function(b,d){var f=new primitives.orgdiagram.TreeItemPosition,e=l.isItemSelected(b)?1:!d.isVisible?4:0,g=j.getTemplateParams(b);f.actualVisibility=0===e?c.currentvisibility:e;f.setSize(a==b,g,I,H);D.treeItemsPositions[b]=f})})}function y(){var a,b;C.loopLevels(this,function(c){var d=D.treeLevelsPositions[c];d.shift=0;d.depth=0;d.actualVisibility=4;b=a=null;C.loopLevelItems(this,c,function(c){c=D.treeItemsPositions[c];d.depth=Math.max(d.depth,
c.actualSize.height);switch(c.actualVisibility){case 2:case 3:case 4:b=!b?c.actualSize.height:Math.min(b,c.actualSize.height);break;default:a=!a?c.actualSize.height:Math.min(a,c.actualSize.height)}d.actualVisibility=Math.min(d.actualVisibility,c.actualVisibility)});null==a&&(a=d.depth);null!=b&&b>a&&(a=b);switch(I.verticalAlignment){case 0:d.horizontalConnectorsDepth=a/2;break;case 1:d.horizontalConnectorsDepth=d.depth/2;break;case 2:d.horizontalConnectorsDepth=d.depth-a/2}})}function w(a){var b=
0;switch(a){case 1:b=I.normalLevelShift;break;case 2:b=I.dotLevelShift;break;case 3:case 4:b=I.lineLevelShift}return b}function t(){var a,b;a=0;for(b=D.treeLevelsPositions.length;a<b;a+=1)D.treeLevelsPositions[a].currentOffset=0;var c=C,d=E.getPlanarFamily(C),f=[],e,g={};a=0;c.loopLevels(this,function(b){c.loopLevelItems(this,b,function(e,h,k){if(!g.hasOwnProperty(e)){var i=d.countChildren(e);if(0<i){var j=new u(b,a);a+=1;j.addTop(k);d.loopChildren(this,e,function(a){j.addBottom(c.getItemPosition(a));
1==i&&d.loopParents(this,a,function(a){j.addTop(c.getItemPosition(a));g[a]=j;return d.SKIP});return d.SKIP});f.push(j);g[e]=j}}})});var h={},k=[],j=0,l,n;a=0;for(b=f.length;a<b;a+=1)if(e=f[a],l=e.topMiddle(),n=e.bottomMiddle(),null!=l&&null!=n){l=c.getItemAtPosition(e.level,l);var m=c.getItemAtPosition(e.level+1,n);n=h[l];null==n&&(n=new z(j),j+=1,n.add(e.level,l),h[l]=n,k.push(n));n.add(e.level+1,m);h[m]=n}c.loopLevels(this,function(a){c.loopLevelItems(this,a,function(b){var c=h[b];null==c&&(c=new z(j),
j+=1,c.add(a,b),h[b]=c,k.push(c))})});var q=new primitives.common.dependencies;c.loopLevels(this,function(a){var b=null;c.loopLevelItems(this,a,function(a){a=h[a];null!=b&&q.add(b,a.id,new v(null));b=a.id})});a=0;for(b=f.length;a<b;a+=1)e=f[a],e.loopDependencies(function(a,b,d,f,e){a=c.getItemAtPosition(b,a);f=c.getItemAtPosition(e,f);q.add(h[a].id,h[f].id,new v(d?a:f))});var p={},s=0;q.loopTopoForward(this,function(a){var b=0;q.loopBackward(this,a,function(c,d){var f=x(k[c],k[a],d.itemToMeasure);
b=Math.max(b,p[c]+f)});p[a]=b;s=Math.max(s,b)});var t={};a=0;for(b=f.length;a<b;a+=1)e=f[a],e.getRightPosition(this,function(a,b){var d=c.getItemAtPosition(a,b);t[h[d].id]=!0});q.loopTopoBackward(this,function(a){if(!t.hasOwnProperty(a)){var b=null;q.loopForward(this,a,function(c,d){var f=x(k[a],k[c],d.itemToMeasure);b=null==b?p[c]-f:Math.min(b,p[c]-f)});null!=b&&(p[a]=b)}});var H={};q.loopTopoBackward(this,function(a){var b=s;q.loopForward(this,a,function(c,d){var f=x(k[a],k[c],d.itemToMeasure);
b=Math.min(b,p[c]-f)});H[a]=b});var J={};a=0;for(b=f.length;a<b;a+=1)e=f[a],e.getLeftPosition(this,function(a,b){var d=c.getItemAtPosition(a,b);J[h[d].id]=!0});q.loopTopoForward(this,function(a,b){J.hasOwnProperty(a)||(b=null,q.loopBackward(this,a,function(c,d){var f=x(k[c],k[a],d.itemToMeasure);b=null==b?H[c]+f:Math.max(b,H[c]+f)}),null!=b&&(H[a]=b))});for(var r in p)p.hasOwnProperty(r)&&(p[r]=(p[r]+H[r])/2);var A=null;q.loopTopoForward(this,function(a,b,c){var b=k[a],d=p[a];if(0==c)b.loop(this,
function(a){a=D.treeItemsPositions[a];i.getInterval(a.actualVisibility);a=d-a.actualSize.width/2;A=null==A?a:Math.min(a,A)});else return!0});var A=A||0,B;b=0;for(e=k.length;b<e;b+=1)n=k[b],B=p[n.id]||0,n.loop(this,function(a){var a=D.treeItemsPositions[a],b=i.getInterval(a.actualVisibility)/2;a.leftPadding=b;a.rightPadding=b;a.offset=B-a.actualSize.width/2-A})}function u(a,b){this.id=b;this.level=a;this.bottomRight=this.bottomLeft=this.topRight=this.topLeft=null;this.topItems={};this.bottomItems=
{};this.addTop=function(a){this.topItems[a]=!0;null==this.topLeft?this.topRight=this.topLeft=a:(this.topLeft=Math.min(this.topLeft,a),this.topRight=Math.max(this.topRight,a))};this.addBottom=function(a){this.bottomItems[a]=!0;null==this.bottomLeft?this.bottomRight=this.bottomLeft=a:(this.bottomLeft=Math.min(this.bottomLeft,a),this.bottomRight=Math.max(this.bottomRight,a))};this.topMiddle=function(){var a=null;if(this.topLeft==this.topRight)a=this.topLeft;else if(0===(this.topRight-this.topLeft)%2)for(a=
(this.topRight+this.topLeft)/2;!this.topItems.hasOwnProperty(a);)a+=1;return a};this.bottomMiddle=function(){var a=null;if(this.bottomLeft==this.bottomRight)a=this.bottomLeft;else if(0===(this.bottomRight-this.bottomLeft)%2)for(a=(this.bottomRight+this.bottomLeft)/2;!this.bottomItems.hasOwnProperty(a);)a+=1;return a};this.loopDependencies=function(a){var b=this.topMiddle(),c=this.bottomMiddle();if(null==b){var b=Math.floor((this.topRight+this.topLeft)/2),d=Math.ceil((this.topRight+this.topLeft)/2);
a(b,this.level,!0,c,this.level+1,!1);a(c,this.level+1,!1,d,this.level,!0)}else null==c&&(c=Math.floor((this.bottomRight+this.bottomLeft)/2),d=Math.ceil((this.bottomRight+this.bottomLeft)/2),a(c,this.level+1,!0,b,this.level,!1),a(b,this.level,!1,d,this.level+1,!0))};this.loopPositions=function(a){var b;for(b=this.topLeft;b<=this.topRight;b+=1)a(b,this.level);for(b=this.bottomLeft;b<=this.bottomRight;b+=1)a(b,this.level+1)};this.getLeftPosition=function(a,b){this.topLeft!=this.topRight?b.call(a,this.level,
this.topLeft):this.bottomLeft!=this.bottomRight&&b.call(a,this.level+1,this.bottomLeft)};this.getRightPosition=function(a,b){this.topLeft!=this.topRight?b.call(a,this.level,this.topRight):this.bottomLeft!=this.bottomRight&&b.call(a,this.level+1,this.bottomRight)}}function z(a){this.id=a;this.items={};this.maximum=this.minimum=null;this.add=function(a,b){this.items[a]=b;this.minimum=null!=this.minimum?Math.min(this.minimum,a):a;this.maximum=null!=this.maximum?Math.max(this.maximum,a):a};this.loop=
function(a,b){for(var c=this.items,d=this.minimum;d<=this.maximum;d+=1)b.call(a,c[d],d)}}function v(a){this.itemToMeasure=a}function x(a,b,c){var d=0;if(null==c)for(var f=Math.max(a.minimum,b.minimum),c=Math.min(a.maximum,b.maximum);f<=c;f+=1)d=Math.max(d,A(a.items[f],b.items[f]));else d=A(c,null);return d}function A(a,b){var c=0;if(null!=a)var d=D.treeItemsPositions[a],f=i.getInterval(d.actualVisibility)/2,c=c+(d.actualSize.width/2+f);null!=b&&(d=D.treeItemsPositions[b],f=i.getInterval(d.actualVisibility)/
2,c+=d.actualSize.width/2+f);return c}function B(){C.loopLevels(this,function(a){var b=D.treeLevelsPositions[a];C.loopLevelItems(this,a,function(a){D.treeItemsPositions[a].setPosition(b,I,H)})})}var D={treeItemsPositions:{},treeLevelsPositions:[],panelSize:null},E,C,H,J,I,F;return{process:function(){var k;I=d.getOptions();H=c.getOptions();J=e.getOptions();f.getOptions();E=g.getLogicalFamily();C=h.getTreeLevels();D.treeLevelsPositions=[];D.treeItemsPositions={};k=a.getOptimalPanelSize();F=b.getOptions();
k.scale(1/F.scale);k=new primitives.common.Rect(0,0,k.width,k.height);D.panelSize=m(k);B();return!0},getTreeLevelsPositions:function(){return D.treeLevelsPositions},getItemsPositions:function(){return D.treeItemsPositions},getItemPosition:function(a){return D.treeItemsPositions[a]},getContentSize:function(){return D.panelSize}}};
primitives.famdiagram.LevelsTask=function(a,b,c){var d,e,f,g,h;function i(a){var b,c,f,e,g,h,i,m,s=[],u,z,t,y,M,P,Z,aa,ga,ha,ja,X=[],ia;if(0<a.hasNodes()){ja={};z=0;ia=[];a.loopRoots(this,function(b){var c=t=new primitives.famdiagram.Family(z),d,f=[],e,g,b=a.node(b),f=q(b.id,null,c.id,b.level,b.itemConfig);f.hideParentConnection=!0;f.isVisible=b.isVisible;f.isActive=b.isActive;f.hideParentConnection=b.hideParentConnection;f.hideChildrenConnection=b.hideChildrenConnection;c.items.push(f);ja[b.id]=
!0;b.familyId=c.id;for(f=n(b,a,ja,c);0<f.length;){e=[];b=0;for(d=f.length;b<d;b+=1)g=f[b],e=e.concat(n(g,a,ja,c));f=e}X.push(t);ia.push(t);z+=1});ia.sort(function(a,b){var c=a.items[0].level,d=b.items[0].level;return c!=d?c-d:b.items.length-a.items.length});s=[];u={};if(0<X.length){g=primitives.common.graph();b=0;for(c=X.length;b<c;b+=1){t=X[b];f=0;for(e=t.links.length;f<e;f+=1)h=t.links[f],m=a.node(h.fromItem).familyId,i=a.node(h.toItem).familyId,m!=i&&(g.addEdge(m,i,{weight:0}),g.edge(m,i).weight+=
1),X[i].backLinks.push(new primitives.famdiagram.FamLink(h.toItem,h.fromItem))}for(;s.length<X.length;){b=0;for(c=ia.length;b<c;b+=1)t=ia[b],u.hasOwnProperty(t.id)||(ga=g.getSpanningTree(t.id,function(a){return-a.weight}),null!=ga.node(t.id)?(ga.loopPostOrder(this,function(a,b,c){var b=X[a],d=X[c],f=[];null!=c&&(d.familyPriority+=b.familyPriority);f=[];ga.loopChildren(this,a,function(a){f.push(a)});f.sort(function(a,b){return X[a].familyPriority-X[b].familyPriority});ga.arrangeChildren(a,f)}),ga.loopPreOrder(this,
function(a){s.push(a);u[a]=!0})):(s.push(t.id),u[t.id]=!0))}}d+=1;m=q(d,null,null,w-1,null);m.hideParentConnection=!0;m.hideChildrenConnection=!0;m.title="internal root";m.isVisible=!1;m.isActive=!1;m.childIndex=0;e={};b=0;for(c=s.length;b<c;b+=1){t=X[s[b]];Z={};g=m;aa=0;i=t.links.concat(t.backLinks);for(f=0;f<i.length;f+=1)h=i[f],M=p.node(h.toItem),p.node(h.fromItem),!0===e[M.familyId]&&(y=t.items[0],P=M,P.level>=y.level&&p.loopParents(this,P.id,function(a,b){P=b;if(b.level<y.level)return!0}),Z[P.id]=
Z.hasOwnProperty(P.id)?Z[P.id]+1:1,aa<Z[P.id]&&(g=P,aa=Z[P.id]));f=t;h=void 0;i=f.items[0];M=null;M=g;for(h=g.level+1;h<i.level;h+=1)d+=1,M=q(d,M.id,null,h,null),M.title="shift",M.isVisible=!1,M.isActive=!1,M.hideParentConnection=!0,M.hideChildrenConnection=!0,f.items.push(M);i.hideParentConnection=!0;p.adopt(M.id,i.id,i);e[t.id]=!0}b={};for(ha in r)if(r.hasOwnProperty(ha)){c=p.node(ha);m=r[ha];e=0;for(g=m.length;e<g;e+=1)f=p.node(m[e]),l(b,f,c)}ha=j();k(p,b,ha)}}function j(){var a={};p.loopPostOrder(this,
function(b,c,d){w=null!=w?Math.min(w,c.level):c.level;t=null!=t?Math.max(t,c.level):c.level;if(null!=d&&(a[d]||(a[d]={}),c=c.level-1,a[d][c]=a[d][c]?a[d][c]+1:1,null!=a[b]))for(c in a[b])a[b].hasOwnProperty(c)&&(a[d][c]=a[d][c]?a[d][c]+a[b][c]:a[b][c])});return a}function k(a,b,c){var d,f,e,g,h,k,i,j,l,n,m;a.loopLevels(this,function(q,p){var s=primitives.common.graph(),t={},u=null,z;i=[];a.loopChildren(this,p.id,function(c,e,g){var i;null==u&&(u=e);t[e.id]={};if(b.hasOwnProperty(e.id))for(i in k=
b[e.id],k)if(k.hasOwnProperty(i)){n=k[i];t[e.id][i]={};d=0;for(f=n.length;d<f;d+=1)h=n[d],z=h.commonParent==p.id?h.toParent:a.node(h.fromParent).childIndex<a.node(h.toParent).childIndex?"__right__":"__left__",e.id!=z&&(s.addEdge(e.id,z,{weight:0}),s.edge(e.id,z).weight+=1,null==t[e.id][i][z]&&(t[e.id][i][z]=0),t[e.id][i][z]+=1)}0<g&&s.addEdge(e.id,u.id,{weight:0})});if(null!=u){m=s.getGrowthSequence(function(a){return a.weight});0===m.length&&(m=[u.id]);var r=m,y=[],w,T,V,L,S,$,Y,ka,la,U,ca,Q,O,W,
ma,R,ba,ea,fa,da;T=new primitives.famdiagram.Slots;T.add(new primitives.famdiagram.Slot("__left__"));T.add(new primitives.famdiagram.Slot(null));T.add(new primitives.famdiagram.Slot("__right__"));V=0;T.loop(function(a){V+=1;a.position=V});for(w=0;w<r.length;w+=1)if(L=r[w],"__left__"!=L&&"__right__"!=L)for(ba in la=ka=Y=$=S=null,T.loop(function(a){var b,d,f,e;if(null==a.itemId){W=c[L];O=Q=ca=U=0;for(b in a.crossings)a.crossings.hasOwnProperty(b)&&(W&&null!=W[b]&&(U+=a.crossings[b]*W[b]),O+=a.crossings[b]);
for(b in t[L])if(t[L].hasOwnProperty(b))for(d in f=t[L][b],f)f.hasOwnProperty(d)&&(e=T.getSlot(d),null!=e&&(e.position<a.position?(U+=(a.left[b]||0)-(e.left[b]||0),Q+=Math.abs(e.balance+1)):(U+=(a.right[b]||0)-(e.right[b]||0),Q+=Math.abs(e.balance-1)),ca+=Math.abs(e.position-a.position)));if(null==$||$>U||$==U&&(Y>ca||Y==ca&&(ka>Q||ka==Q&&la>O)))$=U,S=a,Y=ca,ka=Q,la=O}}),ma=S.clone(),R=S.clone(),R.itemId=L,T.insertBefore(S,ma),T.insertBefore(S,R),V=R.position=0,T.loop(function(a){var b,d;if(a.id!=
R.id){d=c[L];for(b in d)d.hasOwnProperty(b)&&(a.left[b]=a.left[b]?a.left[b]+d[b]:d[b]);V+=1;a.position=V}},R),V=0,T.backwardLoop(function(a){var b,d;if(a.id!=R.id){d=c[L];for(b in c[L])c[L].hasOwnProperty(b)&&(a.right[b]=a.right[b]?a.right[b]+d[b]:d[b]);V-=1;a.position=V}},R),t[L])if(t[L].hasOwnProperty(ba))for(fa in ea=t[L][ba],ea)ea.hasOwnProperty(fa)&&(da=T.getSlot(fa),null!=da&&(0>da.position?(da.balance+=1,R.balance-=1,T.backwardLoop(function(a){if(a.id!=R.id)if(a.id!=da.id)a.crossings[ba]=a.crossings[ba]?
a.crossings[ba]+ea[fa]:ea[fa];else return!0},R)):(da.balance-=1,R.balance+=1,T.loop(function(a){if(a.id!=R.id)if(a.id!=da.id)a.crossings[ba]=a.crossings[ba]?a.crossings[ba]+ea[fa]:ea[fa];else return!0},R))));T.loop(function(a){a=a.itemId;null!=a&&("__left__"!=a&&"__right__"!=a)&&y.push(a)});j=y;e=0;for(g=j.length;e<g;e+=1)l=a.node(j[e]),l.childIndex=e,i.push(l.id)}a.arrangeChildren(p.id,i)})}function l(a,b,c){var d=new primitives.famdiagram.ExtraGravity(b.level),f=new primitives.famdiagram.ExtraGravity(c.level);
p.zipUp(this,b.id,c.id,function(b,c,e,g){m(a,b,d);m(a,e,f);if(c==g)return d.commonParent=c,d.fromParent=b,d.toParent=e,f.commonParent=c,f.fromParent=e,f.toParent=b,!0})}function m(a,b,c){a.hasOwnProperty(b)||(a[b]={});null==a[b][c.level]&&(a[b][c.level]=[]);a[b][c.level].push(c)}function n(a,b,c,d){var f=[],e=null,g=null,h;1==b.countChildren(a.id)&&(e=b.firstChild(a.id));null!=y[e]?(g=y[e],null==r[g.id]&&(r[g.id]=[]),r[g.id].push(a.id),d.links.push(new primitives.famdiagram.FamLink(a.id,e))):(null!=
e&&(y[e]=a),b.loopChildren(this,a.id,function(e,g){if(c[g.id])throw"Many to many relations should not exist at this stage";f.push(g);h=q(g.id,a.id,d.id,g.level,g.itemConfig);h.hideParentConnection=g.hideParentConnection;h.hideChildrenConnection=g.hideChildrenConnection;h.isVisible=g.isVisible;h.isActive=g.isActive;d.items.push(h);c[g.id]=!0;g.familyId=d.id;return b.SKIP}));return f}function q(a,c,d,f,e){var g=new primitives.orgdiagram.OrgItem({});g.id=a;g.familyId=d;g.level=f;a=0;for(d=u.length;a<
d;a+=1)f=u[a],g[f]=null!=e&&void 0!==e[f]?e[f]:b[f];p.add(c,g.id,g);return g}function s(a,b,c,d,f){var e,g,h,k,i,j,l,n,m,q={},p,s,t;c.loopLevels(this,function(u){var z=new primitives.orgdiagram.TreeLevelConnectorStackSize;b[u]=z;m=[];c.loopLevelItems(this,u,function(b,c){var h=[],k=[],i;if(!q.hasOwnProperty(b)){q[b]=!0;c.hideChildrenConnection||h.push(b);i=f[b];if(null!=i){e=0;for(g=i.length;e<g;e+=1){var j=i[e];q[j]=!0;h.push(j)}}d.loopChildren(this,b,function(a,b){b.hideParentConnection||k.push(a)});
if(1<h.length||0<k.length)n=new primitives.orgdiagram.ConnectorBundle,n.fromLevel=u,n.fromItems=h,n.toItems=k,a.push(n),1<h.length&&m.push(n)}});if(0<m.length){t=primitives.common.pile();h=0;for(k=m.length;h<k;h+=1){n=m[h];s=p=null;i=0;for(j=n.fromItems.length;i<j;i+=1)l=c.getItemPosition(n.fromItems[i]),p=null!=p?Math.min(p,l):l,s=null!=s?Math.max(s,l):l;t.add(p,s,n)}z.parentsStackSize=t.resolve(this,function(a,b,c,d){c.fromOffset=d+1})}})}h=g=f=e=d=null;var p,r,y={},w,t,u="title description image itemTitleColor groupTitle groupTitleColor isActive hasSelectorCheckbox hasButtons templateName showCallout calloutTemplateName label showLabel labelSize labelOrientation labelPlacement minimizedItemShapeType".split(" "),
z=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var b=a.getLogicalFamily(),b=b.clone();p=primitives.common.tree();d=a.getMaximumId();r={};y={};t=w=null;i(b);e=primitives.common.TreeLevels();f=primitives.common.TreeLevels();p.loopLevels(this,function(a,b,d){var g=c.getTemplateParams(a);e.addItem(d,a,b);null!=g&&(g.isActive&&b.isVisible)&&f.addItem(d,a,b)});g=[];h=[];s(g,h,e,p,r);return!0},getMaximumId:function(){return d},getTreeLevels:function(){return e},getActiveTreeLevels:function(){return f},
getBundles:function(){return g},getConnectorsStacksSizes:function(a){return h[a]||z}}};
primitives.famdiagram.LogicalFamilyTask=function(a){var b=null,c=null;return{process:function(d){var e,f,g,h,i=a.getItems(),j=primitives.common.family(),k=0;if(0<i.length){e=0;for(f=i.length;e<f;e+=1)g=i[e],null!=g&&(h=new primitives.famdiagram.FamilyItem({id:g.id,itemConfig:g,isActive:g.isActive}),j.add(g.parents,h.id,h),g=parseInt(g.id,10),k=Math.max(isNaN(g)?0:g,k))}b=j;c=k;if(d&&!j.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return b},getMaximumId:function(){return c}}};
primitives.famdiagram.NormalizeLogicalFamilyTask=function(a,b){function c(a,b,c){if(0<a.hasNodes()){a.loopLevels(this,1==j.groupByType,function(a,b,c){b.level=c});a.optimizeReferences(function(){b+=1;return new primitives.famdiagram.FamilyItem({id:b,isVisible:!1,isActive:!1,itemConfig:{title:"bundle #"+b,description:" This item was created by references optimizer."},levelGravity:2})});if(c&&!a.validate())throw"References are broken in family structure!";if(c&&a.hasLoops())throw"Structure has loops!";
a.eliminateManyToMany(function(){b+=1;return new primitives.famdiagram.FamilyItem({id:b,isVisible:!1,isActive:!1,itemConfig:{title:"dummy #"+b,description:"This is item used to eliminate M:M relations."},levelGravity:2,hideParentConnection:!1,hideChildrenConnection:!1})});if(c&&!a.validate())throw"References are broken in family structure!";j.alignBylevels?d(a):a.loopLevels(this,1==j.groupByType,function(a,b,c){b.level=c});c&&g(a,!1);f(a,function(){b+=1;return new primitives.famdiagram.FamilyItem({id:b,
levelGravity:2,isVisible:!1,isActive:!1,itemConfig:{title:"extension #"+b,description:"This is item used to fill gaps in levels."}})});c&&g(a,!0)}return b}function d(a){var b=[],c=null,d=null,f,g;a.loop(this,function(a,f){f.originalLevel=f.level;f.level=null;null!=f.originalLevel&&(b[f.originalLevel]||(b[f.originalLevel]={}),b[f.originalLevel][a]=f,c=null!=c?Math.min(f.originalLevel,c):f.originalLevel,d=null!=d?Math.max(f.originalLevel,d):f.originalLevel)});for(f=c;f<=d;f+=1)g=b[f],e(g,a);a.loopTopo(this,
function(b,c){var d;1==c.levelGravity&&(d=null,a.loopParents(this,b,function(b,c){d=null==d?c.level+1:Math.max(c.level+1,d);return a.SKIP}),c.level=!d?c.level:d)})}function e(a,b){var c=0,d,f,e;for(d in a)a.hasOwnProperty(d)&&b.loopParents(this,d,function(a,d){c=Math.max(d.level+1,c);return b.SKIP});for(d in a)a.hasOwnProperty(d)&&(f=a[d],f.level=c);for(;!primitives.common.isEmptyObject(a);){e={};for(d in a)a.hasOwnProperty(d)&&(f=a[d],b.loopChildren(this,d,function(a,c){if(null==c.originalLevel||
c.isLevelNeutral)c.level=null==c.level?f.level+1:Math.max(c.level,f.level+1),e[a]=c;return b.SKIP}));a=e}}function f(a,b){var c;a.loop(this,function(d,f){for(var e=!0,g;e;)e=!1,g=[],a.loopParents(this,d,function(b,c){f.level-1>c.level&&g.push(b);return a.SKIP}),1<g.length&&(c=b(f),c.level=f.level-1,c.hideParentConnection=!1,c.hideChildrenConnection=!1,a.bundleParents(d,g,c.id,c),e=!0,d=c.id,f=c)});a.loop(this,function(d,f){for(var e=!0,g,h=!0;e;)e=!1,g=[],a.loopChildren(this,d,function(b,c){f.level+
1<c.level?g.push(b):h=!1;return a.SKIP}),1<g.length&&(c=b(f),c.level=f.level+1,h&&(c.hideParentConnection=!1,c.hideChildrenConnection=!1),a.bundleChildren(d,g,c.id,c),e=!0,d=c.id,f=c)});a.loop(this,function(d,f){for(var e=!0,g;e;)e=!1,g=[],a.loopParents(this,d,function(b,c){f.level-1>c.level&&g.push(b);return a.SKIP}),0<g.length&&(c=b(f),c.level=f.level-1,c.hideParentConnection=!1,c.hideChildrenConnection=!1,a.bundleParents(d,g,c.id,c),e=!0,d=c.id,f=c)})}function g(a,b){if(!a.validate())throw"Family structure failed to pass validation!";
a.loop(this,function(c,d){a.loopChildren(this,c,function(c,f){if(null===f.level||null===d.level||(b?f.level!=d.level+1:f.level<=d.level))throw"Family tree is broken. Children/Parents or levels mismatch!";return a.SKIP})})}var h=null,i=null,j;return{process:function(d){var f=b.getLogicalFamily(),e=b.getMaximumId();j=a.getOptions();f=f.clone();e=c(f,e,d);h=f;i=e;if(d&&!f.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return h},getMaximumId:function(){return i}}};
primitives.famdiagram.RemoveLoopsTask=function(a,b){function c(a,b,c){var d,e,k,l,m,n,q,s,p;d=b.clone();b.loopTopo(this,function(a){d.removeNode(a)});if(d.hasNodes()){l=0;for(m=a.length;l<m;l+=1)if(e=a[l],null!=d.node(e.id)){p=[];d.loopParents(this,e.id,function(a){p.push(a);return d.SKIP});n=0;for(q=p.length;n<q;n+=1)d.removeRelation(p[n],e.id),b.removeRelation(p[n],e.id);c+=1;k=new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,
itemConfig:{title:"fake parent #"+c,description:"This is fake parent item was created by loops reversal."}});b.add([],k.id,k);b.adopt([k.id],e.id);n=0;for(q=p.length;n<q;n+=1)c+=1,e=new primitives.famdiagram.FamilyItem({id:c,isVisible:!1,isActive:!0,isLevelNeutral:!0,hideParentConnection:!0,hideChildrenConnection:!0,itemConfig:{title:"fake child #"+c,description:"This is fake child item was created by loops reversal."}}),b.add([k.id,p[n]],e.id,e);s=[];d.loopTopo(this,function(a){s.push(a)});n=0;for(q=
s.length;n<q;n+=1)d.removeNode(s[n])}}return c}var d=null,e=null;return{process:function(f){var g=b.getNavigationFamily(),h=b.getMaximumId(),i=a.getItems(),g=g.clone(),h=c(i,g,h,f);d=g;e=h;if(f&&!g.validate())throw"References are broken in family structure!";return!0},getLogicalFamily:function(){return d},getMaximumId:function(){return e}}};
primitives.common.LabelAnnotationTemplate=function(){var a,b=jQuery('<div class="bp-label-annotation"></div>');b.addClass("bp-item");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){b.element.text(b.context.title)}}};
primitives.famdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,function(a,b,e){var f=new primitives.common.TaskManager;f.addDependency("options",a);f.addDependency("graphics",b);f.addDependency("layout",e);f.addDependency("defaultConfig",new primitives.famdiagram.Config);f.addDependency("defaultItemConfig",new primitives.famdiagram.ItemConfig);f.addDependency("defaultTemplateConfig",new primitives.famdiagram.TemplateConfig);f.addDependency("defaultButtonConfig",new primitives.famdiagram.ButtonConfig);
f.addDependency("defaultPaletteItemConfig",new primitives.famdiagram.PaletteItemConfig);f.addDependency("defaultBackgroundAnnotationConfig",new primitives.famdiagram.BackgroundAnnotationConfig);f.addDependency("defaultConnectorAnnotationConfig",new primitives.famdiagram.ConnectorAnnotationConfig);f.addDependency("defaultHighlightPathAnnotationConfig",new primitives.famdiagram.HighlightPathAnnotationConfig);f.addDependency("defaultShapeAnnotationConfig",new primitives.famdiagram.ShapeAnnotationConfig);
f.addDependency("defaultLabelAnnotationConfig",new primitives.famdiagram.LabelAnnotationConfig);f.addDependency("isFamilyChartMode",!0);f.addDependency("showElbowDots",!0);f.addDependency("null",null);f.addDependency("foreground",2);f.addDependency("background",1);f.addTask("OptionsTask",["options"],primitives.famdiagram.OptionsTask,"#000000");f.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");f.addTask("CurrentScrollPositionTask",
["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,"#000000");f.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");f.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");f.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.ItemsOptionTask,"#000080");f.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],
primitives.famdiagram.SpousesOptionTask,"#000080");f.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");f.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,"#000080");f.addTask("PrintPreviewOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.PrintPreviewOptionTask,"#000080");f.addTask("TemplatesOptionTask",["OptionsTask",
"defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");f.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");f.addTask("VisualTreeOptionTask",["OptionsTask"],primitives.famdiagram.VisualTreeOptionTask,"#000080");f.addTask("MinimizedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,"#000080");f.addTask("NormalizeOptionTask",["OptionsTask","defaultConfig"],
primitives.famdiagram.NormalizeOptionTask,"#000080");f.addTask("LinePaletteOptionTask",["OptionsTask","defaultPaletteItemConfig"],primitives.famdiagram.LinePaletteOptionTask,"#000080");f.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");f.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");f.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,
"#000080");f.addTask("CursorSelectionPathModeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");f.addTask("NeighboursSelectionModeOptionTask",["OptionsTask","defaultConfig"],primitives.famdiagram.NeighboursSelectionModeOptionTask,"#000080");f.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");f.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig",
"foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");f.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");f.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");f.addTask("BackgroundHighlightPathAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");f.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");f.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,
"#000080");f.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");f.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");f.addTask("IntervalsTask",["ItemsSizesOptionTask"],primitives.orgdiagram.IntervalsTask,"#00ffff");f.addTask("LogicalFamilyTask",["ItemsOptionTask"],primitives.famdiagram.LogicalFamilyTask,"#00ffff");f.addTask("LabelAnnotationOptionTask",
["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationOptionTask,"#000080");f.addTask("LabelAnnotationTemplateOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationTemplateOptionTask,"#000080");f.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationPlacementOptionTask,"#000080");f.addTask("CombinedContextsTask",
["ItemsOptionTask","LabelAnnotationOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");f.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask","LogicalFamilyTask"],primitives.famdiagram.AddLabelAnnotationsTask,"#ff0000");f.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.RemoveLoopsTask,"#ff0000");f.addTask("AddSpousesTask",["SpousesOptionTask","RemoveLoopsTask"],primitives.famdiagram.AddSpousesTask,"#ff0000");f.addTask("NormalizeLogicalFamilyTask",
["NormalizeOptionTask","AddSpousesTask"],primitives.famdiagram.NormalizeLogicalFamilyTask,"#ff0000");f.addTask("LevelsTask",["NormalizeLogicalFamilyTask","defaultItemConfig","CombinedTemplateParamsTask"],primitives.famdiagram.LevelsTask,"#ff0000");f.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");f.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,
"#00ffff");f.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],primitives.famdiagram.LabelAnnotationTemplateParamsTask,"#00ffff");f.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],primitives.famdiagram.CombinedTemplateParamsTask,"#00ffff");f.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");f.addTask("CheckBoxTemplateTask",
["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");f.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");f.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");f.addTask("PrintPreviewTemplateTask",["ItemsOptionTask"],primitives.orgdiagram.PrintPreviewTemplateTask,"#00ffff");f.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask",
"LevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");f.addTask("HighlightItemTask",["HighlightItemOptionTask","LevelsTask"],primitives.orgdiagram.HighlightItemTask,"#00ffff");f.addTask("CursorItemTask",["CursorItemOptionTask","LevelsTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");f.addTask("CursorNeighboursTask",["CursorItemTask","NeighboursSelectionModeOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.CursorNeighboursTask,"#00ffff");f.addTask("SelectedItemsTask",
["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");f.addTask("SelectionPathItemsTask",["AddLabelAnnotationsTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");f.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",
["BackgroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",
["BackgroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",["ForegroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",["BackgroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");
f.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");f.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask NormalizeLogicalFamilyTask LevelsTask IntervalsTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.famdiagram.ItemsPositionsTask,"#ff0000");f.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask PrintPreviewOptionTask CurrentControlSizeTask LevelsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");f.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");f.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");f.addTask("BackgroundAnnotationManagerTask",["ItemsSizesOptionTask","LevelsTask","AlignDiagramTask"],
primitives.orgdiagram.BackgroundAnnotationManagerTask,"#00ffff");f.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");f.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask PrintPreviewOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#00ffff");f.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask",
"ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");f.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");f.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask BackgroundAnnotationManagerTask".split(" "),
primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");f.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");f.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");f.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");f.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");f.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawCursorTask,"#008000");f.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),
primitives.orgdiagram.DrawHighlightTask,"#008000");f.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");f.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");f.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask CombinedTemplateParamsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");f.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],primitives.orgdiagram.DrawConnectorsTask,"#008000");f.addTask("DrawItemLabelsTask","graphics CreateTransformTask ApplyLayoutChangesTask LabelsOptionTask LevelsTask AlignDiagramTask".split(" "),
primitives.orgdiagram.DrawItemLabelsTask,"#008000");f.addTask("DrawPrintPreviewTask","graphics ApplyLayoutChangesTask PrintPreviewOptionTask AlignDiagramTask PrintPreviewTemplateTask ScaleOptionTask".split(" "),primitives.orgdiagram.DrawPrintPreviewTask,"#008000");return f},function(a,b,e,f){var g=new primitives.famdiagram.EventArgs,h=a.tasks.getTask("CombinedContextsTask"),i=a.tasks.getTask("AlignDiagramTask"),j=a.tasks.getTask("LogicalFamilyTask"),b=h.getConfig(b),k=h.getConfig(e),l=j.getLogicalFamily();
b&&null!=b.id&&(g.oldContext=b);k&&null!=k.id&&(g.context=k,l.loopParents(this,k.id,function(a,b,c){if(0<c)return l.BREAK;g.parentItems.push(h.getConfig(a))}),l.loopChildren(this,k.id,function(a,b,c){if(0<c)return l.BREAK;g.childrenItems.push(h.getConfig(a))}),j=a.layout.mousePanel.offset(),a=a.layout.element.offset(),e=i.getItemPosition(e),g.position=(new primitives.common.Rect(e.actualPosition)).translate(j.left,j.top).translate(-a.left,-a.top));null!=f&&(g.name=f);return g})};
primitives.orgdiagram.TemplateConfig=function(){this.name=null;this.isActive=!0;this.itemSize=new primitives.common.Size(120,100);this.itemBorderWidth=1;this.minimizedItemShapeType=this.itemTemplate=null;this.minimizedItemSize=new primitives.common.Size(4,4);this.minimizedItemCornerRadius=null;this.minimizedItemLineWidth=1;this.minimizedItemBorderColor=null;this.minimizedItemLineType=0;this.minimizedItemFillColor=null;this.minimizedItemOpacity=1;this.highlightPadding=new primitives.common.Thickness(2,
2,2,2);this.highlightBorderWidth=1;this.highlightTemplate=null;this.cursorPadding=new primitives.common.Thickness(3,3,3,3);this.cursorBorderWidth=2;this.buttons=this.cursorTemplate=null};
primitives.orgdiagram.BackgroundAnnotationConfig=function(a){var b;this.annotationType=4;this.items=[];this.includeChildren=!1;this.zOrderType=0;this.lineWidth=2;this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ButtonConfig=function(a,b,c){this.name=a;this.icon=b;this.text=!1;this.label=null;this.tooltip=c;this.size=new primitives.common.Size(16,16)};
primitives.orgdiagram.Config=function(a){this.name=void 0!==a?a:"OrgDiagram";this.classPrefix="orgdiagram";this.graphicsType=this.navigationMode=0;this.actualGraphicsType=null;this.pageFitMode=3;this.minimalVisibility=2;this.horizontalAlignment=this.orientationType=0;this.verticalAlignment=1;this.arrowsDirection=0;this.showExtraArrows=!1;this.extraArrowsMinimumSpace=30;this.showHorizontalArrows=!1;this.connectorType=0;this.bevelSize=4;this.elbowType=0;this.elbowDotSize=4;this.emptyDiagramMessage=
"Diagram is empty.";this.items=[];this.annotations=[];this.highlightItem=this.cursorItem=null;this.highlightGravityRadius=40;this.selectedItems=[];this.hasSelectorCheckbox=0;this.selectCheckBoxLabel="Selected";this.selectionPathMode=1;this.templates=[];this.defaultTemplateName=null;this.hasButtons=0;this.buttons=[];this.onCursorRender=this.onHighlightRender=this.onItemRender=this.onMouseDblClick=this.onMouseClick=this.onButtonClick=this.onSelectionChanged=this.onSelectionChanging=this.onCursorChanged=
this.onCursorChanging=this.onHighlightChanged=this.onHighlightChanging=null;this.dotLevelShift=this.normalLevelShift=20;this.normalItemsInterval=this.lineLevelShift=10;this.dotItemsInterval=1;this.lineItemsInterval=2;this.cousinsIntervalMultiplier=5;this.itemTitleFirstFontColor="#ffffff";this.itemTitleSecondFontColor="#000080";this.minimizedItemShapeType=6;this.linesColor="#c0c0c0";this.linesWidth=1;this.linesType=0;this.highlightLinesColor="#ff0000";this.highlightLinesWidth=1;this.highlightLinesType=
0;this.showCallout=!0;this.calloutPlacementOffset=100;this.defaultCalloutTemplateName=null;this.calloutfillColor="#000000";this.calloutBorderColor=null;this.calloutCornerRadius=this.calloutOffset=4;this.calloutPointerWidth="10%";this.calloutLineWidth=1;this.calloutOpacity=0.2;this.leavesPlacementType=this.childrenPlacementType=2;this.maximumColumnsInMatrix=6;this.buttonsPanelSize=28;this.checkBoxPanelSize=this.groupTitlePanelSize=24;this.distance=3;this.scale=1;this.minimumScale=0.5;this.maximumScale=
2;this.showLabels=0;this.labelSize=new primitives.common.Size(80,24);this.labelOffset=1;this.labelOrientation=0;this.labelPlacement=1;this.labelFontSize="10px";this.labelFontFamily="Arial";this.labelColor="#000000";this.labelFontStyle=this.labelFontWeight="normal";this.enablePanning=!0;this.printPreviewPageSize=new primitives.common.Size(612,792);this.autoSizeMinimum=new primitives.common.Size(800,600);this.autoSizeMaximum=new primitives.common.Size(1024,768)};
primitives.orgdiagram.ConnectorAnnotationConfig=function(a,b){var c;this.annotationType=0;this.zOrderType=2;this.toItem=this.fromItem=null;this.connectorPlacementType=this.connectorShapeType=0;this.labelPlacementType=1;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.color="#000000";this.lineType=0;this.selectItems=!0;this.label=null;this.labelSize=new primitives.common.Size(60,30);switch(arguments.length){case 1:for(c in a)a.hasOwnProperty(c)&&(this[c]=a[c]);break;case 2:this.fromItem=
a,this.toItem=b}};primitives.orgdiagram.HighlightPathAnnotationConfig=function(a){var b;this.zOrderType=this.annotationType=2;this.items=[];this.lineWidth=2;this.color="#ff0000";this.lineType=0;this.opacity=1;this.showArrows=!0;this.selectItems=!1;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};
primitives.orgdiagram.ItemConfig=function(a,b,c,d,e){var f;this.context=this.image=this.description=this.title=this.parent=this.id=null;this.itemTitleColor="#4169e1";this.groupTitle=this.minimizedItemShapeType=null;this.groupTitleColor="#4169e1";this.isActive=this.isVisible=!0;this.rightAdvisersPlacementType=this.leftAdvisersPlacementType=this.directorsPlacementType=this.childrenPlacementType=this.adviserPlacementType=this.itemType=this.hasButtons=this.hasSelectorCheckbox=0;this.templateName=this.groupName=
null;this.showCallout=0;this.label=this.calloutTemplateName=null;this.showLabel=0;this.labelSize=null;this.labelOrientation=3;this.labelPlacement=0;switch(arguments.length){case 1:for(f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);break;case 5:this.id=a,this.parent=b,this.title=c,this.description=d,this.image=e}};
primitives.orgdiagram.ShapeAnnotationConfig=function(a){var b;this.annotationType=1;this.zOrderType=0;this.items=[];this.shapeType=0;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.selectItems=!1;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4;switch(arguments.length){case 1:if(null!==a)if(a instanceof Array)this.items=a;else if("object"==
typeof a)for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}};primitives.orgdiagram.EventArgs=function(){this.name=this.position=this.parentItem=this.context=this.oldContext=null;this.cancel=!1};primitives.orgdiagram.ConnectorBundle=function(){this.isVertical=!0;this.fromLevel=null;this.fromItems=[];this.toItems=[];this.toOffset=this.fromOffset=0};primitives.orgdiagram.LevelVisibility=function(a,b){this.level=a;this.currentvisibility=b};
primitives.orgdiagram.OrgItem=function(a){var b,c,d;this.id=null;this.isActive=this.isVisible=!0;this.hasVisibleChildren=!1;this.childrenPlacementType=this.adviserPlacementType=this.itemType=0;this.level=null;this.hideChildrenConnection=this.hideParentConnection=!1;this.childIndex=null;var e="id parent isVisible isActive itemType adviserPlacementType childrenPlacementType".split(" ");b=0;for(c=e.length;b<c;b+=1)d=e[b],a.hasOwnProperty(d)&&(this[d]=a[d])};
primitives.orgdiagram.Template=function(a,b){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null;null!=b&&(this.templateConfig=b,this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.common.ItemTemplate(a,b):new primitives.common.UserTemplate(a,b.itemTemplate,a.onItemRender),this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.common.HighlightTemplate(a,b):new primitives.common.UserTemplate(a,
b.highlightTemplate,a.onHighlightRender),this.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(a,b),this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.common.CursorTemplate(a,b):new primitives.common.UserTemplate(a,b.cursorTemplate,a.onCursorRender))};primitives.orgdiagram.TemplateParams=function(){this.template=null;this.hasGroupTitle=this.hasButtons=this.hasSelectorCheckbox=this.isActive=!1;this.buttons=[]};
primitives.orgdiagram.TreeItem=function(){this.visualAggregatorId=this.id=null;this.visualDepth=1;this.partners=[];this.visibility=1;this.actualItemType=null;this.relationDegree=this.gravity=this.connectorPlacement=0};
primitives.orgdiagram.TreeItemPosition=function(a){this.partnerConnectorOffset=0;this.levelPosition=this.level=null;this.rightPadding=this.leftPadding=this.offset=0;this.actualVisibility=1;this.contentPosition=this.actualPosition=this.actualSize=null;if(null!=a)for(var b in a)if(a.hasOwnProperty(b))switch(b){case "actualPosition":this.actualPosition=new primitives.common.Rect(a.actualPosition);break;default:this[b]=a[b]}};
primitives.orgdiagram.TreeItemPosition.prototype.setSize=function(a,b,c,d){var e;switch(this.actualVisibility){case 1:e=b.template.templateConfig;this.actualSize=new primitives.common.Size(e.itemSize);this.contentPosition=new primitives.common.Rect(0,0,this.actualSize.width,this.actualSize.height);a&&(this.actualSize.height+=e.cursorPadding.top+e.cursorPadding.bottom,this.actualSize.width+=e.cursorPadding.left+e.cursorPadding.right,this.contentPosition.x=e.cursorPadding.left,this.contentPosition.y=
e.cursorPadding.top);b.hasSelectorCheckbox&&(this.actualSize.height+=c.checkBoxPanelSize);b.hasButtons&&(this.actualSize.width+=c.buttonsPanelSize);b.hasGroupTitle&&(this.actualSize.width+=c.groupTitlePanelSize,this.contentPosition.x+=c.groupTitlePanelSize);break;case 2:e=b.template.templateConfig;this.actualSize=new primitives.common.Size(e.minimizedItemSize);break;case 3:case 4:this.actualSize=new primitives.common.Size}switch(d.orientationType){case 2:case 3:this.actualSize.invert()}};
primitives.orgdiagram.TreeItemPosition.prototype.setPosition=function(a,b){var c=0;switch(this.actualVisibility){case 1:switch(b.verticalAlignment){case 0:c=0;break;case 1:c=(a.depth-this.actualSize.height)/2;break;case 2:c=a.depth-this.actualSize.height}break;case 2:case 3:case 4:c=a.horizontalConnectorsDepth-this.actualSize.height/2}this.actualPosition=new primitives.common.Rect(this.offset,a.shift+c,this.actualSize.width,this.actualSize.height);this.actualPosition.validate()};
primitives.orgdiagram.TreeLevelConnectorStackSize=function(){this.childrenStackSize=this.parentsStackSize=0};primitives.orgdiagram.TreeLevelPosition=function(a){this.actualVisibility=this.currentvisibility=1;this.currentOffset=this.levelSpace=this.connectorShift=this.topConnectorShift=this.horizontalConnectorsDepth=this.nextLevelShift=this.depth=this.shift=0;this.labels=[];this.labelsRect=null;this.showLabels=!0;this.hasFixedLabels=!1;if(null!=a)for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])};
primitives.orgdiagram.TreeLevelPosition.prototype.setShift=function(a,b,c,d,e){this.shift=a;this.levelSpace=b;this.topConnectorShift=-b/2-c;this.connectorShift=this.depth+d+(e+1)*(b/2);return this.nextLevelShift=c+this.depth+d+b+e*b/2};primitives.orgdiagram.TreeLevelPosition.prototype.shiftDown=function(a){this.shift+=a};primitives.orgdiagram.TreeLevelPosition.prototype.toString=function(){return this.currentvisibility};
primitives.orgdiagram.AlignDiagramTask=function(a,b,c,d,e,f,g,h,i){function j(a,b){var c=new primitives.common.Size(w.printPreviewPageSize),d,f,e;c.scale(1/u.scale);switch(y.orientationType){case 2:case 3:c.invert()}d=0;f=c.width;n.loopMerged(this,function(a){return s[a].actualPosition.x},function(b){var e=new primitives.orgdiagram.TreeItemPosition(s[b]);a[b]=e;e.actualPosition.left()+d<f&&e.actualPosition.right()+d>f&&(d+=f-e.actualPosition.left()-d+r.normalItemsInterval/2);e.actualPosition.translate(d,
0);e.actualPosition.left()>f&&(f+=c.width)});d=0;e=c.height;n.loopLevels(this,function(f){var g=new primitives.orgdiagram.TreeLevelPosition(p[f]);g.shift+d<e&&g.shift+g.depth+d>e&&(d+=e-g.shift-d+r.normalLevelShift/2);g.shiftDown(d);n.loopLevelItems(this,f,function(b){a[b].actualPosition.translate(0,d)});g.shift>e&&(e+=c.height);b.push(g)});return new primitives.common.Size(f+1,e+1)}var k={},l=[],m=null,n,q,s,p,r,y,w,t,u;return{process:function(){var z=new primitives.common.Size(h.getContentSize()),
v=new primitives.common.Size(f.getOptimalPanelSize());n=g.getTreeLevels();q=g.getActiveTreeLevels();s=h.getItemsPositions();p=h.getTreeLevelsPositions();r=b.getOptions();y=a.getOptions();w=e.getOptions();t=c.getOptions();u=d.getOptions();switch(y.orientationType){case 2:case 3:v.invert()}v.scale(1/u.scale);m=v;k=s;l=p;switch(r.pageFitMode){case 4:k={};l=[];m=j(k,l);break;case 5:m=new primitives.common.Size(z);break;default:m=new primitives.common.Size(z);if(z.width<v.width){k={};var x=z.width,A=v.width,
B;if(i)B=(A-x)/2;else switch(t.horizontalAlignment){case 1:B=0;break;case 2:B=A-x;break;case 0:B=(A-x)/2}var x=k,D;for(D in s)s.hasOwnProperty(D)&&(A=new primitives.orgdiagram.TreeItemPosition(s[D]),A.actualPosition.translate(B,0),x[D]=A);m.width=v.width}z.height<v.height&&(m.height=v.height)}switch(y.orientationType){case 2:case 3:m.invert()}return!0},getTreeLevelsPositions:function(){return l},getItemPosition:function(a){return k[a]},getItemsPositions:function(){return k},getContentSize:function(){return m},
getTreeItemForMousePosition:function(a,b,c){var d=null,f=null,e=null,g,h=u.scale,a=a/h,b=b/h;q.loopLevels(this,function(a){var c=l[a];if(b>c.shift+c.topConnectorShift&&b<=c.shift+c.connectorShift)return f=a,!0;g=Math.min(Math.abs(b-(c.shift+c.topConnectorShift)),Math.abs(b-(c.shift+c.connectorShift)));if(null==e||e>g)e=g,f=a});null!=f&&(d=q.binarySearch(this,f,function(c){c=k[c];switch(c.actualVisibility){case 1:if(c.actualPosition.contains(a,b))return 0;case 2:case 3:return a-c.actualPosition.horizontalCenter();
case 4:throw"Clickable items collection should contain only visible items.";}}));if(null!=d)switch(h=k[d],h.actualVisibility){case 1:break;default:if(Math.abs(a-h.actualPosition.horizontalCenter())>Math.max(c,h.actualPosition.width/2)||Math.abs(b-h.actualPosition.verticalCenter())>Math.max(c,h.actualPosition.height/2))d=null}return d},getNextLevelTreeItem:function(a,b){var c=k[a].actualPosition.horizontalCenter(),d=a,f=null,e;q.loopLevelsFromItem(this,a,b,function(a){q.loopLevelItems(this,a,function(a){var b=
k[a];if(1==b.actualVisibility)if(e=Math.abs(c-b.actualPosition.horizontalCenter()),e<f||null==f)f=e,d=a;else return!0});if(null!=f)return!0});return d},getNextTreeItem:function(a,b){var c=a.id,d;q.loopFromItem(this,a,b,function(a){d=s[a];if(1==d.actualVisibility)return c=a,!0});return c}}};
primitives.orgdiagram.ApplyLayoutChangesTask=function(a,b,c,d,e,f,g){var h=null,i,j;return{process:function(){var k=b(),l=a(),m=f.getOptions().scale;i=d.getOptions();j=c.getOptions();var n=new primitives.common.Size(g.getContentSize());n.scale(1*m);k.mousePanel.css(n.getCSS());var q=new primitives.common.Size(g.getContentSize());k.placeholder.css(q.getCSS());l.resize("placeholder",q.width,q.height);switch(i.pageFitMode){case 5:h=new primitives.common.Size(n.width+25,n.height+25);h.cropBySize(j.autoSizeMaximum);
h.addSize(j.autoSizeMinimum);k.element.css({width:h.width+"px",height:h.height+"px"});break;case 4:h=new primitives.common.Size(n.width+25,n.height+25);k.element.css({width:h.width+"px",height:h.height+"px"});break;default:h=new primitives.common.Size(e.getScrollPanelSize())}l=k.element.offset();k.scrollPanel.css({top:"0px",left:"0px",width:h.width+"px",height:h.height+"px","margin-bottom":"0px","margin-right":"0px","margin-top":-l.top+Math.floor(l.top)+"px","margin-left":-l.left+Math.floor(l.left)+
"px"});m="scale("+m+","+m+")";k.placeholder.css({"transform-origin":"0 0",transform:m,"-ms-transform":m,"-webkit-transform":m,"-o-transform":m,"-moz-transform":m});return!0},getOptimalPanelSize:function(){return new primitives.common.Size(h.width-25,h.height-25)}}};
primitives.orgdiagram.CenterOnCursorTask=function(a,b,c,d,e,f,g){function h(a){var b=!1;j.transformRect(a.x,a.y,a.width,a.height,!0,this,function(a,c,d,f){b=new primitives.common.Rect(a,c,d,f)});return b}var i=null,j;return{process:function(){var k;k=a();var l=d.getCursorTreeItem(),m=e.getItemPosition(l),l=e.getContentSize(),n;n=g.getOptions().scale;i=c.getPlaceholderOffset();k.forceCenterOnCursor&&(j=f.getTransform(),null!=m&&(k=h(m.actualPosition),k.scale(n),l.scale(n),n=b.getScrollPanelSize(),
i=new primitives.common.Point(Math.max(Math.min(k.horizontalCenter()-n.width/2,l.width-n.width),0),Math.max(Math.min(k.verticalCenter()-n.height/2,l.height-n.height),0))));return!0},getPlaceholderOffset:function(){return i}}};
primitives.orgdiagram.CreateTransformTask=function(a,b){var c=null;return{process:function(){var d=a.getOptions(),e=new primitives.common.Size(b.getContentSize());c=new primitives.common.Transform;c.setOrientation(d.orientationType);c.size=new primitives.common.Size(e);return!0},getTransform:function(){return c},getTreeItemForMousePosition:function(a,e,f){var g=null;c.transformPoint(a,e,!1,this,function(a,c){g=b.getTreeItemForMousePosition(a,c,f)});return g},description:"Create oordiante system tranfromation object."}};
primitives.orgdiagram.CurrentControlSizeTask=function(a,b,c){var d={scrollPanelSize:null},e={},f=new primitives.common.ObjectReader({scrollPanelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!0),height:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var b={isChanged:!1,hash:e},h=a(),h={scrollPanelSize:new primitives.common.Size(h.element.outerWidth(),h.element.outerHeight())},i=!1,j=c.getOptions();d=f.read(d,h,"layout",
b);switch(j.pageFitMode){case 1:case 2:case 3:i=b.isChanged}return i},getScrollPanelSize:function(){return d.scrollPanelSize},getOptimalPanelSize:function(){return new primitives.common.Size(d.scrollPanelSize.width-25,d.scrollPanelSize.height-25)}}};
primitives.orgdiagram.CurrentScrollPositionTask=function(a){var b={placeholderOffset:null},c={},d=new primitives.common.ObjectReader({placeholderOffset:new primitives.common.ObjectReader({x:new primitives.common.ValueReader(["number"],!0),y:new primitives.common.ValueReader(["number"],!0)},!0)});return{process:function(){var e={isChanged:!1,hash:c},f=a(),f={placeholderOffset:new primitives.common.Point(f.scrollPanel.scrollLeft(),f.scrollPanel.scrollTop())};b=d.read(b,f,"layout",e);return e.isChanged},
getPlaceholderOffset:function(){return b.placeholderOffset}}};
primitives.orgdiagram.BackgroundAnnotationOptionTask=function(a,b){var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),includeChildren:new primitives.common.ValueReader(["boolean"],!1,b.includeChildren),zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),
opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems)}),!1);return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getAnnotations(4,null),"annotations",b);return b.isChanged},
getAnnotations:function(){return c}}};
primitives.orgdiagram.ConnectorAnnotationOptionTask=function(a,b,c){var d=[],e={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),fromItem:new primitives.common.ValueReader(["string","number"],!0),toItem:new primitives.common.ValueReader(["string","number"],!0),connectorShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.connectorShapeType),connectorPlacementType:new primitives.common.EnumerationReader(primitives.common.ConnectorPlacementType,
!1,b.connectorPlacementType),labelPlacementType:new primitives.common.EnumerationReader(primitives.common.ConnectorLabelPlacementType,!1,b.labelPlacementType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],
!1,b.lineWidth),color:new primitives.common.ValueReader(["string"],!1,b.color),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},
!1,b.labelSize)}),!1);return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getAnnotations(0,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.HighlightPathAnnotationOptionTask=function(a,b,c){var d=[],e={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),color:new primitives.common.ValueReader(["string"],!1,b.color),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,
!1,b.lineType),items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!1),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),showArrows:new primitives.common.ValueReader(["boolean"],!1,b.showArrows)},!1));return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getAnnotations(2,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.ShapeAnnotationOptionTask=function(a,b,c){var d=[],e={},f=new primitives.common.ArrayReader(new primitives.common.ObjectReader({zOrderType:new primitives.common.EnumerationReader(primitives.common.ZOrderType,!1,b.zOrderType),items:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0),shapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!1,b.shapeType),offset:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],
!1,b.offset.left),top:new primitives.common.ValueReader(["number"],!1,b.offset.top),right:new primitives.common.ValueReader(["number"],!1,b.offset.right),bottom:new primitives.common.ValueReader(["number"],!1,b.offset.bottom)},!1,b.offset),lineWidth:new primitives.common.ValueReader(["number"],!1,b.lineWidth),cornerRadius:new primitives.common.ValueReader(["string"],!1,b.cornerRadius),opacity:new primitives.common.ValueReader(["number"],!1,b.opacity),borderColor:new primitives.common.ValueReader(["string"],
!1,b.borderColor),fillColor:new primitives.common.ValueReader(["string"],!1,b.fillColor),lineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.lineType),selectItems:new primitives.common.ValueReader(["boolean"],!1,b.selectItems),label:new primitives.common.ValueReader(["string"],!1,b.label),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},
!1,b.labelSize),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset)},!1));return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getAnnotations(1,c),"annotations",b);return b.isChanged},getAnnotations:function(){return d}}};
primitives.orgdiagram.SplitAnnotationsOptionTask=function(a){var b={};return{process:function(){var c=a.getOptions().annotations,d,e,f,g,h,i={};if(primitives.common.isArray(c)){d=0;for(e=c.length;d<e;d+=1){f=c[d];g=f.annotationType;switch(g){case 1:case 0:case 2:switch(f.zOrderType){case 1:h=1;break;default:h=2}break;default:h=null}null!=g&&(g=1E3*g+(h||0),i.hasOwnProperty(g)||(i[g]=[]),i[g].push(f))}}b=i;return!0},getAnnotations:function(a,d){return b[1E3*a+(d||0)]}}};
primitives.orgdiagram.CursorItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({cursorItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getCursorItem:function(){return c.cursorItem},hasCursorEnabled:function(){switch(c.navigationMode){case 0:case 1:return!0}return!1},
description:"Checks currenct cursor item option."}};primitives.orgdiagram.CursorSelectionPathModeOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,!1,b.selectionPathMode)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getSelectionPathMode:function(){return c.selectionPathMode},description:"Checks cursor selection path option."}};
primitives.orgdiagram.HighlightItemOptionTask=function(a,b){var c={},d=new primitives.common.ObjectReader({highlightItem:new primitives.common.ValueReader(["string","number"],!0),navigationMode:new primitives.common.EnumerationReader(primitives.common.NavigationMode,!1,b.navigationMode),highlightGravityRadius:new primitives.common.ValueReader(["number"],!1,b.highlightGravityRadius)});return{process:function(){var b={isChanged:!1};c=d.read(c,a.getOptions(),"options",b);return b.isChanged},getHighlightItem:function(){return c.highlightItem},
hasHighlightEnabled:function(){switch(c.navigationMode){case 0:case 3:return!0}return!1},getGravityRadius:function(){return c.highlightGravityRadius},description:"Checks highlight item option."}};
primitives.orgdiagram.SelectedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({selectedItems:new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0)});return{process:function(){var e={isChanged:!1,hash:c},f=a.getOptions();b=d.read(b,f,"options",e);return e.isChanged},getSelectedItems:function(){return b.selectedItems},description:"Checks user selected items option."}};
primitives.orgdiagram.CalloutOptionTask=function(a,b,c){var d={},e={},f=new primitives.common.ObjectReader({showCallout:new primitives.common.ValueReader(["boolean"],!1,b.showCallout),calloutPlacementOffset:new primitives.common.ValueReader(["number"],!1,b.calloutPlacementOffset),orientationType:new primitives.common.EnumerationReader(primitives.common.OrientationType,!1,b.orientationType),defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultCalloutTemplateName:new primitives.common.ValueReader(["string"],
!0),calloutfillColor:new primitives.common.ValueReader(["string"],!1,b.calloutfillColor),calloutBorderColor:new primitives.common.ValueReader(["string"],!0),calloutOffset:new primitives.common.ValueReader(["number"],!1,b.calloutOffset),calloutCornerRadius:new primitives.common.ValueReader(["string"],!1,b.calloutCornerRadius),calloutPointerWidth:new primitives.common.ValueReader(["string"],!1,b.calloutPointerWidth),calloutLineWidth:new primitives.common.ValueReader(["number"],!1,b.calloutLineWidth),
calloutOpacity:new primitives.common.ValueReader(["number"],!1,b.calloutOpacity),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),showCallout:new primitives.common.ValueReader(["boolean"],!1,c.showCallout),calloutTemplateName:new primitives.common.ValueReader(["string"],!0),templateName:new primitives.common.ValueReader(["string"],!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,
a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return d},getItemOptions:function(a){return e["options-items"][a]},description:"Checks item callout options."}};
primitives.orgdiagram.ConnectorsOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),showExtraArrows:new primitives.common.ValueReader(["boolean"],!1,b.showExtraArrows),extraArrowsMinimumSpace:new primitives.common.ValueReader(["number"],!1,b.extraArrowsMinimumSpace),connectorType:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("connectorType")?
b.connectorType:0),showNeigboursConnectorsHighlighted:new primitives.common.EnumerationReader(primitives.common.ConnectorType,!1,b.hasOwnProperty("showNeigboursConnectorsHighlighted")?b.showNeigboursConnectorsHighlighted:!1),elbowType:new primitives.common.EnumerationReader(primitives.common.ElbowType,!1,b.elbowType),bevelSize:new primitives.common.ValueReader(["number"],!1,b.bevelSize),elbowDotSize:new primitives.common.ValueReader(["number"],!1,b.elbowDotSize),linesColor:new primitives.common.ValueReader(["string"],
!1,b.linesColor),linesWidth:new primitives.common.ValueReader(["number"],!1,b.linesWidth),linesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.linesType),highlightLinesColor:new primitives.common.ValueReader(["string"],!1,b.highlightLinesColor),highlightLinesWidth:new primitives.common.ValueReader(["number"],!1,b.highlightLinesWidth),highlightLinesType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,b.highlightLinesType)});return{process:function(){var b=
{isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks connector lines drawing options."}};
primitives.orgdiagram.ItemsOptionTask=function(a,b){var c={},d={},e={},f=new primitives.common.ObjectReader({items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),parent:new primitives.common.ValueReader(["string","number"],!0),itemType:new primitives.common.EnumerationReader(primitives.orgdiagram.ItemType,!1,b.itemType),adviserPlacementType:new primitives.common.EnumerationReader(primitives.common.AdviserPlacementType,
!1,b.adviserPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),isVisible:new primitives.common.ValueReader(["boolean"],!1,b.isVisible),isActive:new primitives.common.ValueReader(["boolean"],!1,b.isActive)}),!0,"id",!0)});return{process:function(){var b={isChanged:!1,hash:d,sourceHash:e};c=f.read(c,a.getOptions(),"options",b);return b.isChanged},getItems:function(){return c.items},getConfig:function(a){return e["options-items"][a]},
description:"Checks items configuration options effecting their placement in layout."}};
primitives.orgdiagram.ItemsSizesOptionTask=function(a,b,c,d){var e={},f={},g=new primitives.common.ObjectReader({defaultTemplateName:new primitives.common.ValueReader(["string"],!0),defaultLabelAnnotationTemplate:new primitives.common.ValueReader(["string"],!0),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.hasButtons),buttonsPanelSize:new primitives.common.ValueReader(["number"],
!1,b.buttonsPanelSize),groupTitlePanelSize:new primitives.common.ValueReader(["number"],!1,b.groupTitlePanelSize),checkBoxPanelSize:new primitives.common.ValueReader(["number"],!1,b.checkBoxPanelSize),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],
!1,!1),tooltip:new primitives.common.ValueReader(["string"],!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.size.width),height:new primitives.common.ValueReader(["number"],!1,d.size.height)},!1,d.size)}),!0,"name"),pageFitMode:new primitives.common.EnumerationReader(primitives.common.PageFitMode,!1,b.pageFitMode),minimalVisibility:new primitives.common.EnumerationReader(primitives.common.Visibility,!1,b.minimalVisibility),selectionPathMode:new primitives.common.EnumerationReader(primitives.common.SelectionPathMode,
!1,b.selectionPathMode),autoSizeMinimum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.width),height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMinimum.height)},!1,b.autoSizeMinimum),autoSizeMaximum:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.width),height:new primitives.common.ValueReader(["number"],!1,b.autoSizeMaximum.height)},!1,b.autoSizeMaximum),scale:new primitives.common.ValueReader(["number"],
!1,b.scale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),normalLevelShift:new primitives.common.ValueReader(["number"],!1,b.normalLevelShift),dotLevelShift:new primitives.common.ValueReader(["number"],!1,b.dotLevelShift),lineLevelShift:new primitives.common.ValueReader(["number"],!1,b.lineLevelShift),normalItemsInterval:new primitives.common.ValueReader(["number"],!1,b.normalItemsInterval),
dotItemsInterval:new primitives.common.ValueReader(["number"],!1,b.dotItemsInterval),lineItemsInterval:new primitives.common.ValueReader(["number"],!1,b.lineItemsInterval),cousinsIntervalMultiplier:new primitives.common.ValueReader(["number"],!1,b.cousinsIntervalMultiplier),verticalAlignment:new primitives.common.EnumerationReader(primitives.common.VerticalAlignmentType,!1,b.verticalAlignment),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string",
"number"],!0),groupTitle:new primitives.common.ValueReader(["string","number"],!0),isVisible:new primitives.common.ValueReader(["boolean","number"],!1,c.isVisible),isActive:new primitives.common.ValueReader(["boolean","number"],!1,c.isActive),hasSelectorCheckbox:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.hasSelectorCheckbox),hasButtons:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.hasButtons),templateName:new primitives.common.ValueReader(["string"],
!0)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:f};e=g.read(e,a.getOptions(),"options",b);return b.isChanged},getItemOptions:function(a){return f["options-items"][a]},getOptions:function(){return e},description:"Checks items size options."}};
primitives.orgdiagram.LabelsOptionTask=function(a,b,c){var d={},e={},f=new primitives.common.ObjectReader({showLabels:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,b.showLabels),labelOffset:new primitives.common.ValueReader(["number"],!1,b.labelOffset),labelFontSize:new primitives.common.ValueReader(["string"],!1,b.labelFontSize),labelFontFamily:new primitives.common.ValueReader(["string"],!1,b.labelFontFamily),labelFontStyle:new primitives.common.ValueReader(["string"],!1,
b.labelFontStyle),labelFontWeight:new primitives.common.ValueReader(["string"],!1,b.labelFontWeight),labelColor:new primitives.common.ValueReader(["string"],!1,b.labelColor),labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.labelSize.width),height:new primitives.common.ValueReader(["number"],!1,b.labelSize.height)},!1,b.labelSize),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,b.labelOrientation),
labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,b.labelPlacement),arrowsDirection:new primitives.common.EnumerationReader(primitives.common.GroupByType,!1,b.arrowsDirection),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),label:new primitives.common.ValueReader(["string","number"],!0),showLabel:new primitives.common.EnumerationReader(primitives.common.Enabled,!1,c.showLabel),
labelSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,0),height:new primitives.common.ValueReader(["number"],!1,0)},!0),labelOrientation:new primitives.common.EnumerationReader(primitives.text.TextOrientationType,!1,c.labelOrientation),labelPlacement:new primitives.common.EnumerationReader(primitives.common.PlacementType,!1,c.labelPlacement)}),!0,"id")});return{process:function(){var b={isChanged:!1,hash:e};d=f.read(d,a.getOptions(),"options",b);return b.isChanged},
getItemOptions:function(a){return e["options-items"][a]},getOptions:function(){return d},description:"Checks items labels options."}};
primitives.orgdiagram.MinimizedItemsOptionTask=function(a){var b={},c={},d=new primitives.common.ObjectReader({minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),items:new primitives.common.ArrayReader(new primitives.common.ObjectReader({id:new primitives.common.ValueReader(["string","number"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),itemTitleColor:new primitives.common.ValueReader(["string"],!0)}),
!0,"id")});return{process:function(){var e={isChanged:!1,hash:c};b=d.read(b,a.getOptions(),"options",e);return e.isChanged},getItemOptions:function(a){return c["options-items"][a]},getOptions:function(){return b},description:"Checks minimized items drawing options."}};primitives.orgdiagram.OptionsTask=function(a){return{process:function(){return!0},getOptions:a,description:"Raw options."}};
primitives.orgdiagram.OrientationOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({orientationType:new primitives.common.EnumerationReader(primitives.common.OrientationType,!1,b.orientationType)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks diagram orientation options."}};
primitives.orgdiagram.PrintPreviewOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({pageFitMode:new primitives.common.EnumerationReader(primitives.common.PageFitMode,!1,b.pageFitMode),printPreviewPageSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,b.printPreviewPageSize.width),height:new primitives.common.ValueReader(["number"],!1,b.printPreviewPageSize.height)},!1,b.printPreviewPageSize)});return{process:function(){var b={isChanged:!1,
hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks options of print preview mode."}};
primitives.orgdiagram.ScaleOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({scale:new primitives.common.ValueReader(["number"],!1,b.scale),minimumScale:new primitives.common.ValueReader(["number"],!1,b.minimumScale),maximumScale:new primitives.common.ValueReader(["number"],!1,b.maximumScale)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks control scale options."}};
primitives.orgdiagram.TemplatesOptionTask=function(a,b,c,d){var e={},f={},g=new primitives.common.ObjectReader({itemTitleFirstFontColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleFirstFontColor),itemTitleSecondFontColor:new primitives.common.ValueReader(["string"],!1,b.itemTitleSecondFontColor),selectCheckBoxLabel:new primitives.common.ValueReader(["string"],!1,b.selectCheckBoxLabel),onItemRender:new primitives.common.FunctionReader,onCursorRender:new primitives.common.FunctionReader,
onHighlightRender:new primitives.common.FunctionReader,templates:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],!0),isActive:new primitives.common.ValueReader(["boolean"],!1,d.isActive),itemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.itemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.itemSize.height)},!1,d.itemSize),itemBorderWidth:new primitives.common.ValueReader(["number"],
!1,d.itemBorderWidth),itemTemplate:new primitives.common.ValueReader(["string"],!0),minimizedItemShapeType:new primitives.common.EnumerationReader(primitives.common.ShapeType,!0),minimizedItemSize:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.width),height:new primitives.common.ValueReader(["number"],!1,d.minimizedItemSize.height)},!1,d.minimizedItemSize),minimizedItemCornerRadius:new primitives.common.ValueReader(["number"],!0),minimizedItemLineWidth:new primitives.common.ValueReader(["number"],
!1,d.minimizedItemLineWidth),minimizedItemBorderColor:new primitives.common.ValueReader(["string"],!0),minimizedItemLineType:new primitives.common.EnumerationReader(primitives.common.LineType,!1,d.minimizedItemLineType),minimizedItemFillColor:new primitives.common.ValueReader(["string"],!0),minimizedItemOpacity:new primitives.common.ValueReader(["number"],!1,d.minimizedItemOpacity),highlightPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.left),
top:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.right),bottom:new primitives.common.ValueReader(["number"],!1,d.highlightPadding.bottom)},!1,d.highlightPadding),highlightBorderWidth:new primitives.common.ValueReader(["number"],!1,d.highlightBorderWidth),highlightTemplate:new primitives.common.ValueReader(["string"],!0),cursorPadding:new primitives.common.ObjectReader({left:new primitives.common.ValueReader(["number"],
!1,d.cursorPadding.left),top:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.top),right:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.right),bottom:new primitives.common.ValueReader(["number"],!1,d.cursorPadding.bottom)},!1,d.cursorPadding),cursorBorderWidth:new primitives.common.ValueReader(["number"],!1,d.cursorBorderWidth),cursorTemplate:new primitives.common.ValueReader(["string"],!0),buttons:new primitives.common.ArrayReader(new primitives.common.ObjectReader({name:new primitives.common.ValueReader(["string"],
!0),icon:new primitives.common.ValueReader(["string"],!0),text:new primitives.common.ValueReader(["boolean"],!1,!1),tooltip:new primitives.common.ValueReader(["string"],!0),size:new primitives.common.ObjectReader({width:new primitives.common.ValueReader(["number"],!1,c.size.width),height:new primitives.common.ValueReader(["number"],!1,c.size.height)},!1,c.size)}),!0,"name")}),!0,"name")});return{process:function(){var b={isChanged:!1,hash:f};e=g.read(e,a.getOptions(),"options",b);return b.isChanged},
getOptions:function(){return e},description:"Checks items template options."}};
primitives.orgdiagram.VisualTreeOptionTask=function(a,b){var c={},d={},e=new primitives.common.ObjectReader({leavesPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.leavesPlacementType),childrenPlacementType:new primitives.common.EnumerationReader(primitives.common.ChildrenPlacementType,!1,b.childrenPlacementType),maximumColumnsInMatrix:new primitives.common.ValueReader(["number"],!1,b.maximumColumnsInMatrix),horizontalAlignment:new primitives.common.EnumerationReader(primitives.common.HorizontalAlignmentType,
!1,b.horizontalAlignment)});return{process:function(){var b={isChanged:!1,hash:d};c=e.read(c,a.getOptions(),"options",b);return b.isChanged},getOptions:function(){return c},description:"Checks items layout options."}};
primitives.orgdiagram.CollinearVectorBundle=function(){var a=new primitives.common.Rect,b=[],c=[];return{addVector:function(d,e){b.push(d);c.push(e);a.addRect(d.from.x,d.from.y);a.addRect(d.to.x,d.to.y)},resolve:function(){if(1==b.length)c[0](0,1,1);else{var d=primitives.common.pile(),e,f,g;if(a.width>a.height){e=0;for(f=b.length;e<f;e+=1)g=b[e],d.add(g.from.x,g.to.x,c[e])}else{e=0;for(f=b.length;e<f;e+=1)g=b[e],d.add(g.from.y,g.to.y,c[e])}d.resolve(this,function(a,b,c,d,f,e){c(d,f,e)})}}}};
primitives.orgdiagram.ConnectorAnnotationOffsetResolver=function(){var a={};return{getOffset:function(b,c){var d=b.getLineKey();a.hasOwnProperty(d)||(a[d]=new primitives.orgdiagram.CollinearVectorBundle);a[d].addVector(b,c)},resolve:function(){for(var b in a)a.hasOwnProperty(b)&&a[b].resolve()}}};
primitives.orgdiagram.DrawBackgroundAnnotationTask=function(a,b,c,d,e,f,g){function h(a,b,c){var d,e,g,h,r,y,w,t,u,z,v;d=0;for(e=a.length;d<e;d+=1)if(v=a[d],null!=v.items&&0<v.items.length){r=new primitives.common.Perimeter(i);r.transform=j;y=new primitives.orgdiagram.BackgroundAnnotationConfig;u=["opacity","lineWidth","borderColor","fillColor","lineType"];g=0;for(h=u.length;g<h;g+=1)z=u[g],r[z]=v.hasOwnProperty(z)?v[z]:y[z];i.activate("placeholder",2);w=[];t={};if(v.includeChildren){g=0;for(h=v.items.length;g<
h;g+=1)y=v.items[g],u=f.getItemPosition(y),null!=u&&(t[y]=!0,w.push(y),c.loopChildren(this,y,function(a){t[a]||(t[a]=!0,w.push(a))}))}else w=v.items;v=b.getMergedPerimeters(w);for(g=0;g<v.length;g+=1)r.draw(v[g])}}var i,j;return{process:function(){var c=d.getAnnotations(),f,m;i=a();i.reset("placeholder",2);0<c.length&&(j=b.getTransform(),f=g.getBackgroundManager(),m=e.getNavigationFamily(),h(c,f,m));return!1}}};
primitives.orgdiagram.DrawConnectorAnnotationTask=function(a,b,c,d,e,f,g,h){function i(a,b){var c,d,f,e,g,i,u,z,v=new primitives.common.PolylinesBuffer,x=primitives.orgdiagram.ConnectorAnnotationOffsetResolver(),A=0;switch(h){case 1:j.activate("placeholder",4);break;case 2:j.activate("placeholder",14)}c=0;for(d=a.length;c<d;c+=1)u=a[c],A=Math.max(A,u.lineWidth);c=0;for(d=a.length;c<d;c+=1)if(u=a[c],null!=u.fromItem&&null!=u.toItem&&(f=b(u.fromItem),e=b(u.toItem),null!=f&&null!=e)){f=f.actualPosition;
g=e.actualPosition;switch(u.connectorPlacementType){case 0:i=new primitives.common.ConnectorOffbeat;break;case 1:i=new primitives.common.ConnectorStraight}var B;k.transformRect(0,0,u.labelSize.width,u.labelSize.height,!1,this,function(a,b,c,d){B=new primitives.common.Size(c,d)});var D=null;k.transformRect(0,0,m.width,m.height,!1,this,function(a,b,c,d){D=new primitives.common.Size(c,d)});e=new primitives.common.PaletteItem({lineColor:u.color,lineWidth:u.lineWidth,lineType:u.lineType});var E=!primitives.common.isNullOrEmpty(u.label);
f=(new primitives.common.Rect(f)).offset(u.offset);g=(new primitives.common.Rect(g)).offset(u.offset);i.draw(v,e,f,g,3*u.lineWidth,6*A,B,D,u.connectorShapeType,4,u.labelPlacementType,E,x,function(a){E&&null!=a&&(k.transformRect(a.x,a.y,a.width,a.height,!0,this,function(b,c,d,f){a=new primitives.common.Rect(b,c,d,f)}),z=new primitives.common.RenderEventArgs,z.context=u,j.template(a.x,a.y,0,0,0,0,a.width,a.height,l.template(),l.getHashCode(),l.render,z,null))})}x.resolve();v.transform(k,!0);j.polylinesBuffer(v)}
var j,k,l,m;return{process:function(){j=a();k=b.getTransform();d.getOptions();l=g.getTemplate();m=new primitives.common.Size(f.getContentSize());switch(h){case 1:j.reset("placeholder",4);break;case 2:j.reset("placeholder",14)}i(e.getAnnotations(),f.getItemPosition);return!1}}};
primitives.orgdiagram.DrawConnectorsTask=function(a,b,c,d,e){return{process:function(){var f=a(),g=b.getGraph(),h=c.getOptions(),i=e.getPaletteManager();f.reset("placeholder",6);f.activate("placeholder",6);var j=new primitives.common.PolylinesBuffer,k=Math.round(h.elbowDotSize/2),l={},m={};g.loopNodes(this,null,function(a){g.loopNodeEdges(this,a,function(b,c){if(!l.hasOwnProperty(b)){var f=null;1>=c.fromOffset?f=i.getPalette(1):(i.selectPalette(c.fromOffset),f=i.getPalette(0));var e=j.getPolyline(f);
if(d&&null!=c.dotId&&0!=h.elbowType&&!m.hasOwnProperty(c.dotId)){var f=j.getPolyline(e.arrowPaletteItem),g=c.dotId==c.from?c.polyline.getStartPoint():c.polyline.getEndPoint();f.addSegment(new primitives.common.DotSegment(g.x-k,g.y-k,2*k,2*k,k));m[c.dotId]=!0}f=null;null!=c.parentsArrowId&&1==h.arrowsDirection?f=c.parentsArrowId:null!=c.childrenArrowId&&2==h.arrowsDirection&&(f=c.childrenArrowId);null==f?(f=c.polyline.clone(),c.hasMiddle&&0!=h.arrowsDirection&&(g=!0,g=c.from==c.middleParent?2==h.arrowsDirection:
1==h.arrowsDirection,f.addOffsetArrow(g,h.linesWidth,0.4,h.extraArrowsMinimumSpace,function(a){a.mergeTo(j.getPolyline(e.arrowPaletteItem))})),c.from==a?f.mergeTo(e):e.addInverted(f)):(f==c.to?c.polyline.clone().mergeTo(e):e.addInverted(c.polyline.clone()),e.addArrow(h.linesWidth,function(a){a.mergeTo(j.getPolyline(a.paletteItem))}))}});l[a]=!0});f.polylinesBuffer(j);return!1}}};
primitives.orgdiagram.DrawCursorTask=function(a,b,c,d,e,f,g,h){function i(a){var b;j.activate("placeholder",11);var c=e.getItemPosition(a),g=c.actualPosition,i=new primitives.common.Rect(c.contentPosition),p=f.getTemplateParams(a).template,r=p.templateConfig,c=r.cursorPadding;i.offset(c.left,c.top,c.right,c.bottom);b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=!0;b.isSelected=h.isSelected(a);b.templateName=r.name;k.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,
c,d,f){j.template(a,c,d,f,i.x,i.y,i.width,i.height,p.cursorTemplate.template(),p.cursorTemplate.getHashCode(),p.cursorTemplate.render,b,{"border-width":r.cursorBorderWidth})})}var j,k;return{process:function(){var c=g.getCursorTreeItem();j=a();j.reset("placeholder",11);null!=c&&(k=b.getTransform(),i(c));return!1}}};
primitives.orgdiagram.DrawHighlightAnnotationTask=function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){var b,c,k,n,x,A,B=!0,D,E=i.getItemPosition(a),C=E.actualPosition;switch(E.actualVisibility){case 2:case 3:case 1:b=g.getItemOptions(a);switch(b.showCallout){case 2:B=!1;break;case 1:B=!1;break;default:B=r.showCallout}B?(q.activate("placeholder",12),s.transformRect(C.x,C.y,C.width,C.height,!0,this,function(g,s,C,F){var s=new primitives.common.Rect(g,s,C,F),g=new primitives.common.Point(s.horizontalCenter(),
s.verticalCenter()),C=e.getOptions().scale,F=new primitives.common.Point(j.getPlaceholderOffset()),B=i.getContentSize(),N=d.getOptimalPanelSize();F.scale(1/C);N.scale(1/C);C=new primitives.common.Rect(F.x,F.y,Math.min(N.width,B.width),Math.min(N.height,B.height));if(1!=E.actualVisibility||!C.overlaps(s)){x=!primitives.common.isNullOrEmpty(b.calloutTemplateName)?b.calloutTemplateName:!primitives.common.isNullOrEmpty(b.templateName)?b.templateName:!primitives.common.isNullOrEmpty(r.defaultCalloutTemplateName)?
r.defaultCalloutTemplateName:r.defaultTemplateName;A=h.getTemplate(x,h.DefaultWidgetTemplateName);s=A.templateConfig.itemSize;F=new primitives.common.Rect(g.x,g.y,s.width,s.height);switch(r.orientationType){case 0:case 1:F.y-=s.height/4;F.x=g.x<C.horizontalCenter()?F.x+r.calloutPlacementOffset:F.x-(r.calloutPlacementOffset+s.width);break;default:F.x-=s.width/4,F.y=g.y<C.verticalCenter()?F.y+r.calloutPlacementOffset:F.y-(r.calloutPlacementOffset+s.height)}F.x<C.x?F.x=C.x+5:F.right()>C.right()&&(F.x-=
F.right()-C.right()+5);F.y<C.y?F.y=C.y+5:F.bottom()>C.bottom()&&(F.y-=F.bottom()-C.bottom()+5);k=F;c=new primitives.common.Rect(k);c.addRect(g.x,g.y);c.offset(50);D=c.getCSS();D.display="inherit";D.visibility="inherit";y.calloutPlaceholder.css(D);g.x-=c.x;g.y-=c.y;k.x-=c.x;k.y-=c.y;n=new primitives.common.RenderEventArgs;n.context=f.getConfig(a);n.isCursor=l.getCursorTreeItem()==a;n.isSelected=m.isSelected(a);n.templateName=A.templateConfig.name;q.resize("calloutplaceholder",c.width,c.height);q.activate("calloutplaceholder",
15);q.template(k.x,k.y,k.width,k.height,0,0,k.width,k.height,A.itemTemplate.template(),A.itemTemplate.getHashCode(),A.itemTemplate.render,n,null);p.pointerPlacement=0;p.cornerRadius=r.calloutCornerRadius;p.offset=r.calloutOffset;p.opacity=r.calloutOpacity;p.lineWidth=r.calloutLineWidth;p.pointerWidth=r.calloutPointerWidth;p.borderColor=r.calloutBorderColor;p.fillColor=r.calloutfillColor;p.draw(g,k)}else y.calloutPlaceholder.css({display:"none",visibility:"hidden"})})):y.calloutPlaceholder.css({display:"none",
visibility:"hidden"});break;case 4:y.calloutPlaceholder.css({display:"none",visibility:"hidden"})}}var q,s,p=new primitives.common.Callout(b()),r,y;return{process:function(){var d=k.getHighlightTreeItem();q=b();q.reset("calloutplaceholder",15);null!==d&&(s=c.getTransform(),r=g.getOptions(),y=a(),n(d));return!1}}};
primitives.orgdiagram.DrawHighlightPathAnnotationTask=function(a,b,c,d,e){function f(a,b,c,d){var f,l,m,n,q,s,p,r,y,w,t,u,z;if(0<c.length){t=new primitives.common.PolylinesBuffer;switch(e){case 1:a.activate("placeholder",5);break;case 2:a.activate("placeholder",7)}var v={};f=0;for(l=c.length;f<l;f+=1)if(w=c[f],null!=w.items&&0<w.items.length&&(r=w.items.slice(0),q=r[0],d.hasNode(q))){m=1;for(n=r.length;m<n;m+=1)s=r[m],d.hasNode(s)&&(v.hasOwnProperty(q)?v[q].push(s):v[q]=[s],q=s)}var x={};for(u in v)x[u]=
{},v.hasOwnProperty(u)&&d.getShortestPath(this,u,v[u],function(a){return a.weight},function(a,b){x[u][b]=a});f=0;for(l=c.length;f<l;f+=1)if(w=c[f],m=new primitives.common.PaletteItem({lineColor:null!=w.color?w.color:b.highlightLinesColor,lineWidth:null!=w.lineWidth?w.lineWidth:b.highlightLinesWidth,lineType:null!=w.lineType?w.lineType:b.highlightLinesType,fillColor:null,opacity:w.opacity}),v=t.getPolyline(m),null!=w.items&&0<w.items.length&&(r=w.items.slice(0),q=r[0],d.hasNode(q))){m=1;for(n=r.length;m<
n;m+=1)if(s=r[m],d.hasNode(s)){p=x[q][s]||[];for(q=p.length-2;0<=q;q-=1)u=p[q+1],z=p[q],y=d.edge(u,z),y.from==u?y.polyline.clone().mergeTo(v):v.addInverted(y.polyline.clone()),w.showArrows&&(z==y.parentsArrowId||z==y.childrenArrowId)&&v.addArrow(w.lineWidth,function(a){a.mergeTo(t.getPolyline(a.paletteItem))});q=s}}a.polylinesBuffer(t)}}return{process:function(){var g=d.getGraph(),h=b.getOptions(),i=c.getAnnotations(),j=a();switch(e){case 1:j.reset("placeholder",5);break;case 2:j.reset("placeholder",
7)}f(j,h,i,g);return!1}}};
primitives.orgdiagram.DrawHighlightTask=function(a,b,c,d,e,f,g,h,i){function j(a){var b;k.activate("placeholder",8);var c=e.getItemPosition(a),g=c.actualPosition,j=f.getTemplateParams(a).template,r=j.templateConfig,y=r.highlightPadding;b=new primitives.common.RenderEventArgs;b.context=d.getConfig(a);b.isCursor=h.getCursorTreeItem()==a;b.isSelected=i.isSelected(a);b.templateName=r.name;l.transformRect(g.x,g.y,g.width,g.height,!0,this,function(a,d,f,e){var g=new primitives.common.Rect(0,0,Math.round(f),
Math.round(e));g.offset(y.left,y.top,y.right,y.bottom);1==c.actualVisibility?k.template(a,d,f,e,g.x,g.y,g.width,g.height,j.highlightTemplate.template(),j.highlightTemplate.getHashCode(),j.highlightTemplate.render,b,null):k.template(a,d,f,e,g.x,g.y,g.width-1,g.height-1,j.dotHighlightTemplate.template(),j.dotHighlightTemplate.getHashCode(),j.dotHighlightTemplate.render,b,null)})}var k,l;return{process:function(){var c=g.getHighlightTreeItem();k=a();k.reset("placeholder",8);null!=c&&(l=b.getTransform(),
j(c));return!1}}};
primitives.orgdiagram.DrawItemLabelsTask=function(a,b,c,d,e,f){function g(){var a,b,c,e,g,p,r,y=[];j.loopLevels(this,function(a){var c=[];j.loopLevelItems(this,a,function(a){var e=d.getItemOptions(a),g=f.getItemPosition(a),a=g.actualPosition;null!=e&&i.transformRect(a.x,a.y,a.width,a.height,!0,this,function(a,d,f,h){switch(g.actualVisibility){case 1:0==k.showLabels&&(b=new primitives.common.Label,b.text="dummy",b.position=new primitives.common.Rect(a,d,f,h),b.weight=1E4,b.labelType=1,c.push(b));break;
case 2:var i,j,l=null,n=k.labelOffset,q,p;if(!primitives.common.isNullOrEmpty(e.label)){switch(e.showLabel){case 0:switch(k.showLabels){case 0:switch(g.actualVisibility){case 3:case 2:l=new primitives.common.Label,l.labelType=0,l.weight=g.leftPadding+g.rightPadding}break;case 1:l=new primitives.common.Label,l.labelType=2,l.weight=1E4}break;case 1:l=new primitives.common.Label,l.weight=1E4,l.labelType=2}if(null!=l){l.text=e.label;q=null!=e.labelSize?e.labelSize:k.labelSize;l.labelOrientation=3!=e.labelOrientation?
e.labelOrientation:3!=k.labelOrientation?k.labelOrientation:0;p=0!=e.labelPlacement?e.labelPlacement:0!=k.labelPlacement?k.labelPlacement:1;switch(l.labelOrientation){case 0:i=q.width;j=q.height;break;case 1:case 2:j=q.width,i=q.height}switch(p){case 0:case 1:l.position=new primitives.common.Rect(a+f/2-i/2,d-n-j,i,j);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=0;l.verticalAlignmentType=2;break;case 1:l.horizontalAlignmentType=1;l.verticalAlignmentType=1;break;case 2:l.horizontalAlignmentType=
2,l.verticalAlignmentType=1}break;case 2:case 11:l.position=new primitives.common.Rect(a+f+n,d-n-j,i,j);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=1;l.verticalAlignmentType=2;break;case 1:l.horizontalAlignmentType=1;l.verticalAlignmentType=0;break;case 2:l.horizontalAlignmentType=2,l.verticalAlignmentType=2}break;case 3:l.position=new primitives.common.Rect(a+f+n,d+h/2-j/2,i,j);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=1;l.verticalAlignmentType=1;break;case 1:l.horizontalAlignmentType=
0;l.verticalAlignmentType=0;break;case 2:l.horizontalAlignmentType=0,l.verticalAlignmentType=2}break;case 4:case 12:l.position=new primitives.common.Rect(a+f+n,d+h+n,i,j);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=1;l.verticalAlignmentType=0;break;case 1:l.horizontalAlignmentType=2;l.verticalAlignmentType=0;break;case 2:l.horizontalAlignmentType=1,l.verticalAlignmentType=2}break;case 5:l.position=new primitives.common.Rect(a+f/2-i/2,d+h+n,i,j);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=
0;l.verticalAlignmentType=0;break;case 1:l.horizontalAlignmentType=2;l.verticalAlignmentType=1;break;case 2:l.horizontalAlignmentType=1,l.verticalAlignmentType=1}break;case 6:case 10:l.position=new primitives.common.Rect(a-i-n,d+h+n,i,j);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=2;l.verticalAlignmentType=0;break;case 1:l.horizontalAlignmentType=2;l.verticalAlignmentType=2;break;case 2:l.horizontalAlignmentType=1,l.verticalAlignmentType=0}break;case 7:l.position=new primitives.common.Rect(a-
i-n,d+h/2-j/2,i,j);switch(l.labelOrientation){case 0:l.horizontalAlignmentType=2;l.verticalAlignmentType=1;break;case 1:l.horizontalAlignmentType=0;l.verticalAlignmentType=2;break;case 2:l.horizontalAlignmentType=0,l.verticalAlignmentType=0}break;case 8:case 9:switch(l.position=new primitives.common.Rect(a-i-n,d-n-j,i,j),l.labelOrientation){case 0:l.horizontalAlignmentType=2;l.verticalAlignmentType=2;break;case 1:l.horizontalAlignmentType=1;l.verticalAlignmentType=2;break;case 2:l.horizontalAlignmentType=
2,l.verticalAlignmentType=0}}}}b=l;null!=b&&c.push(b)}})});y[a]=c});var w=[],t=[],u=[];0==k.showLabels&&(j.loopLevels(this,function(a){var b=y[a],c,d,f=!1;e=0;for(p=b.length;e<p;e+=1)c=b[e],null==d?d=new primitives.common.Rect(c.position):d.addRect(c.position),f=f||2==c.labelType;w[a]=d;t[a]=f}),j.loopLevelsReversed(this,function(a){var b=w[a-1],c=w[a];u[a]=!0;null!=b&&null!=c&&b.overlaps(c)&&(u[a]=!1)}),j.loopLevels(this,function(d){a=y[d];if(u[d]){e=0;for(p=a.length;e<p;e+=1)if(b=a[e],b.isActive)for(g=
e+1;g<p;g+=1)if(c=a[g],c.isActive)if(b.position.overlaps(c.position))if(b.weight>=c.weight)0==c.labelType&&(c.isActive=!1);else{0==b.labelType&&(b.isActive=!1);break}else break}}));h.activate("placeholder",10);r={"font-size":k.labelFontSize,"font-family":k.labelFontFamily,"font-style":k.labelFontStyle,"font-weight":k.labelFontWeight,"font-color":k.labelColor};j.loopLevels(this,function(a){if(1==k.showLabels||u[a]||t[a]){a=y[a];e=0;for(p=a.length;e<p;e+=1)if(b=a[e],b.isActive)switch(b.labelType){case 0:case 2:h.text(b.position.x,
b.position.y,b.position.width,b.position.height,b.text,b.labelOrientation,b.horizontalAlignmentType,b.verticalAlignmentType,r)}}})}var h,i,j,k;return{process:function(){h=a();i=b.getTransform();k=d.getOptions();j=e.getTreeLevels();h.reset("placeholder",10);g();return!1}}};
primitives.orgdiagram.DrawMinimizedItemsTask=function(a,b,c,d,e,f){function g(){var a=new primitives.common.PolylinesBuffer,b={},c,f=new primitives.common.Marker,g,r,y,w,t,u,z,v,x,A;for(A in l)l.hasOwnProperty(A)&&(t=l[A],u=t.actualPosition,z=d.getItemOptions(A),i.transformRect(u.x,u.y,u.width,u.height,!0,this,function(d,h,i,l){switch(t.actualVisibility){case 2:v=e.getTemplateParams(A);x=v.template.templateConfig;y=r=g=null;w=0;null!=z&&(r=g=z.itemTitleColor,y=z.minimizedItemShapeType);g=g||x.minimizedItemBorderColor||
"#000080";r=r||x.minimizedItemFillColor||"#000080";null==y&&(y=null!==x.minimizedItemShapeType?x.minimizedItemShapeType:k.minimizedItemShapeType);w=null===x.minimizedItemCornerRadius?x.minimizedItemSize.width/2:x.minimizedItemCornerRadius;null==y||6==y?(c=a.getPolyline(new primitives.common.PaletteItem({lineColor:g,lineWidth:x.minimizedItemLineWidth,lineType:x.minimizedItemLineType,fillColor:r,opacity:x.minimizedItemOpacity})),c.addSegment(new primitives.common.DotSegment(d,h,i,l,w))):f.draw(a,y,
new primitives.common.Rect(d,h,i,l),new primitives.common.PaletteItem({lineColor:g,lineWidth:x.minimizedItemLineWidth,lineType:x.minimizedItemLineType,fillColor:r,opacity:x.minimizedItemOpacity}));break;default:j&&(g="#ff0000",b.hasOwnProperty(g)||(b[g]=new primitives.common.PaletteItem({lineColor:g,lineWidth:1,lineType:0,fillColor:g,opacity:1})),c=a.getPolyline(b[g]),c.addSegment(new primitives.common.DotSegment(d-1,h-1,2,2,1)))}}));h.activate("placeholder",9);h.polylinesBuffer(a)}var h,i,j=!1,k,
l;return{process:function(){h=a();i=b.getTransform();k=d.getOptions();l=f.getItemsPositions();h.reset("placeholder",9);g();return!1}}};
primitives.orgdiagram.DrawPrintPreviewTask=function(a,b,c,d,e,f){var g;return{process:function(){var b=c.getOptions(),i=f.getOptions();g=a();g.reset("placeholder",1);if(4==b.pageFitMode){var b=new primitives.common.Size(b.printPreviewPageSize),j,k,l=d.getContentSize(),m=e.getTemplate();b.scale(1/i.scale);g.activate("placeholder",1);for(i=0;(i+1)*b.width<l.width;){for(j=0;(j+1)*b.height<l.height;)k=g.template(i*b.width,j*b.height,b.width,b.height,0,0,b.width,b.height,m.template(),m.getHashCode(),m.render,
null,null),k.data({column:i,row:j}),j+=1;i+=1}}return!1}}};
primitives.orgdiagram.DrawShapeAnnotationTask=function(a,b,c,d,e,f,g,h){function i(a,b){var c,d,f,e,g,i,u,z,v,x,A,B;switch(h){case 1:c=j.activate("placeholder",3);break;case 2:c=j.activate("placeholder",13)}d=0;for(f=a.length;d<f;d+=1)if(A=a[d],null!=A.items&&0<A.items.length){z=new primitives.common.Rect;e=0;for(g=A.items.length;e<g;e+=1)u=b(A.items[e]),null!=u&&z.addRect(u.actualPosition);if(!z.isEmpty()){i=new primitives.common.Shape(j);u=new primitives.orgdiagram.ShapeAnnotationConfig;v="opacity cornerRadius shapeType offset lineWidth borderColor fillColor lineType labelSize labelOffset labelPlacement zOrderType".split(" ");
e=0;for(g=v.length;e<g;e+=1)x=v[e],i[x]=A.hasOwnProperty(x)?A[x]:u[x];i.position=z;i.orientationType=l.orientationType;i.panelSize=c.size;i.labelTemplate=m;i.hasLabel=null!=A.templateName||null!=A.label;B=new primitives.common.RenderEventArgs;B.context=A;B.templateName=i.labelTemplate;k.transformRect(z.x,z.y,z.width,z.height,!0,this,function(a,b,c,d){a=new primitives.common.Rect(a,b,c,d);i.draw(a,B)})}}}var j,k,l,m;return{process:function(){j=a();k=b.getTransform();l=d.getOptions();m=g.getTemplate();
switch(h){case 1:j.reset("placeholder",3);break;case 2:j.reset("placeholder",13)}i(e.getAnnotations(),f.getItemPosition);return!1}}};
primitives.orgdiagram.DrawTreeItemsTask=function(a,b,c,d,e,f,g,h,i,j,k,l){function m(){var a,b=h.getCursorTreeItem(),c,d,f;for(f in n)n.hasOwnProperty(f)&&(c=n[f],d=c.actualPosition,1==c.actualVisibility&&s.transformRect(d.x,d.y,d.width,d.height,!0,this,function(d,h,k,j){var l=g.getTemplateParams(f),n=l.template;a=new primitives.common.RenderEventArgs;a.context=e.getConfig(f);a.isCursor=f==b;a.isSelected=i.isSelected(f);a.templateName=n.templateConfig.name;q.activate("placeholder",12);q.template(d,
h,k,j,c.contentPosition.x,c.contentPosition.y,c.contentPosition.width,c.contentPosition.height,n.itemTemplate.template(),n.itemTemplate.getHashCode(),n.itemTemplate.render,a,{"border-width":n.templateConfig.itemBorderWidth});l.hasGroupTitle&&q.template(d,h,k,j,2,c.contentPosition.y,p.groupTitlePanelSize-4,c.contentPosition.height+2,w.template(),w.getHashCode(),w.render,a,null);l.hasSelectorCheckbox&&(q.activate("placeholder",16),q.template(d,h,k,j,c.contentPosition.x,j-(p.checkBoxPanelSize-4),c.contentPosition.width,
p.checkBoxPanelSize-4,y.template(),y.getHashCode(),y.render,a,null));l.hasButtons&&(q.activate("placeholder",16),q.template(d,h,k,j,k-(p.buttonsPanelSize-4),c.contentPosition.y,p.buttonsPanelSize-4,Math.max(c.contentPosition.height,j-c.contentPosition.y),r.template(),n.templateConfig.name+r.getHashCode(),r.render,l,null))}))}var n,q,s,p,r,y,w;return{process:function(){q=a();p=d.getOptions();n=f.getItemsPositions();s=b.getTransform();r=l.getTemplate();y=k.getTemplate();w=j.getTemplate();q.reset("placeholder",
12);q.reset("placeholder",16);m();return!1}}};primitives.orgdiagram.AnnotationLabelTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.common.AnnotationLabelTemplate);return a}}};primitives.orgdiagram.ButtonsTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.common.ButtonsTemplate);return a}}};
primitives.orgdiagram.CheckBoxTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.CheckBoxTemplate(c.selectCheckBoxLabel));return b}}};
primitives.orgdiagram.GroupTitleTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.common.GroupTitleTemplate(c.itemTitleFirstFontColor,c.itemTitleSecondFontColor));return b}}};
primitives.orgdiagram.ItemTemplateParamsTask=function(a,b,c){function d(a,b,c){var d=!1;switch(b){case 0:switch(c){case 0:d=a;break;case 1:d=!0;break;case 2:d=!1}break;case 1:d=!0;break;case 2:d=!1}return d}var e={};return{process:function(){var f=a.getOptions(),g=0<f.buttons.length,h=b.getCursorItem(),i=f.items,j,k;e={};j=0;for(k=i.length;j<k;j+=1){var l=i[j],m=new primitives.orgdiagram.TemplateParams,n=h==l.id,q=c.getTemplate(l.templateName,f.defaultTemplateName,c.DefaultWidgetTemplateName),s=q.templateConfig,
p=null!=s.buttons&&0<s.buttons.length;m.template=q;m.hasSelectorCheckbox=d(n,l.hasSelectorCheckbox,f.hasSelectorCheckbox);m.hasButtons=(g||p)&&d(n,l.hasButtons,f.hasButtons);m.hasGroupTitle=!primitives.common.isNullOrEmpty(l.groupTitle);m.isActive=l.isActive&&s.isActive;m.hasButtons&&(m.buttons=p?s.buttons:f.buttons);e[l.id]=m}return!0},getTemplateParams:function(a){return e[a]}}};
primitives.orgdiagram.PrintPreviewTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.common.PrintPreviewTemplate);return a}}};
primitives.orgdiagram.ReadTemplatesTask=function(a){var b={};return{process:function(){var c,d,e,f=a.getOptions(),g=f.templates;b={};b.DefaultWidgetTemplate=new primitives.orgdiagram.Template(f,new primitives.orgdiagram.TemplateConfig);c=new primitives.orgdiagram.TemplateConfig;c.name="DefaultWidgetLabelAnnotationTemplate";c.isActive=!1;c.itemSize=new primitives.common.Size(100,20);c.minimizedItemSize=new primitives.common.Size(0,0);d=new primitives.orgdiagram.Template;d.templateConfig=c;d.minimizedItemCornerRadius=
c.minimizedItemSize.width/2;d.itemTemplate=new primitives.common.LabelAnnotationTemplate;d.dotHighlightTemplate=new primitives.common.DotHighlightTemplate(f,c);b.DefaultWidgetLabelAnnotationTemplate=d;c=0;for(d=g.length;c<d;c+=1)e=g[c],b[e.name]=new primitives.orgdiagram.Template(f,e);return!0},getTemplate:function(a,d,e){return b[a]||b[d]||b[e]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}};
primitives.orgdiagram.CombinedNormalVisibilityItemsTask=function(a,b,c,d,e,f,g,h,i,j,k,l){function m(a){var b=[],c,d,f,e,g,h,k={};c=0;for(d=a.length;c<d;c+=1){f=a[c];g=f.getItems();f=0;for(e=g.length;f<e;f+=1)h=g[f],k.hasOwnProperty(h)||(b.push(h),k[h]=!0)}return b}var n=[],q={},s=[b,c,d,e,f,g,h,i,j,k,l],p=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var b={isChanged:!1,hash:q},c=a.getOptions();n=p.read(n,m(s),"items",b);
if(0==c.pageFitMode||1==c.minimalVisibility)b.isChanged=!1;return b.isChanged},isItemSelected:function(a){return q.items.hasOwnProperty(a)}}};primitives.orgdiagram.CursorItemTask=function(a,b){var c=null;return{process:function(){var d=a.getCursorItem(),e=b.getActiveTreeLevels();c=null!=d&&e.hasItem(d)?d:null;return!0},getCursorTreeItem:function(){return c},getItems:function(){return null!=c?[c]:[]}}};
primitives.orgdiagram.CursorNeighboursTask=function(a,b){function c(a,b){var c=[];null!==a&&b.loopNeighbours(this,a,function(a,b){0===b.visibility&&c.push(a);return!0});return c}var d=[];return{process:function(){var e=b.getNavigationFamily(),f=a.getCursorTreeItem();d=c(f,e);return!0},getItems:function(){return d}}};
primitives.orgdiagram.HighlightItemTask=function(a,b){var c=null;return{process:function(){var d=a.getHighlightItem(),e=b.getActiveTreeLevels();c=null!=d&&e.hasItem(d)?d:null;return!0},getHighlightTreeItem:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask=function(a){function b(a){var b=[],c={},d,e,k,l,m,n;d=0;for(e=a.length;d<e;d+=1)if(k=a[d],k.selectItems){m=k.items;k=0;for(l=m.length;k<l;k+=1)n=m[k],null!=n&&!c.hasOwnProperty(n)&&(b.push(n),c[n]=!0)}return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},g=a.getAnnotations();c=e.read(c,b(g),"items",f);return f.isChanged},
getItems:function(){return c}}};
primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask=function(a){function b(a){var b=[],c={},d,e,k;d=0;for(e=a.length;d<e;d+=1)k=a[d],k.selectItems&&(null!=k.fromItem&&!c.hasOwnProperty(k.fromItem)&&(b.push(k.fromItem),c[k.fromItem]=!0),null!=k.toItem&&!c.hasOwnProperty(k.toItem)&&(b.push(k.toItem),c[k.toItem]=!0));return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},
g=a.getAnnotations();c=e.read(c,b(g),"items",f);return f.isChanged},getItems:function(){return c}}};
primitives.orgdiagram.SelectedItemsTask=function(a){function b(a){var b=[],c={},d,e,k;d=0;for(e=a.length;d<e;d+=1)k=a[d],null!=k&&!c.hasOwnProperty(k)&&(b.push(k),c[k]=!0);return b}var c=[],d={},e=new primitives.common.ArrayReader(new primitives.common.ValueReader(["string","number"],!0),!0);return{process:function(){var f={isChanged:!1,hash:d},g=a.getSelectedItems();c=e.read(c,b(g),"items",f);return f.isChanged},getItems:function(){return c},isSelected:function(a){return d.items.hasOwnProperty(a)}}};
primitives.orgdiagram.SelectionPathItemsTask=function(a,b,c,d){function e(a,b,c){var d=[],f={},e,m,n;m=0;for(n=a.length;m<n;m+=1)switch(e=a[m],c){case 1:b.loopParents(this,e,function(a){if(null!=f[a])return b.SKIP;d.push(a);f[a]=!0})}return d}var f=[];return{process:function(){var g=d.getSelectionPathMode(),h=a.getNavigationFamily(),i=b.getCursorTreeItem(),j=c.getItems().slice(0);j.push(i);f=e(j,h,g);return!0},getItems:function(){return f}}};
primitives.orgdiagram.BackgroundAnnotationManagerTask=function(a,b,c){function d(){var a=new primitives.common.perimeter.Manager,b,c,d,g,h,l,w,t,u,z,v,x,A,B,D;if(!i.isEmpty()&&(w=[],t=[],i.loopLevels(this,function(a){v=z=null;D=j[a];4!=D.actualVisibility&&(w.push(a),A=[],i.loopLevelItems(this,a,function(a){x=k[a];4!=x.actualVisibility&&(null!=v&&f(A,z,v,x),z=v,v=x)}),null!=v&&f(A,z,v,null),t.push(A))}),0<t.length)){u=[];h=[];b=0;for(c=t.length;b<c;b+=1)h=primitives.common.mergeSort([h,t[b]],null,
!0),u.push(h),h=t[b];u.push(primitives.common.mergeSort([t[b-1]],null,!0));h=[];b=0;for(c=u.length;b<c;b+=1){l={};A=u[b];d=0;for(g=A.length;d<g;d+=1)B=A[d],l[B]=d;h.push(l)}d=[];l=B=null;b=0;for(c=w.length;b<c;b+=1)g=w[b],null!=l&&e(d,b-1,h,u,j[B],l,j[l],j[g]),B=l,l=g;null!=l&&e(d,b-1,h,u,j[B],l,j[l],null);a.add(d)}return a}function e(a,b,c,d,f,e,h,j){var t=Math.floor(l.normalItemsInterval/2),u=null!=f?Math.floor(3*(f.shift+f.depth)/7+4*h.shift/7):h.shift-t,z=null!=j?Math.floor(3*(h.shift+h.depth)/
7+4*j.shift/7):h.shift+h.depth+t,v=null,x=null,A,B;i.loopLevelItems(this,e,function(f,e){A=k[f];4!=A.actualVisibility&&(null!=x&&g(a,c[b],c[b+1],d[b],d[b+1],u,z,v,x,A,B.id),v=x,x=A,B=e)});null!=x&&g(a,c[b],c[b+1],d[b],d[b+1],u,z,v,x,null,B.id)}function f(a,b,c,d){var f=Math.floor(l.normalItemsInterval/2),b=null!=b?Math.floor(3*b.actualPosition.right()/7+4*c.actualPosition.x/7):c.actualPosition.x-f,c=null!=d?Math.floor(3*c.actualPosition.right()/7+4*d.actualPosition.x/7):c.actualPosition.right()+f;
a.push(b);a.push(c)}function g(a,b,c,d,f,e,g,h,k,i,j){var v=[],x=primitives.common.perimeter.SegmentItem,A=Math.floor(l.normalItemsInterval/2),h=null!=h?Math.floor(3*h.actualPosition.right()/7+4*k.actualPosition.x/7):k.actualPosition.x-A,k=null!=i?Math.floor(3*k.actualPosition.right()/7+4*i.actualPosition.x/7):k.actualPosition.right()+A;v.push(new x(h,e,h,g));for(i=c[h]+1;i<=c[k];i+=1)v.push(new x(f[i-1],g,f[i],g));v.push(new x(k,g,k,e));for(i=b[k]-1;i>=b[h];i-=1)v.push(new x(d[i+1],e,d[i],e));a.push(new primitives.common.perimeter.Item(j,
v))}var h=null,i,j,k,l;return{process:function(){h=null;i=b.getTreeLevels();j=c.getTreeLevelsPositions();k=c.getItemsPositions();l=a.getOptions();return!0},getBackgroundManager:function(){null==h&&(h=d());return h}}};primitives.orgdiagram.CombinedContextsTask=function(a,b){return{process:function(){return!0},getConfig:function(c){return a.getConfig(c)||null!=b&&b.getConfig(c)}}};
primitives.orgdiagram.ConnectionsGraphTask=function(a,b,c,d,e){function f(a,b,c,d,f,e,g,h,k,i){this.polyline=c;this.from=a;this.to=b;this.weight=g||0;this.fromOffset=h||0;this.parentsArrowId=d;this.childrenArrowId=f;this.dotId=e;this.hasMiddle=k;this.middleParent=i}function g(a,b){var c=b.fromItems[0],d=b.toItems[0],e=w[c],g=w[d],h=y[b.fromLevel],k=new primitives.common.Polyline;e.actualPosition.x<g.actualPosition.x?q.transformPoints(e.actualPosition.right(),h.shift+h.horizontalConnectorsDepth,g.actualPosition.x,
h.shift+h.horizontalConnectorsDepth,!0,this,function(a,b,c,d){k.addSegment(new primitives.common.MoveSegment(a,b));k.addSegment(new primitives.common.LineSegment(c,d))}):q.transformPoints(e.actualPosition.x,h.shift+h.horizontalConnectorsDepth,g.actualPosition.right(),h.shift+h.horizontalConnectorsDepth,!0,this,function(a,b,c,d){k.addSegment(new primitives.common.MoveSegment(a,b));k.addSegment(new primitives.common.LineSegment(c,d))});g=4!==g.actualVisibility;e=4!==e.actualVisibility;a.addEdge(c,d,
new f(c,d,k,g?d:null,e?c:null,g||e?1E3:10))}function h(a){this.bundleid=this.y=this.x=this.id=null;this.hasElbow=!1;this.visibility=this.elbowPoint2=this.elbowPoint1=null;this.isSquared=!0;for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b])}function i(){var a="_"+t;t+=1;return a}function j(a,b,c){var e=y[b.fromLevel],g=d.getConnectorsStacksSizes(b.fromLevel),j,l,n,m,p,t,I,F,K;F=0===s.connectorType;K=0<b.fromOffset?e.shift+e.connectorShift-e.levelSpace/2*(g.parentsStackSize-b.fromOffset+1):e.shift+
e.connectorShift;g=[];if(0<b.fromItems.length){l=b.fromItems;p=0;for(j=l.length;p<j;p+=1)n=l[p],m=w[n],n=new h({id:n,bundleid:i(),x:m.actualPosition.horizontalCenter(),y:m.actualPosition.bottom(),isSquared:!0,visibility:m.actualVisibility}),g.push(n);g.sort(function(a,b){return a.x-b.x})}j=[];if(0<b.toItems.length){I=!1;l=b.toItems;for(p=0;p<l.length;p+=1){n=l[p];r.getLevelIndex(n);m=w[n];t=!0;if(c)switch(m.actualVisibility){case 2:case 3:t=F}n=new h({id:n,bundleid:i(),x:m.actualPosition.horizontalCenter()+
0,y:m.actualPosition.top(),isSquared:t,visibility:m.actualVisibility});j.push(n);I=I||n.isSquared}j.sort(function(a,b){return a.x-b.x})}F=1==j.length?j[0].x:1==g.length?g[0].x:0<j.length&&0<g.length?(g[0].x+g[g.length-1].x+j[0].x+j[j.length-1].x)/4:0<j.length?(j[0].x+j[j.length-1].x)/2:(g[0].x+g[g.length-1].x)/2;var N=null;0<g.length&&(N=new h({id:i(),x:F,y:K}),k(a,N,g,!0,c,!0,b.fromOffset,s.showExtraArrows&&0<j.length));var G=null;0<j.length&&(G=new h({id:i(),x:F,y:e.shift+e.connectorShift}),null!=
N&&G.y==N.y&&(G=N),k(a,G,j,I,c,!1,0,s.showExtraArrows&&0<g.length));null!=N&&(null!=G&&N.id!=G.id)&&q.transformPoints(N.x,N.y,G.x,G.y,!0,this,function(b,c,d,e){var g=new primitives.common.Polyline;g.addSegment(new primitives.common.MoveSegment(b,c));g.addSegment(new primitives.common.LineSegment(d,e));a.addEdge(N.id,G.id,new f(N.id,G.id,g,null,null,null,0))})}function k(a,b,c,d,e,g,k,i){var j,n,m,p=[],t,r;if(d){p=[];d=0;for(n=c.length;d<n;d+=1)if(m=c[d],m.x<b.x&&!m.isSquared)p.push(m);else break;
n=p.length;0<n&&(m=p[n-1],m=m.x==b.x?b:new h({id:m.bundleid,x:m.x,y:b.y}),l(a,m,p,!1));p=[];for(j=c.length-1;j>=d;j-=1)if(m=c[j],m.x>b.x&&!m.isSquared)p.push(m);else break;n=p.length;0<n&&(m=p[n-1],m=m.x==b.x?b:new h({id:m.bundleid,x:m.x,y:b.y}),l(a,m,p,!1));for(p=d;p<=j;p+=1){m=c[p];n=s.bevelSize;2>n&&(n=0);if(e)switch(s.elbowType){case 2:case 3:0<n&&(Math.abs(b.x-m.x)>n&&Math.abs(b.y-m.y)>n)&&(m.hasElbow=!0,m.elbowPoint1=new primitives.common.Point(m.x,b.y+(b.y>m.y?-n:n)),m.elbowPoint2=new primitives.common.Point(m.x+
(b.x>m.x?n:-n),b.y))}t=new primitives.common.Polyline;m.hasElbow?(q.transform3Points(m.elbowPoint2.x,m.elbowPoint2.y,m.elbowPoint1.x,m.elbowPoint2.y,m.elbowPoint1.x,m.elbowPoint1.y,!0,this,function(a,b,c,d,f,e){switch(s.elbowType){case 2:t.addSegment(new primitives.common.MoveSegment(a,b));t.addSegment(new primitives.common.LineSegment(f,e));break;case 3:t.addSegment(new primitives.common.MoveSegment(a,b)),t.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,f,e))}}),q.transformPoints(m.elbowPoint1.x,
m.elbowPoint1.y,m.x,m.y,!0,this,function(a,b,c,d){t.addSegment(new primitives.common.LineSegment(c,d))})):q.transformPoints(m.x,b.y,m.x,m.y,!0,this,function(a,b,c,d){t.addSegment(new primitives.common.MoveSegment(a,b));t.addSegment(new primitives.common.LineSegment(c,d))});n=m.x==b.x?b.id:m.bundleid;r=4!==m.visibility;a.addEdge(n,m.id,new f(n,m.id,t,g&&r?m.id:null,!g&&r?m.id:null,null,r?1E3:10,k))}d=Math.max(d-1,0);j=Math.min(j+1,c.length-1);e=b;m=b.id;for(p=d;p<=j;p+=1)n=c[p],r=n.bundleid,n.x>e.x&&
(t=new primitives.common.Polyline,q.transformPoints(e.x,b.y,null!=n.elbowPoint2?n.elbowPoint2.x:n.x,b.y,!0,this,function(a,b,c,d){t.addSegment(new primitives.common.MoveSegment(a,b));t.addSegment(new primitives.common.LineSegment(c,d))}),a.addEdge(m,r,new f(m,r,t,null,null,m,Math.abs(n.x-e.x)/1E4,k,i,g?r:m)),e=n,m=r);e=b;m=b.id;for(p=j;p>=d;p-=1)n=c[p],r=n.bundleid,n.x<e.x&&(t=new primitives.common.Polyline,q.transformPoints(e.x,b.y,null!=n.elbowPoint2?n.elbowPoint2.x:n.x,b.y,!0,this,function(a,b,
c,d){t.addSegment(new primitives.common.MoveSegment(a,b));t.addSegment(new primitives.common.LineSegment(c,d))}),a.addEdge(m,r,new f(m,r,t,null,null,m,Math.abs(n.x-e.x)/1E4,k,i,g?r:m)),e=n,m=r)}else l(a,b,c,!0)}function l(a,b,c,d){var e,g,h,k,i;e=0;for(g=c.length;e<g;e+=1){k=c[e];i=new primitives.common.Polyline;q.transformPoint(b.x,b.y,!0,this,function(a,b){i.addSegment(new primitives.common.MoveSegment(a,b))});switch(s.connectorType){case 1:q.transformPoint(k.x,k.y,!0,this,function(a,b){i.addSegment(new primitives.common.LineSegment(a,
b))});break;case 2:h=new primitives.common.Rect(b,k),d?b.x>h.x?q.transform3Points(h.right(),h.verticalCenter(),h.x,h.verticalCenter(),h.x,h.bottom(),!0,this,function(a,b,c,d,f,e){i.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,f,e))}):q.transform3Points(h.x,h.verticalCenter(),h.right(),h.verticalCenter(),h.right(),h.bottom(),!0,this,function(a,b,c,d,f,e){i.addSegment(new primitives.common.CubicArcSegment(a,b,c,d,f,e))}):b.x>h.x?q.transformPoints(h.x,h.y,h.x,h.bottom(),!0,this,function(a,
b,c,d){i.addSegment(new primitives.common.QuadraticArcSegment(a,b,c,d))}):q.transformPoints(h.right(),h.y,h.right(),h.bottom(),!0,this,function(a,b,c,d){i.addSegment(new primitives.common.QuadraticArcSegment(a,b,c,d))})}h=4!==k.visibility;a.addEdge(b.id,k.id,new f(b.id,k.id,i,null,h?k.id:null,h?1E3:10))}}var m=null,n,q,s,p,r,y,w,t;return{process:function(){n=a();q=b.getTransform();s=c.getOptions();p=d.getBundles();r=d.getTreeLevels();y=e.getTreeLevelsPositions();w=e.getItemsPositions();var f=primitives.common.graph(),
h=n.activate("placeholder",6),k,i;k=t=0;for(i=p.length;k<i;k+=1){var l=p[k];l.isVertical?j(f,l,h.hasGraphics):g(f,l)}m=f;return!0},getGraph:function(){return m}}};primitives.orgdiagram.IntervalsTask=function(a){var b={};return{process:function(){var c=a.getOptions();b[1]=c.normalItemsInterval;b[2]=c.dotItemsInterval;b[3]=c.lineItemsInterval;b[4]=c.lineItemsInterval;return!0},getInterval:function(a){return b[a]}}};
primitives.orgdiagram.ItemsPositionsTask=function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,q,s;function p(a){var b=new primitives.common.Rect(0,0,0,0),c,d,f,e,g;switch(F.orientationType){case 2:case 3:a.invert()}if(!C.isEmpty())switch(G.pageFitMode){case 0:case 4:case 5:c=[new primitives.orgdiagram.LevelVisibility(0,1)];b=r(c,0);break;default:c=[new primitives.orgdiagram.LevelVisibility(0,1)];d=[];switch(G.minimalVisibility){case 2:d.push(2);break;case 0:case 3:case 4:d.push(2),d.push(3)}C.loopLevelsReversed(this,
function(a){var b;for(b=0;b<d.length;b+=1)c.push(new primitives.orgdiagram.LevelVisibility(a,d[b]))});f=r(c,c.length-1);f.addRect(a);f.offset(0,0,5,5);g=e=a=null;b=r(c,0);if(!y(b,f)&&(a=0,b=r(c,c.length-1),y(b,f))){for(g=e=c.length-1;1<e-a;)g=Math.floor((e+a)/2),b=r(c,g),y(b,f)?e=g:a=g;e!==g&&(b=r(c,e))}}return b}function r(a,b){var c,d;n=[];C.loopLevels(this,function(){var a=new primitives.orgdiagram.TreeLevelPosition;a.currentvisibility=1;n.push(a)});for(c=0;c<=b;c+=1)d=a[c],n[d.level].currentvisibility=
d.currentvisibility;u();x();z();c=G.lineLevelShift;var f,e,g,h,k=d=0;f=8*K.linesWidth;switch(K.arrowsDirection){case 1:d=f;k=0;break;case 2:d=0,k=f}f=0;for(e=n.length;f<e;f+=1)g=n[f],h=i.getConnectorsStacksSizes(f),c+=g.setShift(c,v(g.actualVisibility),k,d,h.parentsStackSize);return new primitives.common.Rect(0,0,Math.round(t()),Math.round(w()))}function y(a,b){var c=!1;switch(G.pageFitMode){case 1:b.width>=a.width&&(c=!0);break;case 2:b.height>=a.height&&(c=!0);break;case 3:b.height>=a.height&&b.width>=
a.width&&(c=!0)}return c}function w(){var a=n[n.length-1];return a.shift+a.nextLevelShift}function t(){var a=0,b,c;b=0;for(c=n.length;b<c;b+=1)a=Math.max(a,n[b].currentOffset);return a+=G.normalItemsInterval}function u(){var a=l.getCursorTreeItem();q={};C.loopLevels(this,function(b){var c=n[b];C.loopLevelItems(this,b,function(b,d){var f=new primitives.orgdiagram.TreeItemPosition,e=m.isItemSelected(b)?1:d.visibility,g=k.getTemplateParams(b);f.actualVisibility=0===e?c.currentvisibility:e;f.setSize(a==
b,g,G,F);q[b]=f})})}function z(){var a,b;C.loopLevels(this,function(c){var d=n[c];d.shift=0;d.depth=0;d.actualVisibility=4;b=a=null;C.loopLevelItems(this,c,function(c){c=q[c];d.depth=Math.max(d.depth,c.actualSize.height);switch(c.actualVisibility){case 2:case 3:case 4:b=!b?c.actualSize.height:Math.min(b,c.actualSize.height);break;default:a=!a?c.actualSize.height:Math.min(a,c.actualSize.height)}d.actualVisibility=Math.min(d.actualVisibility,c.actualVisibility)});null==a&&(a=d.depth);null!=b&&b>a&&
(a=b);switch(G.verticalAlignment){case 0:d.horizontalConnectorsDepth=a/2;break;case 1:d.horizontalConnectorsDepth=d.depth/2;break;case 2:d.horizontalConnectorsDepth=d.depth-a/2}})}function v(a){var b=0;switch(a){case 1:b=G.normalLevelShift;break;case 2:b=G.dotLevelShift;break;case 3:case 4:b=G.lineLevelShift}return b}function x(){var a,b;a=0;for(b=n.length;a<b;a+=1)n[a].currentOffset=0;H.loopPostOrder(this,function(a,b){var c=q[a],d=c.actualVisibility,f=C.getLevelIndex(a),f=n[f],d=g.getInterval(0===
d?f.currentvisibility:d)/2,e,h,k,i,j,l,m,p;e=8*K.linesWidth;c.leftPadding=d+(0<f.currentOffset?d*b.relationDegree*G.cousinsIntervalMultiplier:0);c.rightPadding=d;0!=K.arrowsDirection&&(b.connectorPlacement&8&&(c.leftPadding+=e),b.connectorPlacement&2&&(c.rightPadding+=e));c.offset=f.currentOffset+c.leftPadding;f.currentOffset=c.offset+c.actualSize.width+c.rightPadding;if(H.hasChildren(a))if(c=A(b),0<c)D(b,c);else if(0>c&&(c=-c,B(b,c),h=null,k={},j=null,f=H.parent(b.id),null!==f&&(H.loopChildrenReversed(this,
f.id,function(a,c){if(c===b)h=[];else if(null!==h){var d=null,f=[],e,g,l,n;e=I[c.id];void 0===e&&(e=[]);e=e.slice();e.splice(0,0,c.id);g=0;for(l=e.length;g<l;g+=1)n=q[e[g]],f[g]=n.offset+n.actualSize.width+n.rightPadding;e=[];var m;g=J[b.id];void 0===g&&(g=[]);g=g.slice();g.splice(0,0,b.id);l=0;for(n=g.length;l<n;l+=1)m=q[g[l]],e[l]=m.offset-m.leftPadding;g=Math.min(f.length,e.length);for(l=0;l<g&&!(n=e[l]-f[l],d=null!==d?Math.min(d,n):n,0>=n);l+=1);i=Math.floor(d);k[c.id]=i;if(0<i)h.splice(0,0,c);
else return j=c,!0}}),0<h.length))){d=null;if(null!==j){l=[j];l=l.concat(h);l.push(b);d=[[j]];f=1;for(e=l.length;f<e;f+=1)m=l[f-1],p=l[f],2==m.gravity||1==p.gravity?d[d.length-1].push(p):d.push([p])}else d=[h.slice(0)],d[d.length-1].push(b);if(0<d.length){h=d[d.length-1];for(f=h.length-2;0<=f;f-=1)p=h[f],i=k[p.id],c=Math.min(i,c),B(p,c),D(p,c)}l=c/(d.length-1);for(e=d.length-2;0<e;e-=1){m=d[e];for(f=m.length-1;0<=f;f-=1)p=m[f],i=k[p.id],c=Math.min(e*l,Math.min(i,c)),B(p,c),D(p,c)}}})}function A(a){var b=
q[a.id],b=b.offset+b.actualSize.width/2,c=null,d,f,e;if(null===a.visualAggregatorId)switch(d=null,H.loopChildren(this,a.id,function(a,b){d=b;if(d.connectorPlacement&1)return!0}),f=q[d.id],e=null,H.loopChildrenReversed(this,a.id,function(a,b){e=b;if(e.connectorPlacement&1)return!0}),a=q[e.id],N.horizontalAlignment){case 1:c=f.offset+f.actualSize.width/2;break;case 2:c=a.offset+a.actualSize.width/2;break;case 0:c=(f.offset+a.offset+a.actualSize.width)/2}else a=q[a.visualAggregatorId],c=a.offset+a.actualSize.width/
2;return b-c}function B(a,b){var c=q[a.id];c.offset+=b;var d=n[C.getLevelIndex(a.id)];d.currentOffset=Math.max(d.currentOffset,c.offset+c.actualSize.width+c.rightPadding)}function D(a,b){var c,d;H.loopLevels(this,a.id,function(a){c=q[a];c.offset+=b;d=n[C.getLevelIndex(a)];d.currentOffset=Math.max(d.currentOffset,c.offset+c.actualSize.width);return!0})}function E(){C.loopLevels(this,function(a){var b=n[a];C.loopLevelItems(this,a,function(a){q[a].setPosition(b,G,F)})})}q={};n=[];s=null;var C,H,J,I,
F,K,N,G,M;return{process:function(){var g;G=d.getOptions();F=c.getOptions();K=e.getOptions();N=f.getOptions();C=i.getTreeLevels();H=h.getVisualTree();J=j.getLeftMargins();I=j.getRightMargins();n=[];q={};g=a.getOptimalPanelSize();M=b.getOptions();g.scale(1/M.scale);g=new primitives.common.Rect(0,0,g.width,g.height);s=p(g);E();return!0},getTreeLevelsPositions:function(){return n},getItemsPositions:function(){return q},getItemPosition:function(a){return q[a]},getContentSize:function(){return s}}};
primitives.orgdiagram.OrgTreeTask=function(a){var b,c;function d(a){var d,h,i,j,k,l=0,m,n=primitives.common.tree();j=0;for(k=a.length;j<k;j+=1)i=a[j],null!=i.id&&(d=new primitives.orgdiagram.OrgItem(i),m=parseInt(i.id,10),l=Math.max(isNaN(m)?0:m,l),n.add(i.parent,d.id,d));l+=1;a=new primitives.orgdiagram.ItemConfig;a.id=l;a.title="internal root";a.isVisible=!1;a.isActive=!1;h=new primitives.orgdiagram.OrgItem(a);h.hideParentConnection=!0;h.hideChildrenConnection=!0;n.add(null,h.id,h);n.loopLevels(this,
function(a,b,c){if(0<c)return n.BREAK;h.id!=a&&(n.adopt(h.id,a),b.itemType=0)});e(n);b=n;c=l;return!0}function e(a){a.loopLevels(this,function(b,c){var d=!0;if(c.isVisible)return a.SKIP;a.loopChildren(this,b,function(a,b){if(0!=b.itemType)return d=!1,!0});if(d)c.hideChildrenConnection=!0,a.loopChildren(this,b,function(a,b){b.hideParentConnection=!0});else return a.SKIP})}c=b=null;return{process:function(){d(a.getItems());return!0},getOrgTree:function(){return b},getMaximumId:function(){return c}}};
primitives.orgdiagram.PaletteManagerTask=function(a,b){var c;return{process:function(){var d=[];null!=b&&(d=b.getOptions().linesPalette);c=new primitives.common.PaletteManager(a.getOptions(),d);return!0},getPaletteManager:function(){return c}}};
primitives.orgdiagram.VisualTreeLevelsTask=function(a,b){function c(a,b,c,d){var f,e,g,h,p,r,y,w={},t,u,z;c.loopLevels(this,function(v){var x=new primitives.orgdiagram.TreeLevelConnectorStackSize;b[v]=x;y=[];c.loopLevelItems(this,v,function(b,f){var e=[];if(!w.hasOwnProperty(b)&&(f.connectorPlacement&4&&e.push(b),e=e.concat(f.partners),0<e.length)){r=new primitives.orgdiagram.ConnectorBundle;r.fromLevel=v;r.fromItems=e;r.toItems=[];for(var g=0,h=e.length;g<h;g+=1)w[e[g]]=r;d.loopChildren(this,b,function(a,
b){b.connectorPlacement&1&&r.toItems.push(a)});1<e.length&&y.push(r);(1<r.fromItems.length||0<r.toItems.length)&&a.push(r)}f.connectorPlacement&8&&(r=new primitives.orgdiagram.ConnectorBundle,r.isVertical=!1,r.fromLevel=v,r.fromItems=[b],r.toItems=[c.getPrevItem(b)],a.push(r));f.connectorPlacement&2&&(r=new primitives.orgdiagram.ConnectorBundle,r.isVertical=!1,r.fromLevel=v,r.fromItems=[b],r.toItems=[c.getNextItem(b)],a.push(r))});if(0<y.length){z=primitives.common.pile();f=0;for(e=y.length;f<e;f+=
1){r=y[f];u=t=null;g=0;for(h=r.fromItems.length;g<h;g+=1)p=c.getItemPosition(r.fromItems[g]),t=null!=t?Math.min(t,p):p,u=null!=u?Math.max(u,p):p;z.add(t,u,r)}x.parentsStackSize=z.resolve(this,function(a,b,c,d){c.fromOffset=d+1})}})}var d=null,e=null,f=null,g=null,h=new primitives.orgdiagram.TreeLevelConnectorStackSize;return{process:function(){var h=a.getVisualTree();d=primitives.common.TreeLevels();e=primitives.common.TreeLevels();h.loopLevels(this,function(a,c,f){var g=b.getTemplateParams(a);d.addItem(f,
a,c);null!=g&&(g.isActive&&4!=c.visibility)&&e.addItem(f,a,c)});f=[];g=[];c(f,g,d,h);return!0},getTreeLevels:function(){return d},getActiveTreeLevels:function(){return e},getBundles:function(){return f},getConnectorsStacksSizes:function(a){return g[a]||h}}};
primitives.orgdiagram.VisualTreeMarginsTask=function(a){function b(a,b,c){a.loop(this,function(a){b[a]=[];c[a]=[]});a.loopPostOrder(this,function(a,d,e){var d=b[e],k=c[e],l=b[a],m=c[a],n;if(null!=e){d[0]||(d[0]=a);e=0;for(n=l.length;e<n;e+=1)d[e+1]||(d[e+1]=l[e]);k[0]=a;e=0;for(n=m.length;e<n;e+=1)k[e+1]=m[e]}})}var c={},d={};return{process:function(){c={};d={};b(a.getVisualTree(),c,d);return!0},getLeftMargins:function(){return c},getRightMargins:function(){return d}}};
primitives.orgdiagram.VisualTreeTask=function(a,b,c,d){function e(a,b,c){var e,g,r,x,A,B,D,E,C,H,J,I,F={},K,N={},G,M,P,Z={},aa;a.loopPostOrder(this,function(a,b,c,d){b.hasVisibleChildren=b.isVisible||b.hasVisibleChildren;null!=d&&(d.hasVisibleChildren=d.hasVisibleChildren||b.hasVisibleChildren)});a.loopLevels(this,function(f,h){var i,D,r;if(!d&&!h.hasVisibleChildren)return a.SKIP;i=c.node(f);i||(i=q({visibility:4,connectorPlacement:0,parentId:null,actualItemType:0},h),c.add(null,f,i));P=M=0;if(null!=
(B=c.indexOf(f)))M=B,P=c.countSiblings(f)-B-1;D=[];a.loopChildren(this,f,function(a,b){if(d||b.hasVisibleChildren){e=q({parentId:f,actualItemType:b.itemType},b);switch(i.actualItemType){case 7:case 8:case 6:switch(e.actualItemType){case 7:case 8:case 6:e.actualItemType=2;break;case 0:e.actualItemType=1}}switch(e.actualItemType){case 5:s(i,e),e.connectorPlacement=5,r=q({visibility:4}),c.add(r.id,e.id,e),e=r;case 8:case 2:g=c.parent(f);if(i.connectorPlacement&2)x=l(c,p.navigationFamily,i),c.add(g.id,
e.id,e,x+1),e.connectorPlacement=6,e.gravity=2;else if(i.connectorPlacement&8)A=m(c,p.navigationFamily,i),c.add(g.id,e.id,e,A),e.connectorPlacement=12,e.gravity=1;else switch(b.adviserPlacementType){case 2:x=l(c,p.navigationFamily,i);c.add(g.id,e.id,e,x+1);e.connectorPlacement=6;e.gravity=2;break;default:A=m(c,p.navigationFamily,i),c.add(g.id,e.id,e,A),e.connectorPlacement=12,e.gravity=1}switch(e.actualItemType){case 8:null!=i.parentId?s(c.node(i.parentId),e):s(i,e,!0);break;case 2:s(i,e)}break;case 4:s(i,
e),e.connectorPlacement=5,r=q({visibility:4}),c.add(r.id,e.id,e),e=r;case 1:null===i.visualAggregatorId&&n(c,i,!1);switch(b.adviserPlacementType){case 2:c.add(f,e.id,e,0);e.connectorPlacement=6;e.gravity=2;break;default:c.add(f,e.id,e),e.connectorPlacement=12,e.gravity=1}1==e.actualItemType&&s(i,e);break;case 0:D.push(e);s(i,e);break;case 7:case 6:g=c.parent(f);if(i.connectorPlacement&2)c.add(g.id,e.id,e,M),e.connectorPlacement=6,e.gravity=2;else if(i.connectorPlacement&8)c.add(g.id,e.id,e,c.countChildren(g.id)-
P),e.connectorPlacement=12,e.gravity=1;else{switch(b.adviserPlacementType){case 2:c.add(g.id,e.id,e,M);e.gravity=2;break;default:c.add(g.id,e.id,e,c.countChildren(g.id)-P),e.gravity=1}switch(e.actualItemType){case 6:e.connectorPlacement=5;break;case 7:e.connectorPlacement=4}}null!=i.parentId?s(c.node(i.parentId),e):s(i,e,!0)}}});switch(i.actualItemType){case 7:case 8:case 6:break;default:aa=[],null!=(g=c.parent(f))&&c.loopChildrenRange(this,g.id,M,c.countChildren(g.id)-P,function(b,c){if(c.id==f)aa.push(c);
else switch(c.actualItemType){case 7:case 8:case 6:a.parentid(c.id)==f&&aa.push(c)}}),1<aa.length&&(Z[f]=aa)}F[f]=[];N[f]=[];var E=i,C=h.childrenPlacementType,v=F[f],H=N[f],J,I,K,G,U,ca,Q,O,W=4==E.visibility&&0===E.connectorPlacement;switch(b.horizontalAlignment){case 0:case 1:I=3;break;case 2:I=2}0===C&&(C=k(a,E)?0===b.leavesPlacementType?3:b.leavesPlacementType:0===b.childrenPlacementType?2:b.childrenPlacementType);J=E;null!==E.visualAggregatorId&&(J=c.node(E.visualAggregatorId));3==C&&3>D.length&&
(C=2);switch(C){case 2:C=0;for(G=D.length;C<G;C+=1)E=D[C],v=a.node(E.id),c.add(J.id,E.id,E),E.connectorPlacement=(v.hideParentConnection?0:1)|(v.hideChildrenConnection?0:4),0===C&&(E.relationDegree=1);break;case 3:G=Math.min(b.maximumColumnsInMatrix,Math.ceil(Math.sqrt(D.length)));U=Math.ceil(D.length/G);ca=Math.ceil(G/2);for(Q=0;Q<ca;Q+=1){I=J;for(O=0;O<U;O+=1){E=j(D,2*Q,O,G);C=j(D,2*Q+1,O,G);void 0===v[O]&&(v[O]=[],H[O]=[]);null!==E&&(0===Q&&(E.relationDegree=1),c.add(I.id,E.id,E),E.connectorPlacement=
(W?0:2)|4,E.gravity=2,H[O].push(E));if(null!==E||null!==C)K=q({visibility:4,connectorPlacement:W?0:5}),c.add(I.id,K.id,K),v[O].push(K);null!==C&&(c.add(I.id,C.id,C),C.connectorPlacement=(W?0:8)|4,C.gravity=1,H[O].push(C));I=K}}2<G&&(J.visualAggregatorId=null);break;case 1:C=0;for(G=D.length;C<G;C+=1){E=D[C];K=q({visibility:4,connectorPlacement:W?0:5});switch(I){case 2:c.add(J.id,E.id,E);c.add(J.id,K.id,K);E.connectorPlacement=(W?0:2)|4;E.gravity=2;break;case 3:c.add(J.id,K.id,K),c.add(J.id,E.id,E),
E.connectorPlacement=(W?0:8)|4,E.gravity=1}v[C]=[K];H[C]=[E];J=K}break;default:throw"Children placement is undefined!";}});a.loopPostOrder(this,function(a){var b=c.node(a),d,e,g;if(null!=b){d=N[a];e=F[a];H=h(c,b);if(0<H&&(b.visualDepth=H+1,null!==b.visualAggregatorId)){r=c.node(b.visualAggregatorId);g=c.hasChildren(r.id);for(B=0;B<H-1;B+=1)r=n(c,r,!g)}g=0;var k=c.parent(b.id),l,j,m;if(null!==k){l=c.indexOf(b.id);for(j=1;null!=(m=c.getChild(k.id,l+j));)if(m.connectorPlacement&8)g=Math.max(g,i(c,m)),
j+=1;else break;for(j=1;null!=(m=c.getChild(k.id,l-j));)if(m.connectorPlacement&2)g=Math.max(g,i(c,m)),j+=1;else break}H=g;if(1<H){b.visualDepth+=H-1;g=c.hasChildren(a);r=b;for(B=0;B<H-1;B+=1)r=n(c,r,!g)}J=[];B=0;for(D=d.length;B<D;B+=1){G=d[B];E=J[B]=0;for(C=G.length;E<C;E+=1)J[B]=Math.max(J[B],i(c,G[E]))}B=0;for(D=J.length;B<D;B+=1)if(I=J[B],1<I){E=0;for(C=e[B].length;E<C;E+=1)if(K=e[B][E],c.hasChildren(K.id))for(H=I;1<H;)K=n(c,K,!1),H-=1}null!=Z[a]&&f(c,b,Z[a])}})}function f(a,b,c){var d,e,f,h,
k=0,i=[],j,m;e=0;for(f=c.length;e<f;e+=1)d=c[e],k=Math.max(k,d.visualDepth);e=0;for(f=c.length;e<f;e+=1){d=c[e];j=g(a,d);h=1;for(m=d;null!=m.visualAggregatorId;)m=a.node(m.visualAggregatorId),m.connectorPlacement=5,h+=1;for(;h<k;)j=n(a,j,!1),h+=1;i.push(g(a,j).id)}m=g(a,b);if(a.hasChildren(m.id)){j=c[Math.floor(c.length/2)];if(1<c.length&&0===c.length%2){e=a.parent(j.id);f=l(a,p.navigationFamily,j);h=a.getChild(e.id,f).gravity||a.getChild(e.id,f+1).gravity;j=q({visibility:4,connectorPlacement:j.connectorPlacement&
10,gravity:h});a.add(e.id,j.id,j,f+1);for(h=1;h<k;)j=n(a,j,!1),j.connectorPlacement=0,h+=1}e=0;for(f=c.length;e<f;e+=1)d=c[e],p.navigationFamily.loopChildren(this,b.id,function(a,c){switch(c.actualItemType){case 5:case 2:case 4:case 1:break;default:b.id!=d.id&&s(d,c)}return p.navigationFamily.SKIP});j=g(a,j);a.moveChildren(m.id,j.id)}j.partners=i}function g(a,b){for(var c=b;null!=c.visualAggregatorId;)c=a.node(c.visualAggregatorId);return c}function h(a,b){var c=0;null!=b.visualAggregatorId&&a.loopLevels(this,
b.id,function(d,e,f){if(b.visualAggregatorId==d)return a.SKIP;c=f+1});return c}function i(a,b){var c=0;a.loopLevels(this,b.id,function(a,b,d){c=d+1});return c+1}function j(a,b,c,d){0<d%2&&(b===d-1?b=a.length:b===d&&(b=d-1));b=c*d+b;return b>a.length-1?null:a[b]}function k(a,b){var c=!1,d=!0;a.loopChildren(this,b.id,function(b,e){c=!0;if(0===e.itemType&&a.hasChildren(b))return d=!1,!0});return c&&d}function l(a,b,c){var d=null,e={},f=a.parent(c.id);a.loopChildrenReversed(this,f.id,function(a,f,g){if(null===
d)a==c.id&&(d=-1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,f.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=g,!0});return d}function m(a,b,c){var d=null,e={},f=a.parent(c.id);a.loopChildren(this,f.id,function(a,f,g,h){if(null===d)a==c.id&&(d=h+1,e[c.id]=!0,b.loopChildren(this,c.id,function(a,c,d){if(0<d)return b.BREAK;e[a]=!0}));else if(e.hasOwnProperty(a))b.loopChildren(this,a,function(a,
c,d){if(0<d)return b.BREAK;e[a]=!0});else return d=g,!0});return d}function n(a,b,c){c=q({visibility:4,visualAggregatorId:b.visualAggregatorId,connectorPlacement:4==b.visibility&&0===b.connectorPlacement||c?0:5});a.insert(b.id,c.id,c);b.visualAggregatorId=c.id;return c}function q(a,b){var c=new primitives.orgdiagram.TreeItem,d;for(d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);null!=b?(c.id=b.id,c.visibility=b.isVisible?0:4):(r+=1,c.id=r);return c}function s(a,c,d){var e=[];d||4==a.visibility||!b.getTemplateParams(a.id).isActive?
p.navigationFamily.loopParents(this,a.id,function(a,c){if(4!=c.visibility&&b.getTemplateParams(a).isActive)return e.push(a),p.navigationFamily.SKIP}):e.push(a.id);null!=p.navigationFamily.node(c.id)?p.navigationFamily.adopt(e,c.id):p.navigationFamily.add(e,c.id,c)}var p={visualTree:null,navigationFamily:null},r;return{process:function(){var b=a.getOrgTree(),d=c.getOptions();p.visualTree=primitives.common.tree();p.navigationFamily=primitives.common.family();r=a.getMaximumId();b.hasNodes()&&e(b,d,p.visualTree);
return!0},getVisualTree:function(){return p.visualTree},getNavigationFamily:function(){return p.navigationFamily},getConnectionsFamily:function(){return p.connectionsFamily}}};primitives.common.AnnotationLabelTemplate=function(){var a,b=jQuery("<div></div>");b.addClass("bp-item bp-corner-all bp-connector-label");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){b.element.html(b.context.label)}}};
primitives.common.ButtonsTemplate=function(){var a,b=jQuery("<ul></ul>");b.css({position:"absolute"}).addClass("ui-widget ui-helper-clearfix");a=b.wrap("<div>").parent().html();var c=primitives.common.hashCode(a);return{template:function(){return a},getHashCode:function(){return c},render:function(a,b){var c=0,g,h=b.buttons,i,j;switch(b.renderingMode){case 0:for(j=0;j<h.length;j+=1)g=h[j],i=jQuery('<li data-buttonname="'+g.name+'"></li>').css({position:"absolute",top:c+"px",left:"0px",width:g.size.width+
"px",height:g.size.height+"px",padding:"3px"}).addClass("orgdiagrambutton"),b.element.append(i),i.button({icons:{primary:g.icon},text:g.text,label:g.label}),primitives.common.isNullOrEmpty(g.tooltip)||null!=i.tooltip&&i.tooltip({content:g.tooltip}),c+=10+g.size.height}}}};
primitives.common.CheckBoxTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-selectioncheckbox-frame");c.append(jQuery('<label><nobr><input type="checkbox" name="checkbox" class="bp-selectioncheckbox" />&nbsp;<span name="selectiontext" class="bp-selectiontext">'+a+"</span></nobr></label>"));b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(a,b){b.element.find("[name=checkbox]").prop("checked",
b.isSelected)}}};primitives.common.CursorTemplate=function(a,b){var c;c=jQuery("<div></div>").css({width:b.itemSize.width+b.cursorPadding.left+b.cursorPadding.right+"px",height:b.itemSize.height+b.cursorPadding.top+b.cursorPadding.bottom+"px","border-width":b.cursorBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-cursor-frame").wrap("<div>").parent().html();var d=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return d},render:function(){}}};
primitives.common.DotHighlightTemplate=function(a,b){var c,d=b.minimizedItemCornerRadius+b.highlightPadding.left;c=jQuery("<div></div>").css({"border-width":b.highlightBorderWidth+"px","-moz-border-radius":d,"-webkit-border-radius":d,"-khtml-border-radius":d,"border-radius":d}).addClass("bp-item bp-highlight-dot-frame").wrap("<div>").parent().html();var e=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return e},render:function(){}}};
primitives.common.GroupTitleTemplate=function(a,b){var c,d=jQuery("<div></div>");d.addClass("bp-item bp-corner-all bp-grouptitle-frame");c=d.wrap("<div>").parent().html();var e=primitives.common.hashCode(c);return{template:function(){return c},getHashCode:function(){return e},render:function(c,d){var e=new primitives.text.Config,i=d.context,j=i.groupTitleColor||"#4169e1";e.orientation=2;e.horizontalAlignment=0;e.verticalAlignment=1;e.text=i.groupTitle;e.fontSize="12px";e.color=primitives.common.highestContrast(j,
b,a);e.fontFamily="Arial";switch(d.renderingMode){case 0:d.element.bpText(e);break;case 1:d.element.bpText("option",e),d.element.bpText("update")}primitives.common.css(d.element,{background:j})}}};
primitives.common.HighlightTemplate=function(a,b){function c(){return d}var d;d=jQuery("<div></div>").css({"border-width":b.highlightBorderWidth+"px"}).addClass("bp-item bp-corner-all bp-highlight-frame").wrap("<div>").parent().html();var e=primitives.common.hashCode(c);return{template:c,getHashCode:function(){return e},render:function(){}}};
primitives.common.ItemTemplate=function(a,b){function c(){return d}var d,e=new primitives.common.Size(b.itemSize),f,g,h;e.width-=2*b.itemBorderWidth;e.height-=2*b.itemBorderWidth;f=jQuery("<div></div>").css({"border-width":b.itemBorderWidth+"px"}).addClass("bp-item bp-corner-all bt-item-frame");g=jQuery('<div name="titleBackground"></div>').css({top:"2px",left:"2px",width:e.width-4+"px",height:"18px"}).addClass("bp-item bp-corner-all bp-title-frame");f.append(g);h=jQuery('<div name="title"></div>').css({top:"1px",
left:"4px",width:e.width-4-8+"px",height:"16px"}).addClass("bp-item bp-title");g.append(h);g=jQuery("<div></div>").css({top:"24px",left:"2px",width:"50px",height:"60px"}).addClass("bp-item bp-photo-frame");f.append(g);h=jQuery('<img name="photo" alt=""></img>').css({width:"50px",height:"60px"});g.append(h);e=jQuery('<div name="description"></div>').css({top:"24px",left:"56px",width:e.width-4-56+"px",height:"74px"}).addClass("bp-item bp-description");f.append(e);d=f.wrap("<div>").parent().html();var i=
primitives.common.hashCode(c);return{template:c,getHashCode:function(){return i},render:function(b,c){var d=c.context,e=null!=d.itemTitleColor?d.itemTitleColor:"#4169e1",f=primitives.common.highestContrast(e,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);c.element.find("[name=titleBackground]").css({background:e});c.element.find("[name=photo]").attr({src:d.image,alt:d.title});c.element.find("[name=title]").css({color:f}).text(d.title);c.element.find("[name=description]").text(d.description)}}};
primitives.common.PrintPreviewTemplate=function(){function a(){return b}var b,c=jQuery("<div></div>");c.addClass("bp-item bp-printpreview");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(a);return{template:a,getHashCode:function(){return d},render:function(){}}};
primitives.common.UserTemplate=function(a,b,c){var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,d){if(null!=c)c(b,d);else{var g=d.context,h=null!=g.itemTitleColor?g.itemTitleColor:"#4169e1",i=primitives.common.highestContrast(h,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor);d.element.find("[name=titleBackground]").css({background:h});d.element.find("[name=photo]").attr({src:g.image,alt:g.title});d.element.find("[name=title]").css({color:i}).text(g.title);
d.element.find("[name=description]").text(g.description)}}}};
primitives.orgdiagram.BaseControl=function(a,b,c,d){function e(a){switch(a){case 1:f(!0,w);break;case 2:a=w;p.layout.forceCenterOnCursor=!1;p.tasks.process("HighlightItemOptionTask",null,a);p.graphics.end();break;default:null!=p.mouse&&p.mouse.destroy();j(p.layout);p.layout.element.find("."+p.name).remove();var a=p.layout,b=p.name,e=new primitives.common.Rect(0,0,a.element.outerWidth(),a.element.outerHeight()),r=new primitives.common.Rect(e),x=a.element.offset(),A;A=jQuery('<div tabindex="0"></div>');
A.css({position:"relative",overflow:"auto","-webkit-overflow-scrolling":"touch",top:"0px",left:"0px",width:e.width+"px",height:e.height+"px",padding:"0px","margin-bottom":"0px","margin-right":"0px","margin-top":-x.top+Math.floor(x.top)+"px","margin-left":-x.left+Math.floor(x.left)+"px"});A.addClass(b);e=jQuery("<div></div>");e.css({position:"absolute",overflow:"hidden",top:"0px",left:"0px"});e.addClass(b);e.css(r.getCSS());x=jQuery("<div></div>");x.css({position:"absolute",overflow:"hidden",top:"0px",
left:"0px"});x.addClass("placeholder");x.addClass(b);x.css(r.getCSS());r=jQuery("<div></div>");r.css({position:"absolute",overflow:"visible"});r.addClass("calloutplaceholder");r.addClass(b);r.css({top:"0px",left:"0px",width:"0px",height:"0px"});A.append(e);e.append(x);x.append(r);a.element.append(A);a.scrollPanel=A;a.mousePanel=e;a.placeholder=x;a.calloutPlaceholder=r;p.options.enablePanning&&(p.mouse=new primitives.common.Mouse,p.mouse.init(p.layout.element,{name:p.name,onMouseDrag:k,onMouseStop:l,
onMouseCapture:m}));a=p.layout;a.mousePanel.mousemove(function(a){var b=p.layout.mousePanel.offset(),c=a.pageX-b.left,b=a.pageY-b.top,d=p.tasks.getTask("CreateTransformTask"),e=p.tasks.getTask("HighlightItemOptionTask");if(!p.mouse||!p.mouse.isStarted())y=!1,e.hasHighlightEnabled()&&(c=d.getTreeItemForMousePosition(c,b,e.getGravityRadius()),n(a,c))}).click(function(a){if(!p.mouse||!p.mouse.isStarted()){var b=p.layout.mousePanel.offset(),c=a.pageX-b.left,e=a.pageY-b.top,f=p.tasks.getTask("CreateTransformTask"),
b=p.tasks.getTask("CursorItemOptionTask"),g=p.tasks.getTask("HighlightItemOptionTask"),c=f.getTreeItemForMousePosition(c,e,g.getGravityRadius()),h;null!==c&&!y&&(e=jQuery(a.target),e.hasClass(p.name+"button")||0<e.parent("."+p.name+"button").length?(h=e.hasClass(p.name+"button")?e:e.parent("."+p.name+"button"),h=h.data("buttonname"),h=d(p,null,c,h),s("onButtonClick",a,h)):"selectiontext"!==e.attr("name")&&("checkbox"===e.attr("name")?(b=(p.options.selectedItems||[]).slice(0),h=d(p,null,c,h),s("onSelectionChanging",
a,h),e=primitives.common.indexOf(b,c),0<=e?b.splice(e,1):b.push(c),p.options.selectedItems=b,s("onSelectionChanged",a,h)):(h=d(p,null,c,void 0),s("onMouseClick",a,h),!h.cancel&&b.hasCursorEnabled()&&(q(a,c),p.layout.scrollPanel.focus()))))}y=!1}).dblclick(function(a){var b;b=p.tasks.getTask("HighlightItemTask").getHighlightTreeItem();null!==b&&!y&&(b=d(p,null,b,void 0),s("onMouseDblClick",a,b));y=!1});a.scrollPanel.keydown(function(a){var b=p.tasks.getTask("HighlightItemTask"),c=p.tasks.getTask("HighlightItemOptionTask"),
d=p.tasks.getTask("CursorItemTask"),e=p.tasks.getTask("CursorItemOptionTask"),f=p.tasks.getTask("AlignDiagramTask"),g=p.tasks.getTask("CreateTransformTask").getTransform(),h=null,k,i=null,j=p.layout;c.hasHighlightEnabled()&&e.hasCursorEnabled()?(h=b.getHighlightTreeItem(),null===h&&(h=d.getCursorTreeItem())):c.hasHighlightEnabled()?h=b.getHighlightTreeItem():e.hasCursorEnabled()&&(h=d.getCursorTreeItem());if(null!=h){switch(a.which){case 13:e.hasCursorEnabled()&&(q(a,h),a.preventDefault(),j.scrollPanel.focus());
break;case 40:i=1;break;case 38:i=0;break;case 37:i=2;break;case 39:i=3}if(null!=i){for(b=!1;!b;){b=!0;i=g.getOrientation(i);switch(i){case 0:k=f.getNextLevelTreeItem(h,!1);break;case 1:k=f.getNextLevelTreeItem(h,!0);break;case 2:k=f.getNextTreeItem(h,!0);break;case 3:k=f.getNextTreeItem(h,!1)}null!=k&&(a.preventDefault(),c.hasHighlightEnabled()?n(a,k):e.hasCursorEnabled()&&q(a,k))}j.scrollPanel.focus()}}});p.tasks=c(g,h,i);p.graphics=primitives.common.createGraphics(p.options.graphicsType,p.layout.element);
p.graphics.debug=w;p.options.actualGraphicsType=p.graphics.graphicsType;f(!0,w)}}function f(a,b){var c;p.layout.forceCenterOnCursor=a;p.tasks.process("OptionsTask",null,b);p.graphics.end();a&&(c=p.tasks.getTask("CenterOnCursorTask"),c=c.getPlaceholderOffset(),p.layout.scrollPanel.scrollLeft(c.x),p.layout.scrollPanel.scrollTop(c.y))}function g(){return p.options}function h(){return p.graphics}function i(){return p.layout}function j(a){null!=a.mousePanel&&(a.mousePanel.unbind("mousemove"),a.mousePanel.unbind("click"),
a.mousePanel.unbind("dblclick"));null!=a.scrollPanel&&a.scrollPanel.unbind("keydown")}function k(a){var b=new primitives.common.Point(a.pageX,a.pageY),a=-b.x+r.x,b=-b.y+r.y,c=p.layout.scrollPanel;c.css("visibility","hidden");c.scrollLeft(a).scrollTop(b);c.css("visibility","inherit");return!1}function l(){y=!0}function m(a){var b=p.layout.scrollPanel;r=new primitives.common.Point(b.scrollLeft()+a.pageX,b.scrollTop()+a.pageY);return!0}function n(a,b){var c=!0,e;null!==b?b!==p.options.highlightItem&&
(e=d(p,p.options.highlightItem,b,void 0),p.options.highlightItem=b,s("onHighlightChanging",a,e),e.cancel?c=!1:(f(!1,!1),s("onHighlightChanged",a,e))):null!==p.options.highlightItem&&(e=d(p,p.options.highlightItem,null,void 0),p.options.highlightItem=null,s("onHighlightChanging",a,e),e.cancel?c=!1:(f(!1,!1),s("onHighlightChanged",a,e)));return c}function q(a,b){var c;b!==p.options.cursorItem&&(c=d(p,p.options.cursorItem,b,void 0),p.options.cursorItem=b,s("onCursorChanging",a,c),c.cancel||(f(!0,w),
s("onCursorChanged",a,c)))}function s(a,b,c){a=p.options[a];null!=a&&a(b,c)}var p={name:"orgdiagram",options:b,tasks:null,graphics:null,mouse:null,layout:{element:a,scrollPanel:null,mousePanel:null,placeholder:null,calloutPlaceholder:null,forceCenterOnCursor:!0}},r,y,w=!1;e();return{destroy:function(){j(p.layout);p.layout.element.find("."+p.name).remove();p.tasks=null;p.graphics=null},setOptions:function(a){for(var b in a)a.hasOwnProperty(b)&&(p.options[b]=a[b])},getOptions:g,setOption:function(a,
b){return p.options[a]=b},getOption:function(a){return p.options[a]},update:e,getProcessDiagramConfig:function(){return c(g,h,i).getProcessDiagramConfig()}}};
primitives.orgdiagram.Control=function(a,b){return primitives.orgdiagram.BaseControl(a,b,function(a,b,e){var f=new primitives.common.TaskManager;f.addDependency("options",a);f.addDependency("graphics",b);f.addDependency("layout",e);f.addDependency("defaultConfig",new primitives.orgdiagram.Config);f.addDependency("defaultItemConfig",new primitives.orgdiagram.ItemConfig);f.addDependency("defaultTemplateConfig",new primitives.orgdiagram.TemplateConfig);f.addDependency("defaultButtonConfig",new primitives.orgdiagram.ButtonConfig);
f.addDependency("defaultBackgroundAnnotationConfig",new primitives.orgdiagram.BackgroundAnnotationConfig);f.addDependency("defaultConnectorAnnotationConfig",new primitives.orgdiagram.ConnectorAnnotationConfig);f.addDependency("defaultHighlightPathAnnotationConfig",new primitives.orgdiagram.HighlightPathAnnotationConfig);f.addDependency("defaultShapeAnnotationConfig",new primitives.orgdiagram.ShapeAnnotationConfig);f.addDependency("isFamilyChartMode",!1);f.addDependency("showElbowDots",!1);f.addDependency("null",
null);f.addDependency("foreground",2);f.addDependency("background",1);f.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");f.addTask("CurrentControlSizeTask",["layout","OptionsTask","ItemsSizesOptionTask"],primitives.orgdiagram.CurrentControlSizeTask,"#000000");f.addTask("CurrentScrollPositionTask",["layout","OptionsTask"],primitives.orgdiagram.CurrentScrollPositionTask,"#000000");f.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,
"#000080");f.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");f.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.orgdiagram.ItemsOptionTask,"#000080");f.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");f.addTask("LabelsOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.LabelsOptionTask,
"#000080");f.addTask("PrintPreviewOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.PrintPreviewOptionTask,"#000080");f.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");f.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");f.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.VisualTreeOptionTask,
"#000080");f.addTask("MinimizedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.MinimizedItemsOptionTask,"#000080");f.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");f.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");f.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,"#000080");f.addTask("CursorSelectionPathModeOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorSelectionPathModeOptionTask,"#000080");f.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");f.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");f.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig",
"background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");f.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");f.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");f.addTask("ForegroundConnectorAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");f.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");f.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");
f.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");f.addTask("CombinedContextsTask",["ItemsOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");f.addTask("IntervalsTask",["ItemsSizesOptionTask"],primitives.orgdiagram.IntervalsTask,"#00ffff");f.addTask("OrgTreeTask",["ItemsOptionTask"],primitives.orgdiagram.OrgTreeTask,"#ff0000");f.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.orgdiagram.ReadTemplatesTask,"#00ffff");
f.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");f.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.orgdiagram.GroupTitleTemplateTask,"#00ffff");f.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.CheckBoxTemplateTask,"#00ffff");f.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.orgdiagram.ButtonsTemplateTask,"#00ffff");f.addTask("AnnotationLabelTemplateTask",
["ItemsOptionTask"],primitives.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");f.addTask("PrintPreviewTemplateTask",["ItemsOptionTask"],primitives.orgdiagram.PrintPreviewTemplateTask,"#00ffff");f.addTask("VisualTreeTask",["OrgTreeTask","ItemTemplateParamsTask","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");f.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");f.addTask("VisualTreeMarginsTask",
["VisualTreeTask"],primitives.orgdiagram.VisualTreeMarginsTask,"#ff0000");f.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");f.addTask("HighlightItemTask",["HighlightItemOptionTask","VisualTreeLevelsTask"],primitives.orgdiagram.HighlightItemTask,"#00ffff");f.addTask("CursorItemTask",["CursorItemOptionTask","VisualTreeLevelsTask"],primitives.orgdiagram.CursorItemTask,
"#00ffff");f.addTask("CursorNeighboursTask",["CursorItemTask","VisualTreeTask"],primitives.orgdiagram.CursorNeighboursTask,"#00ffff");f.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");f.addTask("SelectionPathItemsTask",["VisualTreeTask","CursorItemTask","SelectedItemsTask","CursorSelectionPathModeOptionTask"],primitives.orgdiagram.SelectionPathItemsTask,"#00ffff");f.addTask("NormalVisibilityItemsByForegroundShapeAnnotationTask",["ForegroundShapeAnnotationOptionTask"],
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundShapeAnnotationTask",["BackgroundShapeAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundAnnotationTask",["BackgroundAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByForegroundHighlightPathAnnotationTask",["ForegroundHighlightPathAnnotationOptionTask"],
primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask",["BackgroundHighlightPathAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByForegroundConnectorAnnotationTask",["ForegroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");f.addTask("NormalVisibilityItemsByBackgroundConnectorAnnotationTask",
["BackgroundConnectorAnnotationOptionTask"],primitives.orgdiagram.NormalVisibilityItemsByConnectorAnnotationTask,"#00ffff");f.addTask("CombinedNormalVisibilityItemsTask","ItemsSizesOptionTask CursorItemTask CursorNeighboursTask SelectedItemsTask SelectionPathItemsTask NormalVisibilityItemsByForegroundShapeAnnotationTask NormalVisibilityItemsByBackgroundShapeAnnotationTask NormalVisibilityItemsByBackgroundAnnotationTask NormalVisibilityItemsByForegroundHighlightPathAnnotationTask NormalVisibilityItemsByBackgroundHighlightPathAnnotationTask NormalVisibilityItemsByForegroundConnectorAnnotationTask NormalVisibilityItemsByBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.CombinedNormalVisibilityItemsTask,"#00ffff");f.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask IntervalsTask VisualTreeTask VisualTreeLevelsTask VisualTreeMarginsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.orgdiagram.ItemsPositionsTask,"#ff0000");f.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask PrintPreviewOptionTask CurrentControlSizeTask VisualTreeLevelsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");f.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");f.addTask("CenterOnCursorTask","layout CurrentControlSizeTask CurrentScrollPositionTask CursorItemTask AlignDiagramTask CreateTransformTask ScaleOptionTask".split(" "),primitives.orgdiagram.CenterOnCursorTask,"#00ffff");f.addTask("BackgroundAnnotationManagerTask",["ItemsSizesOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],
primitives.orgdiagram.BackgroundAnnotationManagerTask,"#00ffff");f.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");f.addTask("ApplyLayoutChangesTask","graphics layout ItemsSizesOptionTask PrintPreviewOptionTask CurrentControlSizeTask ScaleOptionTask AlignDiagramTask".split(" "),primitives.orgdiagram.ApplyLayoutChangesTask,"#008000");f.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask BackgroundAnnotationManagerTask".split(" "),
primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");f.addTask("DrawBackgroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","ForegroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","foreground"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");f.addTask("DrawForegroundHighlightPathAnnotationTask",["graphics","ConnectorsOptionTask","BackgroundHighlightPathAnnotationOptionTask","ConnectionsGraphTask","background"],primitives.orgdiagram.DrawHighlightPathAnnotationTask,
"#00ffff");f.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");f.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");f.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");f.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");f.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawCursorTask,"#008000");f.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightTask,
"#008000");f.addTask("DrawHighlightAnnotationTask","layout graphics CreateTransformTask ApplyLayoutChangesTask ScaleOptionTask CombinedContextsTask CalloutOptionTask ReadTemplatesTask AlignDiagramTask CenterOnCursorTask HighlightItemTask CursorItemTask SelectedItemsTask".split(" "),primitives.orgdiagram.DrawHighlightAnnotationTask,"#008000");f.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask".split(" "),
primitives.orgdiagram.DrawTreeItemsTask,"#008000");f.addTask("DrawMinimizedItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask MinimizedItemsOptionTask ItemTemplateParamsTask AlignDiagramTask".split(" "),primitives.orgdiagram.DrawMinimizedItemsTask,"#008000");f.addTask("DrawConnectorsTask",["graphics","ConnectionsGraphTask","ConnectorsOptionTask","showElbowDots","PaletteManagerTask"],primitives.orgdiagram.DrawConnectorsTask,"#008000");f.addTask("DrawItemLabelsTask","graphics CreateTransformTask ApplyLayoutChangesTask LabelsOptionTask VisualTreeLevelsTask AlignDiagramTask".split(" "),
primitives.orgdiagram.DrawItemLabelsTask,"#008000");f.addTask("DrawPrintPreviewTask","graphics ApplyLayoutChangesTask PrintPreviewOptionTask AlignDiagramTask PrintPreviewTemplateTask ScaleOptionTask".split(" "),primitives.orgdiagram.DrawPrintPreviewTask,"#008000");return f},function(a,b,e,f){var g=new primitives.orgdiagram.EventArgs,h=a.tasks.getTask("CombinedContextsTask"),i=a.tasks.getTask("AlignDiagramTask"),b=h.getConfig(b),j=h.getConfig(e);b&&null!=b.id&&(g.oldContext=b);j&&null!=j.id&&(g.context=
j,null!==j.parent&&(g.parentItem=h.getConfig(j.parent)),h=a.layout.mousePanel.offset(),a=a.layout.element.offset(),e=i.getItemPosition(e),g.position=(new primitives.common.Rect(e.actualPosition)).translate(h.left,h.top).translate(-a.left,-a.top));null!=f&&(g.name=f);return g})};primitives.common.perimeter.Item=function(a,b){var c,d,e;this.id=a;this.segments=new primitives.common.LinkedHashItems;if(null!=b){c=0;for(d=b.length;c<d;c+=1)e=b[c],this.segments.add(e.key,e)}};
primitives.common.perimeter.Manager=function(a){function b(a){var b,g,h;b=0;for(g=a.length;b<g;b+=1)h=a[b],c[h.id]=h,h.segments.iterate(function(a){d[a.key]=h})}var c={},d={};null!=a&&b(a);return{add:b,getMergedPerimeters:function(a){var b=[],g={},h,i,j,k,l,m;h=0;for(i=a.length;h<i;h+=1)j=a[h],g[j]=!c.hasOwnProperty(j);h=0;for(i=a.length;h<i;h+=1)if(j=a[h],!g[j]){g[j]=!0;k=new primitives.common.perimeter.Item(j);j=c[j];j.segments.iterate(function(a){k.segments.add(a.key,a)});b.push(k);for(l=k.segments.startKey();null!=
l;){m=k.segments.item(l);d.hasOwnProperty(m.oppositeKey)&&(j=d[m.oppositeKey],g.hasOwnProperty(j.id)&&!g[j.id]&&(g[j.id]=!0,j.segments.iterateBack(function(a){a.key!=m.oppositeKey&&k.segments.insertAfter(l,a.key,a)},m.oppositeKey,null),j.segments.iterateBack(function(a){k.segments.insertAfter(l,a.key,a)},null,m.oppositeKey)));j=k.segments;for(var n=m,q=j.nextKey(n.key),s=void 0;null!=n&&n.oppositeKey==(s=q||j.startKey());)null!=q&&(q=j.nextKey(q)),j.remove(n.key),j.remove(s),n=j.item(null!=q?j.prevKey(q):
j.endKey());l=q}}return b}}};
primitives.common.perimeter.SegmentItem=function(a,b,c,d){this.toPoint=this.fromPoint=null;switch(arguments.length){case 2:this.fromPoint=a;this.toPoint=b;break;case 4:this.fromPoint=new primitives.common.Point(a,b),this.toPoint=new primitives.common.Point(c,d)}var e=this.fromPoint.toString(),f=this.toPoint.toString();if(e==f)throw"Null length segment!";this.key=e+" - "+f;this.oppositeKey=f+" - "+e;this.orientationType=null;this.orientationType=this.fromPoint.y>this.toPoint.y?3:this.fromPoint.y<this.toPoint.y?
2:this.fromPoint.x>this.toPoint.x?0:1};
primitives.common.mergeSort=function(a,b,c){var d=null,e,f,g,h,i,j,k,l,m,n,q,s;switch(a.length){case 0:d=[];break;default:d=[];for(g=0;g<a.length;g+=1){e=a[g];f=[];j=d.length;k=e.length;i=h=0;q=m=n=l=null;0<j&&(l=d[h],n=!b?l:b(l));0<k&&(m=e[i],q=!b?m:b(m));for(s=null;h<j||i<k;)if(h>=j){if(!c||s!=m)f.push(m),s=m;i+=1;i<k&&(m=e[i],q=!b?m:b(m))}else if(i>=k){if(!c||s!=l)f.push(l),s=l;h+=1;h<j&&(l=d[h],n=!b?l:b(l))}else if(n<q){if(!c||s!=l)f.push(l),s=l;h+=1;h<j&&(l=d[h],n=!b?l:b(l))}else{if(!c||s!=m)f.push(m),
s=m;i+=1;i<k&&(m=e[i],q=!b?m:b(m))}d=f}}return d};primitives.common.binarySearch=function(a,b){var c=null,d,e,f=0,g=a.length-1,h,i;if(0<a.length&&(c=a[f],d=b(c),0<d))if(e=Math.abs(d),i=a[g],d=b(i),0<=d)c=i;else{d=Math.abs(d);e>d&&(e=d,c=i);for(;f+1<g;)if(h=Math.round((f+g)/2),i=a[h],d=b(i),0===d){c=i;break}else 0<d?f=h:g=h,d=Math.abs(d),e>d&&(e=d,c=i)}return c};
primitives.common.dependencies=function(){function a(a,b,c,d){var e,b=b[c];if(null!=b)for(e in b)if(b.hasOwnProperty(e)&&d.call(a,e,b[e]))break}function b(b,c,d,e,f,l){var m,n,q,s,p;if(null!=l){d=[];n={};for(m in f)f.hasOwnProperty(m)&&(n[m]=f[m]);for(m in c)c.hasOwnProperty(m)&&!n.hasOwnProperty(m)&&(n[m]=0,d.push(m));for(p=s=0;0<d.length;){q=[];f=0;for(e=d.length;f<e;f+=1){m=d[f];if(l.call(b,m,s,p)){q=[];break}s+=1;a(this,c,m,function(a){n[a]-=1;0===n[a]&&q.push(a)})}d=q;p+=1}}}var c={},d={},e=
{},f={};return{add:function(a,b,i){if(null==a||null==b)throw"Node id should not be null!";if((null==c[a]||null==c[a][b])&&null!=i)null==c[a]&&(c[a]={},d[a]=0),null==c[a][b]&&(c[a][b]=i,d[a]+=1),null==e[b]&&(e[b]={},f[b]=0),null==e[b][a]&&(e[b][a]=i,f[b]+=1)},dependency:function(a,b){var d=null;null!=c[a]&&c[a][b]&&(d=c[a][b]);return d},dependencyBackward:function(a,b){var c=null;null!=e[a]&&e[a][b]&&(c=e[a][b]);return c},countForward:function(a){return d[a]||0},countBackword:function(a){return f[a]||
0},loopForward:function(b,d,e){null!=e&&null!=d&&a(b,c,d,e)},loopBackward:function(b,c,d){null!=d&&null!=c&&a(b,e,c,d)},firstForward:function(b){var d=null;null!=b&&a(this,c,b,function(a){d=a;return!0});return d},firstBackward:function(b){var c=null;null!=b&&a(this,e,b,function(a){c=a;return!0});return c},loopTopoForward:function(a,h){b(a,c,d,e,f,h)},loopTopoBackward:function(a,h){b(a,e,f,c,d,h)}}};
primitives.common.family=function(a){function b(a,b,c,d){var e;if(null!=d&&(b=b[c],null!=b))for(e in b)if(b.hasOwnProperty(e)&&d.call(a,e))break}function c(a,b){var c=!1;null!=z[a]&&null!=z[a][b]&&(delete z[a][b],v[a]-=1,delete x[b][a],A[b]-=1,v[a]||(delete z[a],delete v[a]),x[b]||(delete x[b],delete A[b],null==t[null]&&(t[null]={},u[null]=0),t[null][b]=!0,u[null]+=1),c=!0);return c}function d(a,b){var c;if(null!=b)for(c in B)if(B.hasOwnProperty(c)&&b.call(a,c,B[c]))break}function e(a,c,d,e){for(var f,
g,h={},k=0,i=!0;i;){f={};i=!1;for(g in d)if(d.hasOwnProperty(g)&&!h[g])switch(h[g]=!0,e.call(a,g,B[g],k)){case 1:f={};i=!1;break;case 2:break;default:b(this,c,g,function(a){h[a]||(i=f[a]=!0)})}d=f;k+=1}}function f(a,b,c){null!=c&&null!=b&&(null!=B[b]&&null!=z[b])&&e(a,z,z[b],c)}function g(a,b,c){null!=c&&null!=b&&(null!=B[b]&&null!=x[b])&&e(a,x,x[b],c)}function h(a,c,d,e,f,g){var h,k,i,j;if(null!=g){c=[];k={};for(h in B)B.hasOwnProperty(h)&&(k[h]=d[h]||0,k[h]||c.push(h));for(j=0;0<c.length;){i=[];
d=0;for(f=c.length;d<f;d+=1){h=c[d];if(g.call(a,h,B[h],j)){i=[];break}j+=1;b(this,e,h,function(a){k[a]-=1;0===k[a]&&i.push(a)})}c=i}}}function i(a,b){h(a,x,A,z,v,b)}function j(a,b){h(a,z,v,x,A,b)}function k(a,b,c,d,e,f,g,h,k){var i=!1,j,l;if(null!=B[a]&&null!=g[a]){i=!0;if(k){k=0;for(j=b.length;k<j;k+=1)if(l=b[k],null==B[l]||null==g[a][l])i=!1}if(i&&(null!=d&&(B[c]=d),null!=B[c])){e[c]||(e[c]={},f[c]=0);g[c]||(g[c]={},h[c]=0);e[c][a]||(e[c][a]=!0,f[c]+=1);g[a][c]||(g[a][c]=!0,h[a]+=1);k=0;for(j=b.length;k<
j;k+=1)l=b[k],c!=l&&(null!=g[a][l]&&(delete g[a][l],h[a]-=1),null!=e[l][a]&&(delete e[l][a],f[l]-=1),e[l][c]||(e[l][c]=!0,f[l]+=1),g[c][l]||(g[c][l]=!0,h[c]+=1))}}return i}function l(a,b,c,d){return k(a,b,c,d,x,A,z,v,!0)}function m(){this.key=this.id="";this.children=[];this.childrenHash={};this.processed=!1}function n(a){this.items=[];this.difference=this.weight=0;0<arguments.length&&(this.difference=a)}function q(a){var c=primitives.common.graph(),d,e,f,g,h,k,i,j,l={};for(d in a)a.hasOwnProperty(d)&&
b(this,z,d,function(d){if(!l.hasOwnProperty(d)){l[d]=!0;e=[];b(this,x,d,function(a){e.push(a)});f=0;for(h=e.length;f<h-1;f+=1)if(k=e[f],a.hasOwnProperty(k))for(g=f+1;g<h;g+=1)if(i=e[g],a.hasOwnProperty(i)){j=Math.abs(a[k].children.length-a[i].children.length);var m=c.edge(k,i);null==m&&(m=new n(j),c.addEdge(k,i,m));m.items.push(d);m.weight+=1}}});return c}function s(a,b){this.parentid=a;this.childid=b;this.key=a+","+b}function p(a){return v[a]||0}function r(a){return A[a]||0}function y(a){var b=null,
a=z[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null}function w(){return primitives.common.family({roots:t,rootsCount:u,children:z,childrenCount:v,parents:x,parentsCount:A,nodes:B})}var t={},u={},z={},v={},x={},A={},B={};primitives.common.isObject(a)&&(t=primitives.common.cloneObject(a.roots,!1),u=primitives.common.cloneObject(a.rootsCount,!0),z=primitives.common.cloneObject(a.children,!1),v=primitives.common.cloneObject(a.childrenCount,!0),x=primitives.common.cloneObject(a.parents,!1),
A=primitives.common.cloneObject(a.parentsCount,!0),B=primitives.common.cloneObject(a.nodes,!0));return{add:function(a,c,d){var e,f,g={};if(!a||0===a.length)a=[null];if(null==B[c]&&null!=d){B[c]=d;d=0;for(e=a.length;d<e;d+=1)f=a[d],null==g[f]&&f!=c&&(g[f]=!0,null!=B[f]?(null==x[c]&&(x[c]={},A[c]=0),x[c][f]||(x[c][f]=!0,A[c]+=1),null==z[f]&&(z[f]={},v[f]=0),z[f][c]||(z[f][c]=!0,v[f]+=1)):(null==t[f]&&(t[f]={},u[f]=0),t[f][c]||(t[f][c]=!0,u[f]+=1)));null!=t[c]&&(z[c]=t[c],v[c]=u[c],delete t[c],delete u[c],
b(this,z,c,function(a){null==x[a]&&(x[a]={},A[a]=0);x[a][c]||(x[a][c]=!0,A[a]+=1)}))}},adopt:function(a,b){var c,d,e;if(null!=B[b]){c=0;for(d=a.length;c<d;c+=1)if(e=a[c],null==x[b]&&(x[b]={},A[b]=0),e!=b&&null!=B[e])x[b][e]||(x[b][e]=!0,A[b]+=1),null==z[e]&&(z[e]={},v[e]=0),z[e][b]||(z[e][b]=!0,v[e]+=1);else throw"Item cannot be parent of itself and parent should exist in the structure!";}else throw"Child should be in hierarchy!";},bundleChildren:l,bundleParents:function(a,b,c,d){return k(a,b,c,d,
z,v,x,A,!0)},optimizeReferences:function(a){var c={},d={},e={},g,h,i,j,l,n;l=0;var p=10,s;if(null!=a){for(g in B)l+=1,B.hasOwnProperty(g)&&(h=new m,b(this,z,g,function(a){h.children.push(a);h.childrenHash[a]=!0}),h.children.sort(),h.id=g,h.key=h.children.join(","),e[h.id]=h);for(p=Math.pow(10,l.toString().length);!primitives.common.isEmptyObject(e);){i={};s={};j=q(e);for(g in e)e.hasOwnProperty(g)&&(l=e[g],l.processed||(n=j.getSpanningTree(g,function(a){return a.weight*p+p-a.difference}),n.loopLevels(this,
function(b,g){e[b].processed=!0;n.loopChildren(this,b,function(h,l){var n=j.edge(b,h),p=null,q,r,t,u,y,w;e[h].processed=!0;if(1<n.weight){r=n.items.join(",");if(c.hasOwnProperty(r))p=c[r];else{q=a();B[q.id]=q;p=new m;p.id=q.id;p.key=r;r=0;for(t=n.items.length;r<t;r+=1)w=n.items[r],p.children.push(w),p.childrenHash[w]=!0,s[w]=!0;p.children.sort();c[p.key]=p;d[p.id]=p;i[p.id]=p;s[p.id]=p;u=p.children.slice(0);f(this,g.replacementItem||b,function(a){!p.childrenHash[a]&&null!=d[a]&&(y=!0,f(this,a,function(a){if(!p.childrenHash[a])return y=
!1,1;if(!s.hasOwnProperty(a))return 2}),y&&u.push(a));return 2});k(g.replacementItem||b,u,p.id,q,x,A,z,v,!1);if(1>=(v[b]||0)&&null==g.replacementItem)g.replacementItem=p.id}if(p.id!=h&&(u=p.children.slice(0),f(this,l.replacementItem||h,function(a){null!=d[a]&&!p.childrenHash[a]&&(y=!0,f(this,a,function(a){return!p.childrenHash[a]?(y=!1,1):(s.hasOwnProperty(a),2)}),y&&u.push(a));return 2}),k(l.replacementItem||h,u,p.id,null,x,A,z,v,!1),1>=(v[h]||0)&&null==l.replacementItem))l.replacementItem=p.id}})})));
e=i}}},eliminateManyToMany:function(a){var c,d;for(c in z)z.hasOwnProperty(c)&&1<(v[c]||0)&&b(this,z,c,function(b){if(1<(A[b]||0))d=a(),l(c,[b],d.id,d)})},getPlanarFamily:function(a){var b=new primitives.common.family,c,d;a.loopLevels(this,function(e){var g=new primitives.common.LinkedHashItems,h={},k={},i=[];a.loopLevelItems(this,e,function(b){f(this,b,function(c){var d=a.getItemPosition(c),e=new s(b,c);k[e.key]=e;var f=[];g.isEmpty()?g.add(d,[e]):(g.iterateBack(function(a,c){if(c<d)return g.insertAfter(c,
d,[e]),!0;if(c==d)return a.push(e),!0;for(var h=0,k=a.length;h<k;h+=1){var i=a[h];i.parentid!=b&&f.push(i)}}),g.startKey()>d&&g.unshift(d,[e]));h[e.key]=f;for(var c=0,i=f.length;c<i;c+=1)h[f[c].key].push(e);return 2});if(1==p(b)){var c=y(b);1==r(c)&&(c=new s(b,c),i.push(c.key))}});var e=[],l,j;for(j in h){l=h[j];var n=l.length;null!=e[n]?e[n].push(j):e[n]=[j]}n={};e.unshift(i);for(var m=0,q=e.length;m<q;m+=1){var t=e[m];if(null!=t){c=0;for(d=t.length;c<d;c+=1)if(j=t[c],!n.hasOwnProperty(j)){n[j]=
!0;l=k[j];null==b.node(l.parentid)&&b.add(null,l.parentid,{});null==b.node(l.childid)?b.add([l.parentid],l.childid,{}):b.adopt([l.parentid],l.childid);l=h[j];j=0;for(var u=l.length;j<u;j+=1)n[l[j].key]=!0}}}});return b},removeNode:function(a){null!=B[a]&&(b(this,z,a,function(b){delete x[b][a];A[b]-=1;A[b]||(delete x[b],delete A[b],null==t[null]&&(t[null]={},u[null]=0),t[null][b]||(t[null][b]=!0,u[null]+=1))}),b(this,x,a,function(b){delete z[b][a];v[b]-=1;v[b]||(delete z[b],delete v[b])}),null!=t[null]&&
null!=t[null][a]&&(delete t[null][a],u[null]-=1,u[null]||(delete t[null],delete u[null])),delete z[a],delete v[a],delete x[a],delete A[a],delete B[a])},removeRelation:function(a,b){var d=!1;null!=B[a]&&null!=B[b]&&(d=c(a,b)||c(b,a));return d},node:function(a){return B[a]},loop:d,loopLevels:function(a,c,d){function e(){this.items={};this.minimumLevel=null}function f(a,b,c){var d=m[b];d||(d=new e,m[b]=d);d.addItemToLevel(a,c);u=null==u?c:Math.min(u,c);n[a]=c;k[a]=!0}var g=[],h={},k={},l=[],n={},m={},
p,q,s,r,t,u=null;s=c?i:j;var y,v,w,A,L,S,$,Y;e.prototype.addItemToLevel=function(a,b){var c=this.items[b];c?c.push(a):(c=[a],this.items[b]=c);this.minimumLevel=null==this.minimumLevel?b:Math.min(this.minimumLevel,b)};if(null!=d){s(this,function(a,b,c){g.push(a);h[a]=c});s=0;for(y=g.length;s<y;s+=1)if(p=g[s],null==k[p]){l.push(p);for(f(p,s,0);0<l.length;){L=A=w=null;S=!c;$=[];p=0;for(r=l.length;p<r;p+=1)t=l[p],v=n[t],Y=!1,c?(b(this,x,t,function(a){var b;if(!k[a]&&(Y=!0,b=h[a],null==w||!S||w<b||w==
b&&L>v-1))w=b,A=a,L=v-1,S=!0}),b(this,z,t,function(a){var b;if(!k[a]&&(Y=!0,b=h[a],null==w||!S&&(w>b||w==b&&L<v+1)))w=b,A=a,L=v+1,S=!1})):(b(this,z,t,function(a){var b;if(!k[a]&&(Y=!0,b=h[a],null==w||S||w<b||w==b&&L<v+1))w=b,A=a,L=v+1,S=!1}),b(this,x,t,function(a){var b;if(!k[a]&&(Y=!0,b=h[a],null==w||S&&(w>b||w==b&&L>v-1)))w=b,A=a,L=v-1,S=!0})),Y&&$.push(t);null!=A&&($.push(A),f(A,s,L));l=$}}l=!0;for(c=u;l;){p={};l=!1;for(q in m)if(m.hasOwnProperty(q)&&(s=m[q],r=s.items[s.minimumLevel-u+c],null!=
r)){p[q]=s;l=!0;s=0;for(y=r.length;s<y;s+=1)if(t=r[s],d.call(a,t,B[t],c-u))return l=!1,!0}m=p;c+=1}}},loopTopo:i,loopTopoReversed:j,loopChildren:f,loopParents:g,findLargestRoot:function(){var a=null,b,c={},d={},e;b=null;j(this,function(f,h){c.hasOwnProperty(f)||(c[f]={},d[f]=0);c[f][f]=!0;d[f]+=1;e=!0;g(this,h.id,function(a){var b,g;e=!1;c.hasOwnProperty(a)||(c[a]={},d[a]=0);if(!d[a]&&1==A[f])c[a]=c[f],d[a]=d[f];else for(g in b=c[f],b)b.hasOwnProperty(g)&&(c[a][g]=!0,d[a]+=1);return 2});if(e&&(!b||
d[f]>b))b=d[f],a=f});return a},loopRoots:function(a,b){var c=null,d,e=0,f={},h={},k,i={},l={},n,m,p,q,s,r,t;j(this,function(a,b){f.hasOwnProperty(a)||(f[a]={},h[a]=0);f[a][a]=!0;h[a]+=1;k=!0;g(this,b.id,function(b){var c,d;k=!1;f.hasOwnProperty(b)||(f[b]={},h[b]=0);if(!h[b]&&1==A[a])f[b]=f[a],h[b]=h[a];else for(d in c=f[a],c)c.hasOwnProperty(d)&&!f[b][d]&&(f[b][d]=!0,h[b]+=1);return 2});k&&(i[a]=!0,e+=1)});q={};for(p in i)if(i.hasOwnProperty(p))for(m in d=f[p],d)d.hasOwnProperty(m)&&(q[m]||(q[m]=
[]),q[m].push(p.toString()));for(;0<e;){d=null;for(n in i)if(i.hasOwnProperty(n)&&(!d||h[n]<d))d=h[n],c=n;if(null!=c){null!=b&&b.call(a,c,B[c]);d=f[c];for(m in d)if(d.hasOwnProperty(m)&&!l[m]){p=q[m];r=0;for(t=p.length;r<t;r+=1)s=p[r],h[s]-=1;l[m]=!0}delete i[c];e-=1}}},hasNodes:function(){return!primitives.common.isEmptyObject(B)},hasCommonChild:function(a){var c=!1,d,e,f,g,h,k,i;d={};g=f=0;for(h=a.length;g<h;g+=1)k=a[g],null!=B[k]&&!d[k]&&(d[k]=!0,f+=1);e={};for(k in d)d.hasOwnProperty(k)&&b(this,
z,k,function(a){e[a]=e[a]?e[a]+1:1});for(i in e)if(e.hasOwnProperty(i)&&null!=x[i]&&(A[i]||0)==e[i]&&e[i]==f){c=!0;break}return c},loopNeighbours:function(a,b,c){var d={};null!=c&&(f(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,1)&&(d[b]=2,g(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,2)&&(d[b]=2));return d[b]})));return d[b]}),g(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=null,c.call(a,b,e,1)&&(d[b]=2,f(this,b,function(b,e){d.hasOwnProperty(b)||(d[b]=
!0,c.call(a,b,e,2)&&(d[b]=2));return d[b]})));return d[b]}))},countChildren:p,countParents:r,firstParent:function(a){var b=null,a=x[a]||{};for(b in a)if(a.hasOwnProperty(b))return b;return null},firstChild:y,validate:function(a){function c(a){var b=0,d;if(null!=a)for(d in a)a.hasOwnProperty(d)&&(b+=1);return b}var e,f;d(this,function(c){b(this,z,c,function(b){if(!x.hasOwnProperty(b)||!x[b].hasOwnProperty(c))return null!=a&&(a.message="Child #"+b+" does not reference parent #"+c),!1});b(this,x,c,function(b){if(!z.hasOwnProperty(b)||
!z[b].hasOwnProperty(c))return null!=a&&(a.message="Parent #"+b+" does not reference child #"+c),!1})});for(e in x)if(x.hasOwnProperty(e)){if((A[e]||0)!=c(x[e]))return null!=a&&(a.message="Parents count for item #"+e+" missmatch."),!1;if(x.hasOwnProperty(e)&&!B.hasOwnProperty(e))return null!=a&&(a.message="Orphant parents for item #"+e),!1}for(f in z)if(z.hasOwnProperty(f)){if((v[f]||0)!=c(z[f]))return null!=a&&(a.message="Children count for item "+f+" missmatch."),!1;if(z.hasOwnProperty(f)&&!B.hasOwnProperty(f))return null!=
a&&(a.message="Orphant children of item "+f),!1}for(f in t)if(t.hasOwnProperty(f)){if((u[f]||0)!=c(t[f]))return null!=a&&(a.message="Root children count for item @"+f+" missmatch."),!1;b(this,t,f,function(b){if(!B.hasOwnProperty(b))return null!=a&&(a.message="Child #"+b+"of root #"+f+" does not exists."),!1})}return!0},hasLoops:function(){var a=w();i(this,function(b){a.removeNode(b)});return a.hasNodes()},clone:w,BREAK:1,SKIP:2}};
primitives.common.FibonacciHeap=function(a){function b(a){this.key=a.key;this.priority=a.priority;this.item=a.item}function c(a,b,c){this.key=a;this.priority=b;this.item=c;this.degree=0;this.marked=!1;this.right=this.left=this.child=this.parent=null}function d(a,b){var c=n[a.right];b.right=a.right;b.left=a.key;a.right=b.key;c.left=b.key}function e(a){var b=n[a.left],c=n[a.right];b.right=c.key;c.left=b.key;a.right=a.key;a.left=a.key}function f(){var a=null;null!=m&&(a=new b(n[m]));return a}function g(){var a=
f();if(null!=a){var b=n[m],c=n[b.right];if(null!=b.child){var d=n[b.child],g=n[d.left];b.right=d.key;c.left=g.key;d.left=b.key;g.right=c.key;e(b);delete n[b.key];m=null;h(d.key)}else e(b),delete n[b.key],m=null,c.key!=b.key&&h(c.key)}return a}function h(b){var c=[],d,e={};for(d=b;!e.hasOwnProperty(d);){var b=n[d],f=b.right;e[d]=!0;for(b.parent=null;null!=(d=c[b.degree]);)(a?b.priority>d.priority:b.priority<d.priority)?i(b,d):(i(d,b),b=d),c[b.degree-1]=null;c[b.degree]=b;if(null==m||null==n[m]||(a?
n[m].priority<=b.priority:n[m].priority>=b.priority))m=b.key;d=f}}function i(b,c){b.degree+=1;e(c);var f=n[b.child];if(null!=f){if(d(f,c),a?f.priority<c.priority:f.priority>c.priority)b.child=c.key}else b.child=c.key;c.parent=b.key}function j(b,c){var d=n[b];if(a?d.priority>c:d.priority<c)throw"Priority increase is not supported";d.priority=c;if(null!=d.parent){var e=n[d.parent];if(a?e.priority<d.priority:e.priority>d.priority)k(e,d),l(e)}if(a?n[m].priority<d.priority:n[m].priority>d.priority)m=d.key}
function k(a,b){b.marked=!1;b.parent=null;b.right==b.key?a.child=null:(a.child=b.right,e(b));a.degree-=1;d(n[m],b)}function l(a){if(null!=a.parent)if(a.marked){var b=n[a.parent];k(b,a);l(b)}else a.marked=!0}var m=null,n={};return{add:function(b,e,f){if(n.hasOwnProperty(b))throw"Duplicate keys are not supported!";e=new c(b,e,f);n[b]=e;if(null==m)e.left=b,m=e.right=b;else if(f=n[m],d(f,e),a?f.priority<e.priority:f.priority>e.priority)m=b},getPriority:function(a){var b=null;n.hasOwnProperty(a)&&(b=n[a].priority);
return b},setPriority:j,heapRoot:f,extractRoot:g,deleteKey:function(b){j(b,a?Infinity:-1);g()},validate:function(){var a=0,b;for(b in n)if(n.hasOwnProperty(b)){var c=n[b],a=a+1;if(null!=c.child){if(!n.hasOwnProperty(c.child))throw"Child does not exists";var d=n[c.child];if(d.parent!=c.key)throw"Child references wrong parent";}if(null!=c.parent&&!n.hasOwnProperty(c.parent))throw"Parent does not exists";if(null!=c.left){if(!n.hasOwnProperty(c.left))throw"Left does not exists";d=n[c.left];if(d.right!=
c.key)throw"Left references wrong right";}if(null!=c.right){if(!n.hasOwnProperty(c.right))throw"Right does not exists";d=n[c.right];if(d.left!=c.key)throw"Right references wrong left";}}if(null==m&&0<a)throw"Orphans";if(null!=m){if(!n.hasOwnProperty(m))throw"Root node does not exists";c=n[m];if(null!=c.parent)throw"Root node has parent reference";b=[m];c={};for(d=0;0<b.length;){for(var e=[],f=0,g=b.length;f<g;f+=1)for(var h=n[b[f]];!c.hasOwnProperty(h.key);)c[h.key]=!0,d+=1,null!=h.child&&e.push(h.child),
h=n[h.right];b=e}if(a!=d)throw"Tree has loops or orpants";}}}};
primitives.common.graph=function(){function a(a,d,e,f){var g=[],h,i,j,k;g.push(d);e[d]=!0;if(null!=f)for(;0<g.length;){d=[];i=0;for(j=g.length;i<j;i+=1)for(k in h=g[i],f.call(a,h),h=b[h],h)h.hasOwnProperty(k)&&!e.hasOwnProperty(k)&&(e[k]=!0,d.push(k));g=d}}var b={};return{addEdge:function(a,d,e){if((null==b[a]||null==b[a][d])&&null!=e)null==b[a]&&(b[a]={}),b[a][d]=e,null==b[d]&&(b[d]={}),b[d][a]=e},edge:function(a,d){var e=null;null!=b[a]&&b[a][d]&&(e=b[a][d]);return e},hasNode:function(a){return b.hasOwnProperty(a)},
loopNodes:function(c,d,e){c={};if(null==d)for(d in b)b.hasOwnProperty(d)&&(c.hasOwnProperty[d]||a(this,d,c,e));else a(this,d,c,e)},loopNodeEdges:function(a,d,e){var f;if(null!=e&&(d=b[d],null!=d))for(f in d)d.hasOwnProperty(f)&&e.call(a,f,d[f])},getSpanningTree:function(a,d){var e=primitives.common.tree(),f=primitives.common.FibonacciHeap(!0),g,h={},i,j,k,l;f.add(a,0,null);for(h[a]=null;null!=(g=f.extractRoot());){i=b[g.key];for(j in i)i.hasOwnProperty(j)&&!e.node(j)&&(k=null!=d?d(i[j]):i[j],l=f.getPriority(j),
null==l?(f.add(j,k,null),h[j]=g.key.toString()):l<=k&&(f.setPriority(j,k),h[j]=g.key.toString()));e.add(h[g.key],g.key.toString(),{})}return e},getGrowthSequence:function(a){var d=[],e,f={},g;e=[];var h,i={},j=0,k,l,m,n,q,s;if(null!=a){e=null;m=0;n=null;for(h in b)if(b.hasOwnProperty(h)){l=b[h];m=0;for(k in l)l.hasOwnProperty(k)&&(m+=a(l[k]));if(m>n||null==n)e=h,n=m}if(null!=e){d.push(e);f[e]=!0;j+=1;for(i[e]=null;0<j;){e=[];l=k=null;m={};for(g in f)if(f.hasOwnProperty(g)){n=b[g];h=!1;for(q in n)if(n.hasOwnProperty(q)&&
!i.hasOwnProperty(q)&&(s=a(n[q]),h=!0,null==m[q]&&(m[q]=0),m[q]+=s,!l||m[q]>l))k=q,l=m[q];h||e.push(g)}if(null==k)break;else f[k]=!0,j+=1,i[k]=!0,d.push(k);h=0;for(k=e.length;h<k;h+=1)delete f[e[h]],j-=1}}}return d},getShortestPath:function(a,d,e,f,g){var h=primitives.common.FibonacciHeap(!1),i={},j={},k,l,m={},n=0,q=0,i=0;for(l=e.length;i<l;i+=1)k=e[i],m.hasOwnProperty(k)||(n+=1,m[k]=!0);h.add(d,0,null);for(j[d]=null;null!=(d=h.extractRoot());){e=b[d.key];for(k in e)e.hasOwnProperty(k)&&(l=d.priority+
(null!=f?f.call(a,e[k],d,k):1),i=h.getPriority(k),null!=i?i>l&&(h.setPriority(k,l),j[k]=d.key):j.hasOwnProperty(k)||(h.add(k,l,null),j[k]=d.key));if(m.hasOwnProperty(d.key)){i=[];for(e=d.key;null!=e;)i.push(e),e=j[e];g.call(a,i,d.key);q+=1;if(q>=n)break}}}}};
primitives.common.LinkedHashItems=function(){function a(a,b){if(e.hasOwnProperty(a))throw"Duplicate segments are not supported!";e[a]=b;f[a]=null;null==i?(h=a,g[a]=null):(f[i]=a,g[a]=i);i=a}function b(a,b){if(e.hasOwnProperty(a))throw"Duplicate segments are not supported!";e[a]=b;g[a]=null;null==h?(i=a,f[a]=null):(g[h]=a,f[a]=h);h=a}function c(a,b,c,d){var n;null==c&&(c=a?h:i);if(null!=b)for(;null!=c;){n=e[c];if(null!=n&&b(n,c))break;c=c==d?null:a?f[c]:g[c]}}function d(a,b,d){c(!0,a,b,d)}var e={},
f={},g={},h=null,i=null;return{add:a,item:function(a){return e[a]},nextKey:function(a){return f[a]},prevKey:function(a){return g[a]},startKey:function(){return h},endKey:function(){return i},unshift:b,insertAfter:function(c,d,h){if(e.hasOwnProperty(d))throw"Duplicate segments are not supported!";if(null==c)b(d,h);else{var i=f[c];null==i?a(d,h):(e[d]=h,f[c]=d,f[d]=i,g[i]=d,g[d]=c)}},remove:function(a){var b=g[a],c=f[a];null!=b?f[b]=c:h=c;null!=c?g[c]=b:i=b;delete e[a];delete f[a];delete g[a]},isEmpty:function(){return null==
h},iterate:d,iterateBack:function(a,b,d){c(!1,a,b,d)},empty:function(){e={};f={};g={};i=h=null},toArray:function(){var a=[];d(function(b){a.push(b)});return a},validate:function(a){var b,c;for(b in e)if(e.hasOwnProperty(b)&&(!f.hasOwnProperty(b)||!g.hasOwnProperty(b)))return null!=a&&(a.message="Orphant key found!"),!1;if(!e.hasOwnProperty(h)||!e.hasOwnProperty(i))return null!=a&&(a.message="Start or end values are missing!"),!1;for(b in f)if(f.hasOwnProperty(b)){if(!e.hasOwnProperty(b)||!g.hasOwnProperty(b))return null!=
a&&(a.message="Orphant key found!"),!1;if((c=f[b])&&!f.hasOwnProperty(c))return null!=a&&(a.message="Next key not found!"),!1}for(b in g)if(g.hasOwnProperty(b)){if(!e.hasOwnProperty(b)||!f.hasOwnProperty(b))return null!=a&&(a.message="Orphant key found!"),!1;if((c=g[b])&&!g.hasOwnProperty(c))return null!=a&&(a.message="Prev key not found!"),!1}return!0}}};
primitives.common.pile=function(){function a(a,b,c,g){this.context=c;this.from=a;this.to=b;this.offset=null;this.direction=g}function b(a,c,f,g,h){if(a>=c.length)return 0;if(f.hasOwnProperty(a))return f[a];for(var i=c[a],j=b(a+1,c,f,g,h),k=a+1;k<c.length&&!(c[k].from>=i.to);)k+=1;c=1+b(k,c,f,g,h);c>j?(f[a]=c,g[a]=k,h[a]=!0):(f[a]=j,g[a]=a+1,h[a]=!1);return f[a]}var c=[];return{add:function(b,e,f){b<e?c.push(new a(b,e,f,1)):c.push(new a(e,b,f,-1))},resolve:function(a,e){var f,g,h,i,j,k,l=0;if(null!=
e){i=c.slice(0);i.sort(function(a,b){return a.from-b.from});for(j=[];0<i.length;){f={};g={};h={};b(0,i,f,g,h);f=[];j[l]=[];for(k=0;g.hasOwnProperty(k);)h[k]&&(f.push(k),j[l].push(i[k])),k=g[k];for(k=f.length-1;0<=k;k-=1)i.splice(f[k],1);l+=1}for(h=0;h<l;h+=1){f=j[h];for(k=0;k<f.length;k+=1)if(g=f[k],e.call(a,g.from,g.to,g.context,h,l,g.direction))return l}}return l}}};
primitives.common.tree=function(a){function b(a,b,c){var d,e,g;if(null!=f[b]&&(b=h[b],null!=b)){e=0;for(g=b.length;e<g&&!(d=b[e],c.call(a,d,f[d],e,g-1));e+=1);}}function c(a){var b=null;null!=g[a]&&(b=g[a]);return b}function d(a,b){var c,d=a.length;for(c=0;c<d;c+=1)if(a[c]==b)return a.splice(c,1),d-1;return d}function e(a,d,e){if(null!=e&&f.hasOwnProperty(d)){var g=c(d);null!=g&&e.call(a,g,f[g])||(b(a,g,function(b,c){b!=d&&e.call(a,b,c)}),b(a,d,function(b,c){e.call(a,b,c)}))}}var f={},g={},h={},i=
{},j={};primitives.common.isObject(a)&&(f=primitives.common.cloneObject(a.nodes,!0),g=primitives.common.cloneObject(a.parents,!0),h=primitives.common.cloneObject(a.children,!1),i=primitives.common.cloneObject(a.roots,!1),j=primitives.common.cloneObject(a.rootChildren,!0));return{loop:function(a,b){var c;if(null!=b)for(c in f)if(f.hasOwnProperty(c)&&b.call(a,c,f[c]))break},loopLevels:function(a,b,c){var d=0,e=[],g,i,r,y,w;switch(arguments.length){case 2:i=b;break;case 3:g=b,i=c}if(null!=i){if(null==
g)for(r in j)j.hasOwnProperty(r)&&(e=e.concat(j[r]));else null!=h[g]&&(e=e.concat(h[g]));for(;0<e.length;){r=[];y=0;for(w=e.length;y<w;y+=1)switch(g=e[y],i.call(a,g,f[g],d)){case 1:r=[];break;case 2:break;default:null!=h[g]&&(r=r.concat(h[g]))}e=r;d+=1}}},loopParents:function(a,b,c){if(null!=f[b]&&null!=c)for(;null!=(b=g[b])&&!c.call(a,b,f[b]););},loopChildren:b,loopChildrenRange:function(a,b,c,d,e){var g;if(null!=f[b]&&(b=h[b],null!=b))if(c<d){c=Math.max(c,0);d=Math.min(d,b.length-1);for(g=c;g<=
d&&!(c=b[g],e.call(a,c,f[c],g,NaN));g+=1);}else{c=Math.min(c,b.length-1);d=Math.max(0,d);for(g=c;g>=d&&!(c=b[g],e.call(a,c,f[c],g,NaN));g-=1);}},loopChildrenReversed:function(a,b,c){var d,e,g;if(null!=f[b]&&(b=h[b],g=b.length-1,null!=b))for(e=g;0<=e&&!(d=b[e],c.call(a,d,f[d],e,g));e-=1);},loopPostOrder:function(a,b){var c=[],d,e,i;if(null!=b){for(d in j)j.hasOwnProperty(d)&&(c=c.concat(j[d]));for(;0<c.length;)if(d=c[c.length-1],d!=e&&null!=(i=h[d]))for(d=i.length-1;0<=d;d-=1)c.push(i[d]);else if(c.pop(),
e=g[d],b.call(a,d,f[d],e,f[e]))break}},loopPreOrder:function(a,b){var c=[],d,e,i;if(null!=b){for(d in j)j.hasOwnProperty(d)&&(c=c.concat(j[d]));for(;0<c.length;){d=c[c.length-1];if(d!=e&&b.call(a,d,f[d],e,f[e]))break;if(d!=e&&null!=(i=h[d]))for(d=i.length-1;0<=d;d-=1)c.push(i[d]);else c.pop(),e=g[d]}}},loopNeighbours:function(a,b,c,d){var g={},h=[b],i,j=0;if(null!=d&&f.hasOwnProperty(b))for(g[b]=!0;0<h.length;){i=[];for(var b=0,y=h.length;b<y;b+=1){var w=h[b];if(0<j&&d.call(a,w,f[w],j))return;j<c&&
e(this,w,function(a){g.hasOwnProperty(a)||(i.push(a),g[a]=!0)})}h=i;j+=1}},zipUp:function(a,b,c,d){var e,f;if(null!=d)for(;null!=b&&null!=c&&b!=c;){e=g[b];f=g[c];if(d.call(a,b,e,c,f))break;b=e;c=f}},parentid:c,parent:function(a){var b=null;null!=g[a]&&(b=f[g[a]]);return b},adopt:function(a,b){if(null!=f[a]&&null!=f[b])if(a!=b)i.hasOwnProperty(b)&&(d(j[i[b]],b)||delete j[i[b]],delete i[b]),g.hasOwnProperty(b)&&(d(h[g[b]],b)||delete h[g[b]]),g[b]=a,null!=h[a]?h[a].push(b):h[a]=[b];else throw"Item cannot be parent of itself!";
else throw"Both parent and child should be in hierarchy!";},moveChildren:function(a,c){null!=f[a]&&(null!=f[c]&&a!=c)&&null!=h[a]&&(b(this,a,function(a){g[a]=c}),h[c]=null!=h[c]?h[c].concat(h[a]):h[a],delete h[a])},node:function(a){return f[a]},add:function(a,b,c,d){var e;if(null!=f[b])throw"Node already exists";if(null!=b&&(null!=c&&null==f[b])&&(null!=f[a]?(g[b]=a,null!=h[a]?null==d?h[a].push(b):h[a].splice(d,0,b):h[a]=[b]):(i[b]=a,null!=j[a]?null==d?j[a].push(b):j[a].splice(d,0,b):j[a]=[b]),f[b]=
c,null!=j[b])){h[b]=j[b];delete j[b];d=h[b];a=0;for(c=d.length;a<c;a+=1)e=d[a],delete i[e],g[e]=b}},insert:function(a,c,d){null!=f[a]&&(null!=c&&null==f[c]&&null!=d)&&(f[c]=d,null!=h[a]&&(h[c]=h[a]),h[a]=[c],b(this,c,function(a){g[a]=c}),g[c]=a)},hasNodes:function(){return!primitives.common.isEmptyObject(j)},hasChildren:function(a){return null!=h[a]},countChildren:function(a){return null!=h[a]?h[a].length:0},countSiblings:function(a){a=c(a);return null!=a?h[a].length:0},indexOf:function(a){var b=
c(a);return null!=b?primitives.common.indexOf(h[b],a):null},getChild:function(a,b){var c=null,d;if(null!=(d=h[a]))c=f[d[b]];return c},arrangeChildren:function(a,b){var c,d,e,b=b.slice(0);if(null!=f[a])if(null!=h[a])if(h[a].length==b.length){d=0;for(e=b.length;d<e;d+=1)if(c=b[d],g[c]!=a)throw"Child "+c+" does not belong to given node!";h[a]=b}else throw"Collections of children don't match each other!";else if(0<b.length)throw"Collections of children don't match each other!";},validate:function(){var a=
!0,b;for(b in i)if(i.hasOwnProperty(b)&&null!=i[b]){a=!1;break}return a},clone:function(){return primitives.common.family({nodes:f,parents:g,children:h,roots:i,rootChildren:j})},BREAK:1,SKIP:2}};
primitives.common.TreeLevels=function(a){function b(a){this.context=a;this.items=[]}function c(a,b,c){this.context=a;this.position=b;this.level=c}function d(a){null==e[a]&&(e[a]=new b(null),g=null===g?a:Math.min(g,a),h=null===h?a:Math.max(h,a));return e[a]}var e=[],f={},g=null,h=null;primitives.common.isObject(a)&&(e=primitives.common.cloneObject(a.levels,!0),f=primitives.common.cloneObject(a.items,!0),g=primitives.common.cloneObject(a.minimum,!0),h=primitives.common.cloneObject(a.maximum,!0));return{addlevel:function(a,
b){d(a).context=b},hasLevel:function(a){return null!=e[a]},hasItem:function(a){return f.hasOwnProperty(a)},addItem:function(a,b,e){var g;if(f.hasOwnProperty(b))throw"Duplicate item id.";g=d(a);g.items.push(b);f[b]=new c(e,g.items.length-1,a)},getLevelIndex:function(a){return f.hasOwnProperty(a)?f[a].level:null},getItemPosition:function(a){return f.hasOwnProperty(a)?f[a].position:null},getItemAtPosition:function(a,b){var c=e[a],d=null;null!=c&&(d=c.items[b]);return d},loopLevels:function(a,b){var c,
d;if(null!=b)for(c=g;c<=h&&!(d=e[c],null!=d&&b.call(a,c,d.context));c+=1);},loopLevelsReversed:function(a,b){var c,d;if(null!=b)for(c=h;c>=g&&!(d=e[c],null!=d&&b.call(a,c,d.context));c-=1);},loopLevelItems:function(a,b,c){var d,g,h;if(null!=c&&(g=e[b],null!=g)){b=0;for(d=g.items.length;b<d&&!(h=g.items[b],c.call(a,h,f[h].context,b));b+=1);}},getLevelLength:function(a){var b=0,a=e[a];null!=a&&(b=a.items.length);return b},loopItems:function(a,b){var c,d,m,n,q,s;if(null!=b)for(n=g;n<=h;n+=1)if(m=e[n],
null!=m){q=m.items;c=0;for(d=q.length;c<d;c+=1)if(s=q[c],b.call(a,s,f[s].context,c,n,m.context))return}},binarySearch:function(a,b,c){a=null;null!=c&&(b=e[b],null!=b&&(a=primitives.common.binarySearch(b.items,c)));return a},loopMerged:function(a,b,c){var d,g,h,q=[];d=0;for(g=e.length;d<g;d+=1)h=e[d],q.push(h.items);h=primitives.common.mergeSort(q,b);if(null!=c){d=0;for(g=h.length;d<g&&!(b=h[d],c.call(a,b,f[b].context));d+=1);}},loopFromItem:function(a,b,c,d){var g,h;if(f.hasOwnProperty(b)&&(g=f[b],
b=e[g.level].items,null!=d))if(c)for(c=g.position-1;0<=c&&!(h=b[c],d.call(a,h,f[h].context));c-=1);else{c=g.position+1;for(g=b.length;c<g&&!(h=b[c],d.call(a,h,f[h].context));c+=1);}},loopLevelsFromItem:function(a,b,c,d){if(f.hasOwnProperty(b)&&(b=f[b],null!=d))if(c)for(c=b.level+1;c<=h&&!d.call(a,c,e[c].context);c+=1);else for(c=b.level-1;c>=g&&!d.call(a,c,e[c].context);c-=1);},getPrevItem:function(a){var b=null;f.hasOwnProperty(a)&&(a=f[a],b=e[a.level].items[a.position-1]);return b},getNextItem:function(a){var b=
null;f.hasOwnProperty(a)&&(a=f[a],b=e[a.level].items[a.position+1]);return b},isEmpty:function(){return!e.length},clone:function(){return primitives.common.family({levels:e,items:f,minimum:g,maximum:h})}}};
primitives.common.DependencyManager=function(){var a={};return{register:function(b,c){return a[b]=c},resolve:function(b,c,d){var e=[],f=d||{};return function(){for(var d=Array.prototype.slice.call(arguments,0),h=0;h<b.length;h+=1){var i=b[h];e.push(a[i]&&""!==i?a[i]:d.shift())}e=e.concat(d);return c.apply(f||{},e)}}}};primitives.common.TaskInfo=function(a,b,c,d){this.name=a;this.dependencies=b;this.factory=c;this.task=null;this.color=d};
primitives.common.TaskManager=function(){var a=new primitives.common.family,b=new primitives.common.DependencyManager,c=[];return{addTask:function(b,e,f,g){if(0<c.length)throw"Task Manager is already initialized";a.add(e,b,new primitives.common.TaskInfo(b,e,f,g))},addDependency:function(a,e){if(0<c.length)throw"Task Manager is already initialized";b.register(a,e)},getTask:function(b){return(b=a.node(b))&&b.task},process:function(d,e,f){var g=!1;0===c.length&&a.loopTopo(this,function(a,d){d.task=b.register(a,
b.resolve(d.dependencies,d.factory)());c.push(d)});f&&console.log("-- process --");for(var h={},i=0,j=c.length;i<j;i+=1){var k=c[i],l=[];if(k.name==d||h.hasOwnProperty(k.name)){if(f)var m=performance.now();(g=k.task.process(f))&&a.loopChildren(this,k.name,function(b){h[b]=!0;f&&l.push(b);return a.SKIP});if(f)var n=performance.now();if(f){var q=Math.round(n-m,2);console.log(i+". "+k.name+(", "+q+" ms. ")+(g?" - forces: "+l.toString():""))}}if(k.name==e)break}},getProcessDiagramConfig:function(){var d=
new primitives.famdiagram.Config;0===c.length&&a.loopTopo(this,function(a,d){d.task=b.register(a,b.resolve(d.dependencies,d.factory)());c.push(d)});for(var e=0,f=c.length;e<f;e+=1){var g=c[e],h=new primitives.famdiagram.ItemConfig;h.id=g.name;h.title=primitives.common.splitCamelCaseName(g.name).join(" ");h.description=g.task.description||"";h.itemTitleColor=g.color;h.parents=[];a.loopParents(this,g.name,function(b){h.parents.push(b);return a.SKIP});d.items.push(h)}return d}}};
primitives.pdf.graphics=function(a){this._context=this._doc=a;this._dummyPlaceholder=new primitives.common.Placeholder};primitives.pdf.graphics.prototype.clean=function(){};primitives.pdf.graphics.prototype.resize=function(){};primitives.pdf.graphics.prototype.begin=function(){};primitives.pdf.graphics.prototype.end=function(){};primitives.pdf.graphics.prototype.reset=function(){};primitives.pdf.graphics.prototype.activate=function(){return this._dummyPlaceholder};
primitives.pdf.graphics.prototype.text=function(){};primitives.pdf.graphics.prototype.polylinesBuffer=function(a){a.loop(this,function(a){0<a.length()&&this.polyline(a)})};
primitives.pdf.graphics.prototype.polyline=function(a){var b=a.paletteItem.toAttr(),c,d=this._doc;d.save();a.loop(this,function(a){switch(a.segmentType){case 1:d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 0:d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 4:a.width==a.height&&a.width/2<=a.cornerRadius?d.roundedRect(Math.round(a.x)+0.5,Math.round(a.y)+0.5,a.width,a.height,Math.min(a.width,a.height)/2):0===a.cornerRadius?(d.moveTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5),
d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y)+0.5),d.lineTo(Math.round(a.x+a.width)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y+a.height)+0.5),d.lineTo(Math.round(a.x)+0.5,Math.round(a.y)+0.5)):(c=Math.min(a.cornerRadius,Math.min(a.width/2,a.height/2)),d.roundedRect(Math.round(a.x)+0.5,Math.round(a.y)+0.5,a.width,a.height,c));break;case 2:d.quadraticCurveTo(Math.round(a.cpX)+0.5,Math.round(a.cpY)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5);break;case 3:d.bezierCurveTo(Math.round(a.cpX1)+
0.5,Math.round(a.cpY1)+0.5,Math.round(a.cpX2)+0.5,Math.round(a.cpY2)+0.5,Math.round(a.x)+0.5,Math.round(a.y)+0.5)}});d.lineJoin("round");if(null!=b.lineType)switch(a=Math.round(b.lineWidth)||1,b.lineType){case 1:d.dash(a,2*a);break;case 2:d.dash(5*a,3*a)}void 0!==b.lineWidth&&void 0!==b.fillColor?d.lineWidth(b.lineWidth).fillOpacity(b.opacity).fillAndStroke(b.fillColor,b.borderColor):void 0!==b.lineWidth?d.lineWidth(b.lineWidth).stroke(b.borderColor):void 0!==b.fillColor&&d.fillOpacity(b.opacity).fillColor(b.fillColor);
d.restore()};primitives.pdf.graphics.prototype.rightAngleLine=function(){};primitives.pdf.graphics.prototype.template=function(a,b,c,d,e,f,g,h,i,j,k,l,m){c=0;null!==m&&void 0!==m["border-width"]&&(c=this.getPxSize(m["border-width"]));a=new primitives.common.Rect(a+e,b+f,g-c,h-c);null==l&&(l=new primitives.common.RenderEventArgs);null!==k&&k(this._doc,a,l)};
primitives.pdf.graphics.prototype.getPxSize=function(a,b){var c=a;"string"===typeof a&&(c=0<a.indexOf("pt")?96*parseInt(a,10)/72:0<a.indexOf("%")?parseFloat(a)/100*b:parseInt(a,10));return c};
primitives.pdf.famdiagram.Plugin=function(a){function b(){return f.options}function c(){return f.graphics}function d(){var a=new primitives.common.TaskManager;a.addDependency("options",b);a.addDependency("graphics",c);a.addDependency("defaultConfig",new primitives.famdiagram.Config);a.addDependency("defaultItemConfig",new primitives.famdiagram.ItemConfig);a.addDependency("defaultTemplateConfig",new primitives.famdiagram.TemplateConfig);a.addDependency("defaultButtonConfig",new primitives.famdiagram.ButtonConfig);
a.addDependency("defaultPaletteItemConfig",new primitives.famdiagram.PaletteItemConfig);a.addDependency("defaultBackgroundAnnotationConfig",new primitives.famdiagram.BackgroundAnnotationConfig);a.addDependency("defaultConnectorAnnotationConfig",new primitives.famdiagram.ConnectorAnnotationConfig);a.addDependency("defaultHighlightPathAnnotationConfig",new primitives.famdiagram.HighlightPathAnnotationConfig);a.addDependency("defaultShapeAnnotationConfig",new primitives.famdiagram.ShapeAnnotationConfig);
a.addDependency("defaultLabelAnnotationConfig",new primitives.famdiagram.LabelAnnotationConfig);a.addDependency("isFamilyChartMode",!0);a.addDependency("showElbowDots",!0);a.addDependency("null",null);a.addDependency("foreground",2);a.addDependency("background",1);a.addTask("OptionsTask",["options"],primitives.famdiagram.OptionsTask,"#000000");a.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");a.addTask("ConnectorsOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");a.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.ItemsOptionTask,"#000080");a.addTask("SpousesOptionTask",["OptionsTask","defaultItemConfig"],primitives.famdiagram.SpousesOptionTask,"#000080");a.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");a.addTask("PrintPreviewOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.PrintPreviewOptionTask,"#000080");a.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");a.addTask("OrientationOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");a.addTask("VisualTreeOptionTask",["OptionsTask"],primitives.famdiagram.VisualTreeOptionTask,"#000080");a.addTask("NormalizeOptionTask",
["OptionsTask","defaultConfig"],primitives.famdiagram.NormalizeOptionTask,"#000080");a.addTask("LinePaletteOptionTask",["OptionsTask","defaultPaletteItemConfig"],primitives.famdiagram.LinePaletteOptionTask,"#000080");a.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");a.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");a.addTask("SelectedItemsOptionTask",["OptionsTask"],
primitives.orgdiagram.SelectedItemsOptionTask,"#000080");a.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");a.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,
"#000080");a.addTask("ForegroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask",
"defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");a.addTask("ScaleOptionTask",
["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");a.addTask("IntervalsTask",["ItemsSizesOptionTask"],primitives.orgdiagram.IntervalsTask,"#00ffff");a.addTask("LogicalFamilyTask",["ItemsOptionTask"],primitives.famdiagram.LogicalFamilyTask,"#00ffff");a.addTask("LabelAnnotationOptionTask",["SplitAnnotationsOptionTask","LogicalFamilyTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationOptionTask,"#000080");a.addTask("LabelAnnotationTemplateOptionTask",
["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationTemplateOptionTask,"#000080");a.addTask("LabelAnnotationPlacementOptionTask",["LabelAnnotationOptionTask","defaultLabelAnnotationConfig"],primitives.famdiagram.LabelAnnotationPlacementOptionTask,"#000080");a.addTask("CombinedContextsTask",["ItemsOptionTask","LabelAnnotationOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");a.addTask("AddLabelAnnotationsTask",["LabelAnnotationPlacementOptionTask",
"LogicalFamilyTask"],primitives.famdiagram.AddLabelAnnotationsTask,"#ff0000");a.addTask("RemoveLoopsTask",["ItemsOptionTask","AddLabelAnnotationsTask"],primitives.famdiagram.RemoveLoopsTask,"#ff0000");a.addTask("AddSpousesTask",["SpousesOptionTask","RemoveLoopsTask"],primitives.famdiagram.AddSpousesTask,"#ff0000");a.addTask("NormalizeLogicalFamilyTask",["NormalizeOptionTask","AddSpousesTask"],primitives.famdiagram.NormalizeLogicalFamilyTask,"#ff0000");a.addTask("LevelsTask",["NormalizeLogicalFamilyTask",
"defaultItemConfig","CombinedTemplateParamsTask"],primitives.famdiagram.LevelsTask,"#ff0000");a.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.ReadTemplatesTask,"#00ffff");a.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,"#00ffff");a.addTask("LabelAnnotationTemplateParamsTask",["ItemsSizesOptionTask","LabelAnnotationTemplateOptionTask","ReadTemplatesTask"],primitives.famdiagram.LabelAnnotationTemplateParamsTask,
"#00ffff");a.addTask("CombinedTemplateParamsTask",["ItemTemplateParamsTask","LabelAnnotationTemplateParamsTask"],primitives.famdiagram.CombinedTemplateParamsTask,"#00ffff");a.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff");a.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff");a.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.ButtonsTemplateTask,
"#00ffff");a.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");a.addTask("PrintPreviewTemplateTask",["ItemsOptionTask"],primitives.pdf.orgdiagram.PrintPreviewTemplateTask,"#00ffff");a.addTask("ConnectionsGraphTask",["graphics","CreateTransformTask","ConnectorsOptionTask","LevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");a.addTask("HighlightItemTask",["HighlightItemOptionTask","LevelsTask"],
primitives.orgdiagram.HighlightItemTask,"#00ffff");a.addTask("CursorItemTask",["CursorItemOptionTask","LevelsTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");a.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,"#00ffff");a.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff");a.addTask("CurrentControlSizeTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCurrentControlSizeTask,
"#00ffff");a.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask NormalizeLogicalFamilyTask LevelsTask IntervalsTask CombinedTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),primitives.famdiagram.ItemsPositionsTask,"#ff0000");a.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask PrintPreviewOptionTask CurrentControlSizeTask LevelsTask ItemsPositionsTask isFamilyChartMode".split(" "),
primitives.orgdiagram.AlignDiagramTask,"#ff0000");a.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");a.addTask("BackgroundAnnotationManagerTask",["ItemsSizesOptionTask","LevelsTask","AlignDiagramTask"],primitives.orgdiagram.BackgroundAnnotationManagerTask,"#00ffff");a.addTask("PaletteManagerTask",["ConnectorsOptionTask","LinePaletteOptionTask"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");a.addTask("DrawBackgroundAnnotationTask",
"graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask AddLabelAnnotationsTask AlignDiagramTask BackgroundAnnotationManagerTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");a.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,
"#008000");a.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawBackgroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorsTask,"#008000");a.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,
"#00ffff");a.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawForegroundHighlightPathAnnotationTask".split(" "),primitives.orgdiagram.DrawTreeItemsTask,"#008000");a.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask CursorItemTask SelectedItemsTask DrawTreeItemsTask".split(" "),
primitives.orgdiagram.DrawCursorTask,"#008000");a.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask CombinedTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),primitives.orgdiagram.DrawHighlightTask,"#008000");a.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawHighlightTask".split(" "),
primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawPrintPreviewTask","graphics ApplyLayoutChangesTask PrintPreviewOptionTask AlignDiagramTask PrintPreviewTemplateTask ScaleOptionTask DrawForegroundConnectorAnnotationTask".split(" "),
primitives.orgdiagram.DrawPrintPreviewTask,"#008000");return a}function e(){f.options.hasButtons=2;f.options.pageFitMode=5;f.options.autoSizeMaximum=new primitives.common.Size(1E5,1E5)}var f={name:"famdiagram",doc:null,options:a,tasks:null,graphics:null};return{draw:function(a,h,i){f.doc=a;f.tasks=d(b,c);f.graphics=new primitives.pdf.graphics(f.doc);f.graphics.debug=!1;e();f.doc.save();f.doc.translate(h,i);f.tasks.process("OptionsTask",null,!1);f.doc.restore();a=f.tasks.getTask("AlignDiagramTask");
return new primitives.common.Size(a.getContentSize())},getSize:function(){f.tasks=d(b,c);e();f.tasks.process("OptionsTask","AlignDiagramTask",!1);var a=f.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())}}};
primitives.pdf.Template=function(a,b){this.cursorTemplate=this.dotHighlightTemplate=this.highlightTemplate=this.itemTemplate=this.templateConfig=null;null!=b&&(this.templateConfig=b,this.itemTemplate=primitives.common.isNullOrEmpty(b.itemTemplate)?new primitives.pdf.ItemTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onItemRender),this.highlightTemplate=primitives.common.isNullOrEmpty(b.highlightTemplate)?new primitives.pdf.HighlightTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onHighlightRender),
this.dotHighlightTemplate=new primitives.pdf.DummyTemplate(a,b),this.cursorTemplate=primitives.common.isNullOrEmpty(b.cursorTemplate)?new primitives.pdf.CursorTemplate(a,b):new primitives.pdf.UserTemplate(a,b,a.onCursorRender))};primitives.pdf.orgdiagram.DummyCurrentControlSizeTask=function(){return{process:function(){return!0},getScrollPanelSize:function(){return new primitives.common.Size(800,600)},getOptimalPanelSize:function(){return new primitives.common.Size(775,575)}}};
primitives.pdf.orgdiagram.AnnotationLabelTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.pdf.AnnotationLabelTemplate);return a}}};primitives.pdf.orgdiagram.ButtonsTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.pdf.DummyTemplate);return a}}};
primitives.pdf.orgdiagram.CheckBoxTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.pdf.CheckBoxTemplate(c.selectCheckBoxLabel));return b}}};
primitives.pdf.orgdiagram.GroupTitleTemplateTask=function(a){var b=null;return{process:function(){b=null;return!0},getTemplate:function(){var c;null==b&&(c=a.getOptions(),b=new primitives.pdf.GroupTitleTemplate(c.itemTitleFirstFontColor,c.itemTitleSecondFontColor));return b}}};primitives.pdf.orgdiagram.PrintPreviewTemplateTask=function(){var a=null;return{process:function(){return!1},getTemplate:function(){null==a&&(a=new primitives.pdf.PrintPreviewTemplate);return a}}};
primitives.pdf.orgdiagram.ReadTemplatesTask=function(a){var b={};return{process:function(){var c,d,e,f=a.getOptions(),g=f.templates;b={};b.DefaultWidgetTemplate=new primitives.pdf.Template(f,new primitives.orgdiagram.TemplateConfig);c=new primitives.orgdiagram.TemplateConfig;c.name="DefaultWidgetLabelAnnotationTemplate";c.isActive=!1;c.itemSize=new primitives.common.Size(100,20);c.minimizedItemSize=new primitives.common.Size(0,0);d=new primitives.pdf.Template;d.templateConfig=c;d.minimizedItemCornerRadius=
c.minimizedItemSize.width/2;d.itemTemplate=new primitives.pdf.LabelAnnotationTemplate;d.dotHighlightTemplate=new primitives.pdf.DummyTemplate;b.DefaultWidgetLabelAnnotationTemplate=d;c=0;for(d=g.length;c<d;c+=1)e=g[c],b[e.name]=new primitives.pdf.Template(f,e);return!0},getTemplate:function(a,d,e){return b[a]||b[d]||b[e]},DefaultWidgetTemplateName:"DefaultWidgetTemplate",DefaultWidgetLabelAnnotationTemplateName:"DefaultWidgetLabelAnnotationTemplate"}};
primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask=function(){return{process:function(){return!0},isItemSelected:function(){return!1}}};
primitives.pdf.orgdiagram.Plugin=function(a){function b(){return f.options}function c(){return f.graphics}function d(){var a=new primitives.common.TaskManager;a.addDependency("options",b);a.addDependency("graphics",c);a.addDependency("defaultConfig",new primitives.orgdiagram.Config);a.addDependency("defaultItemConfig",new primitives.orgdiagram.ItemConfig);a.addDependency("defaultTemplateConfig",new primitives.orgdiagram.TemplateConfig);a.addDependency("defaultButtonConfig",new primitives.orgdiagram.ButtonConfig);
a.addDependency("defaultBackgroundAnnotationConfig",new primitives.orgdiagram.BackgroundAnnotationConfig);a.addDependency("defaultConnectorAnnotationConfig",new primitives.orgdiagram.ConnectorAnnotationConfig);a.addDependency("defaultHighlightPathAnnotationConfig",new primitives.orgdiagram.HighlightPathAnnotationConfig);a.addDependency("defaultShapeAnnotationConfig",new primitives.orgdiagram.ShapeAnnotationConfig);a.addDependency("isFamilyChartMode",!1);a.addDependency("showElbowDots",!1);a.addDependency("null",
null);a.addDependency("foreground",2);a.addDependency("background",1);a.addTask("OptionsTask",["options"],primitives.orgdiagram.OptionsTask,"#000000");a.addTask("CalloutOptionTask",["OptionsTask","defaultConfig","defaultItemConfig"],primitives.orgdiagram.CalloutOptionTask,"#000080");a.addTask("ConnectorsOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ConnectorsOptionTask,"#000080");a.addTask("ItemsOptionTask",["OptionsTask","defaultItemConfig"],primitives.orgdiagram.ItemsOptionTask,
"#000080");a.addTask("ItemsSizesOptionTask",["OptionsTask","defaultConfig","defaultItemConfig","defaultButtonConfig"],primitives.orgdiagram.ItemsSizesOptionTask,"#000080");a.addTask("PrintPreviewOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.PrintPreviewOptionTask,"#000080");a.addTask("TemplatesOptionTask",["OptionsTask","defaultConfig","defaultButtonConfig","defaultTemplateConfig"],primitives.orgdiagram.TemplatesOptionTask,"#000080");a.addTask("OrientationOptionTask",["OptionsTask",
"defaultConfig"],primitives.orgdiagram.OrientationOptionTask,"#000080");a.addTask("VisualTreeOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.VisualTreeOptionTask,"#000080");a.addTask("CursorItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.CursorItemOptionTask,"#000080");a.addTask("HighlightItemOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.HighlightItemOptionTask,"#000080");a.addTask("SelectedItemsOptionTask",["OptionsTask"],primitives.orgdiagram.SelectedItemsOptionTask,
"#000080");a.addTask("SplitAnnotationsOptionTask",["OptionsTask"],primitives.orgdiagram.SplitAnnotationsOptionTask,"#00ffff");a.addTask("ForegroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","foreground"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("BackgroundShapeAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultShapeAnnotationConfig","background"],primitives.orgdiagram.ShapeAnnotationOptionTask,"#000080");a.addTask("ForegroundHighlightPathAnnotationOptionTask",
["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","foreground"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("BackgroundHighlightPathAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultHighlightPathAnnotationConfig","background"],primitives.orgdiagram.HighlightPathAnnotationOptionTask,"#000080");a.addTask("ForegroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","foreground"],primitives.orgdiagram.ConnectorAnnotationOptionTask,
"#000080");a.addTask("BackgroundConnectorAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultConnectorAnnotationConfig","background"],primitives.orgdiagram.ConnectorAnnotationOptionTask,"#000080");a.addTask("BackgroundAnnotationOptionTask",["SplitAnnotationsOptionTask","defaultBackgroundAnnotationConfig"],primitives.orgdiagram.BackgroundAnnotationOptionTask,"#000080");a.addTask("ScaleOptionTask",["OptionsTask","defaultConfig"],primitives.orgdiagram.ScaleOptionTask,"#000080");a.addTask("CombinedContextsTask",
["ItemsOptionTask"],primitives.orgdiagram.CombinedContextsTask,"#00ffff");a.addTask("IntervalsTask",["ItemsSizesOptionTask"],primitives.orgdiagram.IntervalsTask,"#00ffff");a.addTask("OrgTreeTask",["ItemsOptionTask"],primitives.orgdiagram.OrgTreeTask,"#ff0000");a.addTask("ReadTemplatesTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.ReadTemplatesTask,"#00ffff");a.addTask("ItemTemplateParamsTask",["ItemsSizesOptionTask","CursorItemOptionTask","ReadTemplatesTask"],primitives.orgdiagram.ItemTemplateParamsTask,
"#00ffff");a.addTask("GroupTitleTemplateTask",["TemplatesOptionTask"],primitives.pdf.orgdiagram.GroupTitleTemplateTask,"#00ffff");a.addTask("CheckBoxTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.CheckBoxTemplateTask,"#00ffff");a.addTask("ButtonsTemplateTask",["ItemsSizesOptionTask"],primitives.pdf.orgdiagram.ButtonsTemplateTask,"#00ffff");a.addTask("AnnotationLabelTemplateTask",["ItemsOptionTask"],primitives.pdf.orgdiagram.AnnotationLabelTemplateTask,"#00ffff");a.addTask("PrintPreviewTemplateTask",
["ItemsOptionTask"],primitives.pdf.orgdiagram.PrintPreviewTemplateTask,"#00ffff");a.addTask("VisualTreeTask",["OrgTreeTask","ItemTemplateParamsTask","VisualTreeOptionTask","isFamilyChartMode"],primitives.orgdiagram.VisualTreeTask,"#ff0000");a.addTask("VisualTreeLevelsTask",["VisualTreeTask","ItemTemplateParamsTask"],primitives.orgdiagram.VisualTreeLevelsTask,"#ff0000");a.addTask("VisualTreeMarginsTask",["VisualTreeTask"],primitives.orgdiagram.VisualTreeMarginsTask,"#ff0000");a.addTask("ConnectionsGraphTask",
["graphics","CreateTransformTask","ConnectorsOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],primitives.orgdiagram.ConnectionsGraphTask,"#00ffff");a.addTask("HighlightItemTask",["HighlightItemOptionTask","VisualTreeLevelsTask"],primitives.orgdiagram.HighlightItemTask,"#00ffff");a.addTask("CursorItemTask",["CursorItemOptionTask","VisualTreeLevelsTask"],primitives.orgdiagram.CursorItemTask,"#00ffff");a.addTask("SelectedItemsTask",["SelectedItemsOptionTask"],primitives.orgdiagram.SelectedItemsTask,
"#00ffff");a.addTask("CombinedNormalVisibilityItemsTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCombinedNormalVisibilityItemsTask,"#00ffff");a.addTask("CurrentControlSizeTask",["OptionsTask"],primitives.pdf.orgdiagram.DummyCurrentControlSizeTask,"#00ffff");a.addTask("ItemsPositionsTask","CurrentControlSizeTask ScaleOptionTask OrientationOptionTask ItemsSizesOptionTask ConnectorsOptionTask VisualTreeOptionTask IntervalsTask VisualTreeTask VisualTreeLevelsTask VisualTreeMarginsTask ItemTemplateParamsTask CursorItemTask CombinedNormalVisibilityItemsTask".split(" "),
primitives.orgdiagram.ItemsPositionsTask,"#ff0000");a.addTask("AlignDiagramTask","OrientationOptionTask ItemsSizesOptionTask VisualTreeOptionTask ScaleOptionTask PrintPreviewOptionTask CurrentControlSizeTask VisualTreeLevelsTask ItemsPositionsTask isFamilyChartMode".split(" "),primitives.orgdiagram.AlignDiagramTask,"#ff0000");a.addTask("CreateTransformTask",["OrientationOptionTask","AlignDiagramTask"],primitives.orgdiagram.CreateTransformTask,"#00ffff");a.addTask("BackgroundAnnotationManagerTask",
["ItemsSizesOptionTask","VisualTreeLevelsTask","AlignDiagramTask"],primitives.orgdiagram.BackgroundAnnotationManagerTask,"#00ffff");a.addTask("PaletteManagerTask",["ConnectorsOptionTask","null"],primitives.orgdiagram.PaletteManagerTask,"#00ffff");a.addTask("DrawBackgroundAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask BackgroundAnnotationOptionTask VisualTreeTask AlignDiagramTask BackgroundAnnotationManagerTask".split(" "),primitives.orgdiagram.DrawBackgroundAnnotationTask,"#008000");
a.addTask("DrawBackgroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundAnnotationTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawBackgroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask BackgroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask background DrawBackgroundShapeAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawTreeItemsTask","graphics CreateTransformTask ApplyLayoutChangesTask ItemsSizesOptionTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask GroupTitleTemplateTask CheckBoxTemplateTask ButtonsTemplateTask DrawBackgroundConnectorAnnotationTask".split(" "),primitives.orgdiagram.DrawTreeItemsTask,"#008000");a.addTask("DrawBackgroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask ForegroundHighlightPathAnnotationOptionTask ConnectionsGraphTask foreground DrawTreeItemsTask".split(" "),
primitives.orgdiagram.DrawHighlightPathAnnotationTask,"#00ffff");a.addTask("DrawConnectorsTask","graphics ConnectionsGraphTask ConnectorsOptionTask showElbowDots PaletteManagerTask DrawBackgroundHighlightPathAnnotationTask".split(" "),primitives.orgdiagram.DrawConnectorsTask,"#008000");a.addTask("DrawForegroundHighlightPathAnnotationTask","graphics ConnectorsOptionTask BackgroundHighlightPathAnnotationOptionTask ConnectionsGraphTask background DrawConnectorsTask".split(" "),primitives.orgdiagram.DrawHighlightPathAnnotationTask,
"#00ffff");a.addTask("DrawForegroundShapeAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundShapeAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundHighlightPathAnnotationTask".split(" "),primitives.orgdiagram.DrawShapeAnnotationTask,"#008000");a.addTask("DrawForegroundConnectorAnnotationTask","graphics CreateTransformTask ApplyLayoutChangesTask OrientationOptionTask ForegroundConnectorAnnotationOptionTask AlignDiagramTask AnnotationLabelTemplateTask foreground DrawForegroundShapeAnnotationTask".split(" "),
primitives.orgdiagram.DrawConnectorAnnotationTask,"#008000");a.addTask("DrawCursorTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask CursorItemTask SelectedItemsTask DrawForegroundConnectorAnnotationTask".split(" "),primitives.orgdiagram.DrawCursorTask,"#008000");a.addTask("DrawHighlightTask","graphics CreateTransformTask ApplyLayoutChangesTask CombinedContextsTask AlignDiagramTask ItemTemplateParamsTask HighlightItemTask CursorItemTask SelectedItemsTask DrawCursorTask".split(" "),
primitives.orgdiagram.DrawHighlightTask,"#008000");a.addTask("DrawPrintPreviewTask","graphics ApplyLayoutChangesTask PrintPreviewOptionTask AlignDiagramTask PrintPreviewTemplateTask ScaleOptionTask DrawHighlightTask".split(" "),primitives.orgdiagram.DrawPrintPreviewTask,"#008000");return a}function e(){f.options.hasButtons=2;f.options.pageFitMode=5;f.options.autoSizeMaximum=new primitives.common.Size(1E5,1E5)}var f={name:"orgdiagram",doc:null,options:a,tasks:null,graphics:null};return{draw:function(a,
h,i){f.doc=a;f.tasks=d(b,c);f.graphics=new primitives.pdf.graphics(f.doc);f.graphics.debug=!1;e();f.doc.save();f.doc.translate(h,i);f.tasks.process("OptionsTask",null,!1);f.doc.restore();a=f.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())},getSize:function(){f.tasks=d(b,c);e();f.tasks.process("OptionsTask","AlignDiagramTask",!1);var a=f.tasks.getTask("AlignDiagramTask");return new primitives.common.Size(a.getContentSize())}}};
primitives.pdf.AnnotationLabelTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,b,c){c=c.context;a.save();a.font("Helvetica",12).text(c.label,b.x,b.y,{width:b.width,height:b.height,align:"center"});a.restore()}}};
primitives.pdf.CheckBoxTemplate=function(a){return{template:function(){return{}},getHashCode:function(){return 0},render:function(b,c,d){d=d.isSelected?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAF/SURBVDhPpZM7rwFREMf/u4hEY5vVkigoSERiKwq1QqOh28R30QnFRqnSKHwFn0C37Sbi0SCE2KzE41wzd/feG48g91ftmdn5zznzkLLZrNhutzidTvgEv98PRVEgxeNx0e12EYvFcDweXfdjZFmGEIKDx+MxdF0HotGomEwmV/tnUAzFyqT8KrNHLpdDJpPBZrPh81UHLPAO7XYb6/Ua8/kcpmnC5/NBkqT3BJbLJRqNBgKBACqVCgqFAg6HA/veEiiVSlBVFZfLBZ1Ox7V+81KAMtPVV6sV+v2+a/2FBeg9RDqdhqZp/E1Mp1O0Wi32V6tVLuAtLEBvGw6HmM1m2O/3yOfz7CyXy4hEItz3ZrPJtr/8dIEKUiwWYRgGX3e32yGZTOJ8PnMBB4MBB9xy14VarcaZFosFQqEQHMdBvV5HIpFw/3gATZNlWTxdHr1eT4TDYZFKpVzLPRRDsU9HeTQaCdu23dM91wKzwNNlCgaDXINHW0pF95bpn+us4AsY2TIOZFyZ9AAAAABJRU5ErkJggg==":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAACjSURBVDhPrZNNCsQgDEY/f2q33sCCN+iNPJlXE2/gTtDiVBln1TJo+zZBJS+YELLvewkhIOeMETjnkFKCaK2LtRbbtiGl9H2+hlKKUkpLds7BGAMopYr3/rwfo+bUXFrN/yrfcXrQBDMwxkAImRfEGFucFnTeEdT/zNIEy7K0wyi/KfSGjPJoCp13BDM9EEK0eLtM67riOI7LLa0F+zI9XGeJDyTldfBA9FNyAAAAAElFTkSuQmCC";
b.save();b.image(d,c.x,c.y);b.font("Helvetica",11).text(a,c.x+20,c.y+4,{ellipsis:!0,width:c.width-4,height:c.height,align:"left"});b.restore()}}};primitives.pdf.CursorTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,d){a.save();a.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.cursorBorderWidth).stroke("#fbd850");a.restore()}}};
primitives.pdf.DummyTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(){}}};
primitives.pdf.GroupTitleTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(c,d,e){new primitives.text.Config;var e=e.context,f=e.groupTitleColor||"#4169e1",g=primitives.common.highestContrast(f,b,a);c.save();c.translate(d.width,0).rotate(90,{origin:[d.x,d.y]});c.fillColor(f).roundedRect(d.x,d.y,d.height-2,d.width,4).fill();c.fillColor(g).font("Helvetica",12).text(e.groupTitle,d.x+4,d.y+6,{ellipsis:!0,width:d.height-4,height:d.width-4,align:"center"});
c.restore()}}};primitives.pdf.HighlightTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,d){a.save();a.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.highlightBorderWidth).stroke("#fbcb09");a.restore()}}};
primitives.pdf.ItemTemplate=function(a,b){return{template:function(){return{}},getHashCode:function(){return 0},render:function(c,d,e){var e=e.context,f=null!=e.itemTitleColor?e.itemTitleColor:"#4169e1",g=primitives.common.highestContrast(f,a.itemTitleSecondFontColor,a.itemTitleFirstFontColor),h=new primitives.common.Size(b.itemSize);h.width-=2*b.itemBorderWidth;h.height-=2*b.itemBorderWidth;c.save();c.roundedRect(d.x,d.y,d.width,d.height,4).lineWidth(b.itemBorderWidth).stroke("#dddddd");c.fillColor(f).roundedRect(d.x+
2,d.y+2,h.width-4,18,2).fill();c.fillColor(g).font("Helvetica",12).text(e.title,d.x+4,d.y+7,{ellipsis:!0,width:h.width-4-8,height:16,align:"left"});null!=e.image&&c.image(e.image,d.x+3,d.y+24);c.rect(d.x+3,d.y+24,50,60).stroke("#cccccc");c.fillColor("black").font("Helvetica",10).text(e.description,d.x+56,d.y+24,{ellipsis:!0,width:h.width-4-56,height:74,align:"left"});c.restore()}}};
primitives.pdf.LabelAnnotationTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,b,c){c=c.context;a.save();a.font("Helvetica",12).text(c.title,b.x,b.y,{width:b.width,height:b.height,align:"center"});a.restore()}}};
primitives.pdf.PrintPreviewTemplate=function(){return{template:function(){return{}},getHashCode:function(){return 0},render:function(a,b){a.save();a.roundedRect(b.x,b.y,b.width,b.height,0).doc.dash(2,4).lineWidth(1).stroke("#cccccc");a.restore()}}};primitives.pdf.UserTemplate=function(a,b,c){return{template:function(){return{}},getHashCode:function(){return 0},render:function(d,e,f){null!=c?c(d,e,f):primitives.pdf.ItemTemplate(a,b).render(d,e,f)}}};
primitives.callout.Config=function(){this.classPrefix="bpcallout";this.graphicsType=1;this.actualGraphicsType=null;this.pointerPlacement=0;this.snapPoint=this.position=null;this.cornerRadius="10%";this.offset=0;this.lineWidth=this.opacity=1;this.lineType=0;this.pointerWidth="10%";this.borderColor="#000000";this.fillColor="#d3d3d3"};
primitives.callout.Controller=function(){this.widgetEventPrefix="bpcallout";this.options=new primitives.callout.Config;this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.callout.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.callout.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.callout.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this.m_graphics.graphicsType;this.m_shape=new primitives.common.Callout(this.m_graphics)};primitives.callout.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.callout.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.callout.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.callout.Controller.prototype._redraw=function(){var a="pointerPlacement cornerRadius offset opacity lineWidth lineType pointerWidth borderColor fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.draw(this.options.snapPoint,this.options.position)};
primitives.callout.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpCallout",new primitives.callout.Controller)}(jQuery);
primitives.connector.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.actualGraphicsType=null;this.connectorShapeType=this.connectorPlacementType=this.orientationType=0;this.toRectangle=this.fromRectangle=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=3;this.color="#000000";this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacementType=1};
primitives.connector.AnnotationLabelTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-corner-all bp-connector-label");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,c){c.element.html(a.label)}}};
primitives.connector.Controller=function(){this.widgetEventPrefix="bpconnector";this.options=new primitives.connector.Config;this._labelTemplate=this._graphics=this._panelSize=this._placeholder=null};primitives.connector.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.connector.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.connector.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.connector.Controller.prototype._createLayout=function(){this._panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this._placeholder=jQuery("<div></div>");this._placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this._placeholder.css(this._panelSize.getCSS());this._placeholder.addClass("placeholder");this._placeholder.addClass(this.widgetEventPrefix);this.element.append(this._placeholder);this._graphics=
primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this._graphics.graphicsType};primitives.connector.Controller.prototype._cleanLayout=function(){null!==this._graphics&&this._graphics.clean();this._graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};primitives.connector.Controller.prototype._updateLayout=function(){this._panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this._placeholder.css(this._panelSize.getCSS())};
primitives.connector.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this._graphics.resize("placeholder",this._panelSize.width,this._panelSize.height),this._graphics.begin(),this._redraw(),this._graphics.end())};
primitives.connector.Controller.prototype._redraw=function(){var a=this.options,b,c,d=new primitives.common.Transform,e=this._graphics.activate("placeholder"),f=new primitives.common.PolylinesBuffer,g=this,h=primitives.orgdiagram.ConnectorAnnotationOffsetResolver();d.size=new primitives.common.Size(this._panelSize.width,this._panelSize.height);d.setOrientation(a.orientationType);if(null!=a.fromRectangle&&null!=a.toRectangle){var i=a.fromRectangle,j=a.toRectangle;d.transformRect(i.x,i.y,i.width,i.height,
!1,this,function(a,b,c,d){i=new primitives.common.Rect(a,b,c,d)});d.transformRect(j.x,j.y,j.width,j.height,!1,this,function(a,b,c,d){j=new primitives.common.Rect(a,b,c,d)});switch(a.connectorPlacementType){case 0:b=new primitives.common.ConnectorOffbeat;break;case 1:b=new primitives.common.ConnectorStraight}var k;d.transformRect(0,0,a.labelSize.width,a.labelSize.height,!1,this,function(a,b,c,d){k=new primitives.common.Size(c,d)});var l=null;d.transformRect(0,0,e.size.width,e.size.height,!1,this,function(a,
b,c,d){l=new primitives.common.Size(c,d)});var e=new primitives.common.PaletteItem({lineColor:a.color,lineWidth:a.lineWidth,lineType:a.lineType}),m=!primitives.common.isNullOrEmpty(a.label),i=(new primitives.common.Rect(i)).offset(a.offset),j=(new primitives.common.Rect(j)).offset(a.offset);b.draw(f,e,i,j,6*a.lineWidth,0,k,l,a.connectorShapeType,4,a.labelPlacementType,m,h,function(b){m&&null!=b&&(d.transformRect(b.x,b.y,b.width,b.height,!0,g,function(a,c,d,e){b=new primitives.common.Rect(a,c,d,e)}),
c=new primitives.common.RenderEventArgs,c.context=a,g._graphics.template(b.x,b.y,0,0,0,0,b.width,b.height,g._labelTemplate.template(),g._labelTemplate.getHashCode(),g._labelTemplate.render,c,null))});h.resolve()}f.transform(d,!0);this._graphics.polylinesBuffer(f)};
primitives.connector.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpConnector",new primitives.connector.Controller)}(jQuery);
primitives.orgdiagram.Widget=function(a,b){this.widgetEventPrefix="orgdiagram";this.options=new a;this.control=null;this.controlFactory=b};primitives.orgdiagram.Widget.prototype._create=function(){this.element.addClass("ui-widget");this.control=new this.controlFactory(this.element,this._readOptions(this.options))};primitives.orgdiagram.Widget.prototype.destroy=function(){this.control.destroy()};primitives.orgdiagram.Widget.prototype.update=function(a){this.control.update(a)};
primitives.orgdiagram.Widget.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}this.control.setOptions(this._readOptions(this.options))};
primitives.orgdiagram.Widget.prototype._readOptions=function(a){var b={},c=this,d;for(d in a)if(a.hasOwnProperty(d))switch(d){case "onHighlightChanged":case "onCursorChanged":case "onSelectionChanging":case "onButtonClick":case "onMouseClick":case "onMouseDblClick":case "onItemRender":case "onHighlightRender":b[d]=function(a){return function(b,d){c._trigger(a,b,d)}}(d);break;case "onHighlightChanging":b[d]=function(a,b){var d=c.control.getOptions();c.options.highlightItem=d.highlightItem;c._trigger("onHighlightChanging",
a,b)};break;case "onCursorChanging":b[d]=function(a,b){var d=c.control.getOptions();c.options.cursorItem=d.cursorItem;c._trigger("onCursorChanging",a,b)};break;case "onSelectionChanged":b[d]=function(a,b){var d=c.control.getOptions();c.options.selectedItems=d.selectedItems;c._trigger("onSelectionChanged",a,b)};break;default:b[d]=a[d]}return b};"undefined"!=typeof jQuery&&function(a){a.widget("ui.orgDiagram",new primitives.orgdiagram.Widget(primitives.orgdiagram.Config,primitives.orgdiagram.Control))}(jQuery);
"undefined"!=typeof jQuery&&function(a){a.widget("ui.famDiagram",new primitives.orgdiagram.Widget(primitives.famdiagram.Config,primitives.famdiagram.Control))}(jQuery);
primitives.shape.Config=function(){this.classPrefix="bpconnector";this.graphicsType=1;this.actualGraphicsType=null;this.shapeType=this.orientationType=0;this.position=null;this.offset=new primitives.common.Thickness(0,0,0,0);this.lineWidth=2;this.cornerRadius="10%";this.opacity=1;this.fillColor=this.borderColor=null;this.lineType=0;this.label=null;this.labelSize=new primitives.common.Size(60,30);this.labelPlacement=0;this.labelOffset=4};
primitives.shape.AnnotationLabelTemplate=function(a){var b,c=jQuery("<div></div>");c.addClass("bp-item bp-corner-all bp-connector-label");b=c.wrap("<div>").parent().html();var d=primitives.common.hashCode(b);return{template:function(){return b},getHashCode:function(){return d},render:function(b,c){c.element.html(a.label)}}};
primitives.shape.Controller=function(){this.widgetEventPrefix="bpshape";this.options=new primitives.shape.Config;this._labelTemplate=this.m_shape=this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.shape.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._labelTemplate=primitives.shape.AnnotationLabelTemplate(this.options);this._createLayout();this._redraw()};primitives.shape.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.shape.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this.m_graphics.graphicsType};primitives.shape.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.shape.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.shape.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.shape.Controller.prototype._redraw=function(){var a="orientationType shapeType offset lineWidth borderColor lineType labelSize labelOffset labelPlacement cornerRadius opacity fillColor".split(" "),b,c;this.m_graphics.activate("placeholder");this.m_shape=new primitives.common.Shape(this.m_graphics);for(b=0;b<a.length;b+=1)c=a[b],this.m_shape[c]=this.options[c];this.m_shape.hasLabel=!primitives.common.isNullOrEmpty(this.options.label);this.m_shape.labelTemplate=this._labelTemplate;this.m_shape.panelSize=
new primitives.common.Size(this.m_panelSize.width,this.m_panelSize.height);this.m_shape.draw(this.options.position)};primitives.shape.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};
"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpShape",new primitives.shape.Controller)}(jQuery);primitives.text.Config=function(){this.classPrefix="bptext";this.graphicsType=0;this.actualGraphicsType=null;this.orientation=0;this.text="";this.verticalAlignment=1;this.horizontalAlignment=0;this.fontSize="16px";this.fontFamily="Arial";this.color="#000000";this.fontStyle=this.fontWeight="normal"};
primitives.text.Controller=function(){this.widgetEventPrefix="bptext";this.options=new primitives.text.Config;this.m_graphics=this.m_panelSize=this.m_placeholder=null};primitives.text.Controller.prototype._create=function(){this.element.addClass("ui-widget");this._createLayout();this._redraw()};primitives.text.Controller.prototype.destroy=function(){this._cleanLayout()};
primitives.text.Controller.prototype._createLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.outerWidth(),this.element.outerHeight());this.m_placeholder=jQuery("<div></div>");this.m_placeholder.css({position:"relative",overflow:"hidden",top:"0px",left:"0px",padding:"0px",margin:"0px"});this.m_placeholder.css(this.m_panelSize.getCSS());this.m_placeholder.addClass("placeholder");this.m_placeholder.addClass(this.widgetEventPrefix);this.element.append(this.m_placeholder);
this.m_graphics=primitives.common.createGraphics(this.options.graphicsType,this.element);this.options.actualGraphicsType=this.m_graphics.graphicsType};primitives.text.Controller.prototype._cleanLayout=function(){null!==this.m_graphics&&this.m_graphics.clean();this.m_graphics=null;this.element.find("."+this.widgetEventPrefix).remove()};
primitives.text.Controller.prototype._updateLayout=function(){this.m_panelSize=new primitives.common.Rect(0,0,this.element.innerWidth(),this.element.innerHeight());this.m_placeholder.css(this.m_panelSize.getCSS())};primitives.text.Controller.prototype.update=function(a){a?(this._cleanLayout(),this._createLayout(),this._redraw()):(this._updateLayout(),this.m_graphics.resize("placeholder",this.m_panelSize.width,this.m_panelSize.height),this.m_graphics.begin(),this._redraw(),this.m_graphics.end())};
primitives.text.Controller.prototype._redraw=function(){var a=this.m_graphics.activate("placeholder");this.m_graphics.text(a.rect.x,a.rect.y,a.rect.width,a.rect.height,this.options.text,this.options.orientation,this.options.horizontalAlignment,this.options.verticalAlignment,{"font-size":this.options.fontSize,"font-family":this.options.fontFamily,"font-style":this.options.fontStyle,"font-weight":this.options.fontWeight,"font-color":this.options.color})};
primitives.text.Controller.prototype._setOption=function(a,b){jQuery.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":var c=jQuery([]);b?(c.filter(".ui-state-focus").blur(),c.removeClass("ui-state-hover"),c.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(c.propAttr("disabled",!1),this.element.removeClass("ui-disabled"))}};"undefined"!=typeof jQuery&&function(a){a.widget("ui.bpText",new primitives.text.Controller)}(jQuery);
